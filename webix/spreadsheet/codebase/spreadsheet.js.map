{"version":3,"file":"spreadsheet.js","sources":["../sources/math/parser.js","../sources/locale.js","../sources/locales/en.js","../sources/views/align.js","../sources/views/border.js","../sources/views/color.js","../sources/views/dialog.js","../sources/views/form.js","../sources/views/formlate.js","../sources/views/icons.js","../sources/views/list_suggest.js","../sources/views/suggest_formula.js","../sources/views/button.js","../sources/math/methods/helpers.js","../sources/views/live_editor.js","../sources/views/separator.js","../sources/views/sheets.js","../sources/views/toggle.js","../sources/views/toolbar_title.js","../sources/views/multicheckbox.js","../sources/views/formlist.js","../sources/editors/date_editor.js","../sources/operations/undo_group.js","../sources/operations/save.js","../sources/helpers/column_names.js","../sources/toolbar/defaults.js","../sources/operations/styles.js","../sources/operations/formats.js","../sources/toolbar/actions.js","../sources/toolbar/buttons.js","../sources/toolbar/all_elements.js","../sources/toolbar.js","../sources/toolbar/helpers.js","../sources/operations/column_operations.js","../sources/table.js","../sources/hotkeys.js","../sources/math/methods/numbers.js","../sources/math/methods/strings.js","../sources/math/methods/date.js","../sources/math/methods/other.js","../sources/math/methods.js","../sources/editor.js","../sources/helpers/array.js","../sources/sheets.js","../sources/dialogs/common.js","../sources/math/writer.js","../sources/dialogs/image.js","../sources/math/cache.js","../sources/math/updater.js","../sources/math/sheet.js","../sources/math/ranges.js","../sources/dialogs/sparkline.js","../sources/dialogs/ranges.js","../sources/dialogs/dropdown.js","../sources/dialogs/filter.js","../sources/dialogs/format.js","../sources/dialogs/conditional.js","../sources/dialogs/export.js","../sources/dialogs/link.js","../sources/dialogs/print.js","../sources/dialogs/comments.js","../sources/dialogs/sizing.js","../sources/dialogs/index.js","../sources/operations/lock_cell.js","../sources/operations/undo.js","../sources/operations/spans.js","../sources/operations/add_row_col.js","../sources/math/math.js","../sources/math/placeholder.js","../sources/operations/conditional_formats.js","../sources/operations/dropdown.js","../sources/operations/types.js","../sources/operations/filter.js","../sources/operations/clipboard.js","../sources/operations/data.js","../sources/operations/hide_row_col.js","../sources/operations/resize.js","../sources/operations/selection.js","../sources/helpers/expand_selection.js","../sources/operations/sorting.js","../sources/operations/hide_gridlines.js","../sources/operations/hide_headers.js","../sources/operations/comments.js","../sources/operations/states.js","../sources/operations/import.js","../sources/operations/print.js","../sources/operations/export.js","../sources/operations/load.js","../sources/operations/clear_styles.js","../sources/api/row_col_operations.js","../sources/api/lock_cell.js","../sources/api/freeze.js","../sources/api/hide_gridlines.js","../sources/api/hide_headers.js","../sources/api/hide_rows.js","../sources/api/math.js","../sources/api/operations.js","../sources/api/core.js","../sources/api/save.js","../sources/api/dropdown.js","../sources/api/filter.js","../sources/api/confirm.js","../sources/api/undo.js","../sources/api/number_formats.js","../sources/menu.js","../sources/helpers/conditional.js","../sources/spreadsheet.js","../sources/context.js","../sources/operations/index.js","../sources/api/index.js"],"sourcesContent":["function isChar(char){\n\tvar code = char.charCodeAt(0);\n\t// #(35) - errors like #REF!, $(36) - absolute cell reference, a-zA-Z(65-122) - chars\n\treturn (code>=65 && code<=122) || code == 35 || code == 36;\n}\nfunction isNumber(char){\n\tvar code = char.charCodeAt(0);\n\treturn code>=48 && code<=57;\n}\n\nfunction getWord(formula, i, passive){\n\tvar max = formula.length;\n\tvar sheet = passive;\n\tvar quotes = false;\n\n\tfor(var j=i; j<max; j++){\n\t\tvar key =  formula[j];\n\t\tif (key === \"'\"){\n\t\t\tquotes = !quotes;\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (!quotes){\n\t\t\tif (key == \"!\"){\n\t\t\t\tif(formula[i] == \"#\") //error\n\t\t\t\t\tcontinue;\n\t\t\t\telse{\n\t\t\t\t\t//multi-sheet math\n\t\t\t\t\tsheet = formula.substr(i, j-i);\n\t\t\t\t\tif (sheet[0] === \"'\")\n\t\t\t\t\t\tsheet = sheet.substr(1, sheet.length-2);\n\t\t\t\t\ti=j+1;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (!isChar(key) && !isNumber(key)){\n\t\t\t\treturn [formula.substr(i, j-i), j, i, sheet];\n\t\t\t}\n\t\t}\n\t}\n\n\treturn [formula.substr(i), j, i, sheet];\n}\n\nvar operand = /^[A-Z$]+[0-9]+$/;\nfunction isPosition(text){\n\treturn operand.test(text);\n}\n\nexport function position(word){\n\tvar row = 0, sum = 0, x = 1, mode = 1, flags = 0;  \n\tvar chars = false;\n\n\tfor (var j =word.length-1; j>=0; j--){\n\t\tvar key = word[j].charCodeAt(0);\n\t\tif (key === 36) {\n\t\t\tflags = flags+mode;\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (key < 58){\n\t\t\t//numeric\n\t\t\tsum += (key - 48)*x;\n\t\t\tx *= 10;\n\t\t} else {\n\t\t\tif (!chars){\n\t\t\t\tx = 1; row = sum; sum = 0; chars = true; mode += 1;\n\t\t\t}\n\t\t\t//alpha\n\t\t\tsum += (key - 64)*x;\n\t\t\tx*=26;\n\t\t}\n\t}\n\n\t/*\n\t\t$X$Y => flags = 3\n\t\t$XY  => flags = 2\n\t\tX$Y  => flags = 1\n\t\tXY   => flags = 0\n\t*/\n\treturn [row, sum, flags];\n}\n\nfunction errorCode(e){\n\treturn `this.e(\"${e}\")`;\n}\n\nfunction operandCode(deps, word, sheet){\n\tlet [r,c] = position(word);\n\n\tif (sheet !== \"\"){\n\t\tdeps.push([r,c,r,c,sheet]);\n\t\treturn `this.vs(\"${sheet}\",${r},${c})`;\n\t} else {\n\t\tdeps.push([r,c,r,c,\"\"]);\n\t\treturn `this.v(${r},${c})`;\n\t}\n}\n\nfunction methodCode(word){\n\treturn `this.m.${word}`;\n}\n\nfunction namedRangeCode(deps, view, word, sheet){\n\tvar code  = view.ranges.getCode(word, sheet);\n\tif(!code) return \"\";\n\n\tvar sheetInd = code.indexOf(\"!\");\n\tif (sheetInd !== -1){\n\t\tsheet = code.substr(0, sheetInd);\n\t\tif (sheet[0] === \"'\")\n\t\t\tsheet = sheet.substr(1, sheet.length-2);\n\t\tcode = code.substr(sheetInd+1);\n\t}\n\n\tlet [a,b] = code.split(\":\");\n\treturn rangeCode(deps, a, b, sheet);\n}\n\nfunction templateCode(word){\n\treturn `this.p.${word}`;\n}\n\nfunction rangeCode(deps, a, b, sheet){\n\tlet [r1,c1] = position(a);\n\tlet [r2,c2] = position(b);\n\n\tif (r1>r2) { let t=r1; r1=r2; r2=t; }\n\tif (c1>c2) { let t=c1; c1=c2; c2=t; }\n\t\n\tif (sheet === \"\"){\n\t\tdeps.push([r1,c1,r2,c2,\"\"]);\n\t\treturn `this.r(${r1},${c1},${r2},${c2})`;\n\t} else {\n\t\tdeps.push([r1,c1,r2,c2, sheet]);\n\t\treturn `this.rs(\"${sheet}\",${r1},${c1},${r2},${c2})`;\n\t}\n}\n\nexport function split(formula, crosssheet, ranges){\n\tvar lines = [];\n\tvar index = 0;\n\tvar quotes = false, ph = false;\n\tfor (var i = formula[i] === \"=\" ? 1 : 0; i < formula.length; i++){\n\t\tvar key = formula[i];\n\t\tif (key == \"\\\"\"){\n\t\t\tquotes = !quotes;\n\t\t} else if (!quotes){\n\t\t\tif (key == \"{\" && formula[i+1] == \"{\"){\n\t\t\t\tph = true;\n\t\t\t} else if (key == \"}\" && formula[i+1] == \"}\"){\n\t\t\t\tph = false;\n\t\t\t} else if (!ph){\n\t\t\t\tconst escaped = key === \"'\";\n\t\t\t\tif (escaped || isChar(key)){\n\t\t\t\t\tlet [word, end, ,sheet] = getWord(formula, i, \"\");\n\t\t\t\t\tlet next = end - 1;\n\t\t\t\t\tlet value;\n\t\t\t\t\tif (!sheet || (!crosssheet && sheet)){\n\t\t\t\t\t\tif(sheet){\n\t\t\t\t\t\t\t// 'sheet'! - 3 extra symbols, sheet! - 1 extra symbol\n\t\t\t\t\t\t\ti += sheet.length + (escaped ? 3 : 1);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (formula[next+1] !== \"(\" && (isPosition(word) || (ranges && ranges[word]))){\n\t\t\t\t\t\t\tvalue = crosssheet ? word : position(word);\n\t\t\t\t\t\t\tpushLine(lines, formula, i, index, value);\n\t\t\t\t\t\t\tindex = next+1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tif(crosssheet){\n\t\t\t\t\t\t\tvalue = [sheet, word, escaped];\n\t\t\t\t\t\t\tpushLine(lines, formula, i, index, value);\n\t\t\t\t\t\t\tindex = next+1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\ti = next;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tif (index!=formula.length)\n\t\tlines.push(formula.substr(index));\n\treturn lines;\n}\n\nfunction pushLine(lines, formula, i, index, value){\n\tif (i!==0)\n\t\tlines.push(formula.substr(index, i-index));\n\tlines.push(value);\n}\n\nexport function parse(formula, view, passive = \"\"){\n\tvar code =\"return \";\n\tvar deps = [];\n\n\tvar quotes = false;\n\tvar pair = \"\", pairsheet = \"\";\n\n\tif (formula[0] != \"=\") return false;\n\n\tfor (var i = 1; i < formula.length; i++){\n\t\tvar key = formula[i];\n\n\t\tif (key == \"\\\"\")\n\t\t\tquotes = !quotes;\n\t\telse if (key == \"{\" && formula[i+1] == \"{\"){\n\t\t\tlet [word, end] = getWord(formula, i+2);\n\t\t\ti = end + 1;\n\t\t\tcode += templateCode(word);\n\t\t\tcontinue;\n\t\t}\n\t\telse if (!quotes && (key == \"'\" || isChar(key))){\n\t\t\tlet [rawword, end, start, sheet] = getWord(formula, i, passive);\n\n\t\t\t//lower case formulas, fix them\n\t\t\tlet word = rawword.toUpperCase();\n\n\t\t\ti = end - 1;\n\n\t\t\t//errors like #REF!\n\t\t\tif(word[0] == \"#\"){\n\t\t\t\tcode += errorCode(word);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\telse if (formula[i+1] == \"(\"){\n\t\t\t\tcode += methodCode(word);\n\t\t\t}\n\t\t\telse if (isPosition(word)){\n\t\t\t\tif (formula[i+1] == \":\"){\n\t\t\t\t\tpair = word; pairsheet = sheet;\n\t\t\t\t\ti++;\n\t\t\t\t} else {\n\t\t\t\t\tif (pair !== \"\"){\n\t\t\t\t\t\tcode += rangeCode(deps, pair, word, pairsheet);\n\t\t\t\t\t\tpair = \"\";\n\t\t\t\t\t} else \n\t\t\t\t\t\tcode += operandCode(deps, word, sheet);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tlet range = namedRangeCode(deps, view, word, sheet);\n\t\t\t\t//we have some error word in a formula\n\t\t\t\t//break from loop to skip formula updating\n\t\t\t\tif (range == \"\"){\n\t\t\t\t\tcode += errorCode(\"#REF!\");\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcode += range;\n\t\t\t}\n\n\t\t\t//operator, or range, or parameter\n\t\t\tif (word !== rawword){\n\t\t\t\tformula = formula.substr(0, start)+word+formula.substr(end);\n\t\t\t}\n\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (!quotes){\n\t\t\t//special handling for & operator, string concat\n\t\t\tif (key === \"&\" && formula[i+1] !== \"&\")\n\t\t\t\tcode += \"+\";\n\t\t\t//convert <> to !=\n\t\t\telse if (key === \"<\" && formula[i+1] === \">\"){\n\t\t\t\tcode += \"!=\";\n\t\t\t\ti++;\n\t\t\t//convert = to ==\n\t\t\t} else if (key === \"=\" && formula[i-1] !== \"<\" && formula[i-1] !== \">\")\n\t\t\t\tcode += \"==\";\n\t\t\telse\n\t\t\t\tcode += key;\n\t\t} else\n\t\t\tcode += key;\n\t}\n\n\n\treturn { code: code+\";\", triggers:deps, text: formula };\n}","import en from \"./locales/en\";\nwebix.i18n.spreadsheet = en;","export default {\n\tlabels:{\n\t\t// formats\n\t\t\"common\": \"Common\",\n\t\t\"currency\": \"Currency\",\n\t\t\"number\": \"Number\",\n\t\t\"percent\": \"Percent\",\n\t\t\"date\": \"Date\",\n\t\t\"string\": \"Text\",\n\t\t\"custom-format\": \"Custom\",\n\t\t\"decimal-places\":\"Decimal places\",\n\t\t\"separator\":\"Group separator\",\n\t\t\"negative\":\"Negative number\",\n\t\t\"date-format\":\"Date format\",\n\t\t\"format-docs\":\"How to create a format\",\n\t\t// titles\n\t\t\"undo-redo\": \"Undo/Redo\",\n\t\t\"font\": \"Font\",\n\t\t\"text\": \"Text\",\n\t\t\"cell\": \"Cell\",\n\t\t\"align\": \"Align\",\n\t\t\"format\": \"Number\",\n\t\t\"column\": \"Column\",\n\t\t\"borders\": \"Borders\",\n\t\t\"px\": \"px\",\n\t\t\"apply\": \"Apply\",\n\t\t// popups and dialogs\n\t\t\"cancel\": \"Cancel\",\n\t\t\"save\": \"Save\",\n\t\t// multisheets\n\t\t\"sheet\": \"Sheet\",\n\t\t// conditions\n\t\t\"conditional-format\": \"Conditional Format\",\n\t\t\"condition\": \"Condition\",\n\t\t\"conditional-value\": \"Value\",\n\t\t\"conditional-style\": \"Style\",\n\t\t\"conditional-between\":\"between\",\n\t\t\"conditional-not-equal\":\"not equal\",\n\t\t// ranges\n\t\t\"range\": \"Range\",\n\t\t\"range-title\": \"Named ranges\",\n\t\t\"range-name\": \"Name\",\n\t\t\"range-cells\": \"Range\",\n\t\t// images\n\t\t\"image-or\": \"or\",\n\t\t\"image-title\": \"Add image\",\n\t\t\"image-upload\": \"Select file for upload\",\n\t\t\"image-url\": \"URL (e.g. http://*)\",\n\t\t// sparklines\n\t\t\"sparkline-title\": \"Add sparkline\",\n\t\t\"sparkline-type\": \"Type\",\n\t\t\"sparkline-range\": \"Range\",\n\t\t\"sparkline-color\": \"Color\",\n\t\t\"sparkline-positive\": \"Positive\",\n\t\t\"sparkline-negative\": \"Negative\",\n\t\t// custom format\n\t\t\"format-title\": \"Set format\",\n\t\t\"format-pattern\": \"Format pattern\",\n\t\t//dropdown\n\t\t\"dropdown-empty\": \"Empty cells\",\n\t\t\"dropdown-title\": \"Add dropdown\",\n\t\t\"dropdown-range\": \"Range\",\n\t\t// confirm\n\t\t\"ok\": \"OK\",\n\t\t// import/export\n\t\t\"import-title\": \"Import\",\n\t\t\"import-not-support\": \"Sorry, your browser does not support import\",\n\t\t\"export-title\": \"Export\",\n\t\t\"export-name\": \"Name of xslx file\",\n\t\t\"export-all-sheets\":\"Export all sheets\",\n\t\t// add link\n\t\t\"link-title\": \"Add Link\",\n\t\t\"link-name\": \"Text\",\n\t\t\"link-url\": \"URL\",\n\t\t//images\n\t\t\"image\": \"Image\",\n\t\t\"graph\": \"Graph\",\n\t\t//conditional format labels\n\t\t\"display\" : \"Display\",\n\t\t\"value\" : \"Value\",\n\t\t// confirm messages\n\t\t\"range-remove-confirm\": \"Are you sure you want to remove the range permanently?\",\n\t\t\"sheet-remove-confirm\": \"Are you sure you want to remove the sheet permanently?\",\n\t\t\"merge-cell-confirm\":\"Only the left top value will remain after merging. Continue?\",\n\t\t\"error-range\": \"The range is incorrect!\",\n\t\t//print\n\t\t\"print\":\"Print\",\n\t\t\"print-title\":\"Before you print..\",\n\t\t\"print-settings\":\"General settings\",\n\t\t\"print-paper\":\"Paper size\",\n\t\t\"print-layout\":\"Layout\",\n\t\t\"current-sheet\":\"Current sheet\",\n\t\t\"all-sheets\":\"All sheets\",\n\t\t\"selection\":\"Selected cells\",\n\t\t\"borderless\":\"Hide gridlines\",\n\t\t\"sheet-names\":\"Show sheet names\",\n\t\t\"skip-rows\":\"Skip empty rows\",\n\t\t\"margin\":\"Hide margins\",\n\t\t\"page-letter\":\"Letter\",\n\t\t\"page-a4\":\"A4 (210x297mm)\",\n\t\t\"page-a3\":\"A3 (297x420mm)\",\n\t\t\"page-width\":\"Page width\",\n\t\t\"page-actual\":\"Actual Size\",\n\t\t\"page-portrait\":\"Portrait\",\n\t\t\"page-landscape\":\"Landscape\",\n\t\t//comment\n\t\t\"comment\":\"Comment\",\n\t\t//resize\n\t\t\"width\":\"Width\",\n\t\t\"height\":\"Height\"\n\t},\n\ttooltips: {\n\t\t\"color\": \"Font color\",\n\t\t\"background\": \"Background color\",\n\t\t\"font-family\": \"Font family\",\n\t\t\"font-size\": \"Font size\",\n\t\t\"text-align\": \"Horizontal align\",\n\t\t\"vertical-align\": \"Vertical align\",\n\t\t\"borders\": \"Borders\",\n\t\t\"borders-no\": \"Clear borders\",\n\t\t\"borders-left\": \"Left border\",\n\t\t\"borders-top\": \"Top border\",\n\t\t\"borders-right\": \"Right border\",\n\t\t\"borders-bottom\": \"Bottom border\",\n\t\t\"borders-all\": \"All borders\",\n\t\t\"borders-outer\": \"Outer borders\",\n\t\t\"borders-top-bottom\": \"Top and bottom borders\",\n\t\t\"borders-color\": \"Border color\",\n\t\t\"align-left\": \"Left align\",\n\t\t\"align-center\": \"Center align\",\n\t\t\"align-right\": \"Right align\",\n\t\t\"align-top\": \"Top align\",\n\t\t\"align-middle\": \"Middle align\",\n\t\t\"align-bottom\": \"Bottom align\",\n\t\t\"span\": \"Merge\",\n\t\t\"wrap\": \"Text wrap\",\n\t\t\"undo\": \"Undo\",\n\t\t\"redo\": \"Redo\",\n\t\t\"format\": \"Number format\",\n\t\t\"increase-decimals\":\"Increase decimal places\",\n\t\t\"decrease-decimals\":\"Decrease decimal places\",\n\t\t\"font-weight\": \"Bold\",\n\t\t\"font-style\": \"Italic\",\n\t\t\"text-decoration\": \"Underline\",\n\t\t\"hide-gridlines\": \"Hide/show gridlines\",\n\t\t\"hide-headers\": \"Hide/show headers\",\n\t\t\"freeze-columns\" : \"Freeze/unfreeze columns\",\n\t\t\"add-range\": \"Set name for the selected range\",\n\t\t\"conditional\": \"Conditional formatting\",\n\t\t\"add-sheet\": \"Add Sheet\",\n\t\t\"lock-cell\": \"Lock/unlock cell\",\n\t\t\"clear\": \"Clear\",\n\t\t\"add-link\": \"Add link\",\n\t\t\"row\": \"Rows\",\n\t\t\"column\": \"Columns\",\n\t\t\"sheet\": \"Sheet\",\n\t\t\"add-image\": \"Image\",\n\t\t\"add-sparkline\": \"Graph\",\n\t\t\"add-comment\": \"Comment\"\n\t},\n\tmenus:{\n\t\t\"remove-sheet\": \"Remove sheet\",\n\t\t\"rename-sheet\": \"Rename sheet\",\n\t\t\"file\": \"File\",\n\t\t\"new\": \"New\",\n\t\t\"new-sheet\": \"New sheet\",\n\t\t\"excel-import\": \"Import from Excel\",\n\t\t\"excel-export\": \"Export to Excel\",\n\t\t\"sheet\": \"Sheets\",\n\t\t\"copy-sheet\": \"Copy to new sheet\",\n\t\t\"edit\": \"Edit\",\n\t\t\"undo\": \"Undo\",\n\t\t\"redo\": \"Redo\",\n\t\t\"columns\": \"Columns\",\n\t\t\"insert-column\": \"Insert column\",\n\t\t\"delete-column\": \"Delete column\",\n\t\t\"show-column\": \"Show column\",\n\t\t\"hide-column\": \"Hide column\",\n\t\t\"resize-column\": \"Resize column\",\n\t\t\"rows\": \"Rows\",\n\t\t\"insert-row\": \"Insert row\",\n\t\t\"delete-row\": \"Delete row\",\n\t\t\"show-row\": \"Show row\",\n\t\t\"hide-row\": \"Hide row\",\n\t\t\"resize-row\": \"Resize row\",\n\t\t\"insert\": \"Insert\",\n\t\t\"conditional-format\": \"Conditional format\",\n\t\t\"clear\": \"Clear\",\n\t\t\"clear-value\":\"Values\",\n\t\t\"clear-style\":\"Styles\",\n\t\t\"clear-conditional-formats\":\"Conditional formats\",\n\t\t\"clear-dropdown-editors\":\"Dropdowns and filters\",\n\t\t\"clear-comments\":\"Comments\",\n\t\t\"clear-all\":\"All\",\n\t\t\"add-image\": \"Image\",\n\t\t\"add-sparkline\": \"Graph\",\n\t\t\"data\": \"Data\",\n\t\t\"add-link\": \"Add link\",\n\t\t\"add-range\": \"Named ranges\",\n\t\t\"sort\": \"Sort\",\n\t\t\"sort-asc\": \"Sort A to Z\",\n\t\t\"sort-desc\": \"Sort Z to A\",\n\t\t\"create-filter\": \"Create filter\",\n\t\t\"view\": \"View\",\n\t\t\"freeze-columns\": \"Freeze/unfreeze columns\",\n\t\t\"freeze-rows\": \"Freeze/unfreeze rows\",\n\t\t\"hide-gridlines\": \"Hide/show gridlines\",\n\t\t\"hide-headers\": \"Hide/show headers\",\n\t\t\"add-dropdown\": \"Add dropdown\",\n\t\t\"lock-cell\": \"Lock/unlock cell\",\n\t\t\"print\": \"Print\",\n\t\t\"add-comment\":\"Comment\"\n\t},\n\ttable:{\n\t\t\"math-error\":\"ERROR\",\n\t\t\"format-error\":\"INCORRECT FORMAT\"\n\t},\n\tliveEditor:{\n\t\t\"edit\":\"Edit:\"\n\t},\n\tformats:{\n\t\t\"dateFormat\": \"mm/dd/yyyy\",\n\t\t\"timeFormat\": \"hh:mm AM/PM\",\n\t\t\"longDateFormat\": \"dd mmmm yyyy\",\n\t\t\"fullDateFormat\": \"mm/dd/yyyy hh:mm AM/PM\"\n\t}\n};\n","webix.protoUI({\n\tname: \"ssheet-align\",\n\t$cssName:\"richselect\",\n\t$init: function(config){\n\t\tconfig.options =  {\n\t\t\tview:\"datasuggest\",\n\t\t\tbody:{\n\t\t\t\tview: \"ssheet-icons\",\n\t\t\t\ttooltip: {\n\t\t\t\t\ttemplate:\"#tooltip#\"\n\t\t\t\t},\n\t\t\t\txCount:3, yCount:1\n\t\t\t},\n\t\t\tdata: config.data\n\t\t};\n\t}\n},webix.ui.richselect);","webix.protoUI({\n\tname: \"ssheet-borders-suggest\",\n\tdefaults:{\n\t\twidth: 300\n\t},\n\t$init: function(config){\n\t\tconfig.body = {\n\t\t\tmargin: 6,\n\t\t\tcols:[\n\t\t\t\t{ view: \"ssheet-icons\", scroll: false, select: true,\n\t\t\t\t\txCount: 4,\n\t\t\t\t\tyCount: 2,\n\t\t\t\t\ttooltip: {\n\t\t\t\t\t\ttemplate: function(obj){\n\t\t\t\t\t\t\treturn webix.i18n.spreadsheet.tooltips[\"borders-\"+obj.id];\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\ton:{\n\t\t\t\t\t\tonAfterSelect: function(){\n\t\t\t\t\t\t\tvar suggest = this.getParentView().getParentView();\n\t\t\t\t\t\t\tsuggest.updateMasterValue(true);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\ttemplate: function(obj){\n\t\t\t\t\t\tvar css = \"webix_ssheet_button_icon webix_ssheet_icon ssi-borders-\"+obj.value;\n\t\t\t\t\t\treturn \"<span class='\"+css+\"'></span>\";\n\t\t\t\t\t},\n\t\t\t\t\tdata: config.data\n\t\t\t\t},\n\t\t\t\t{ view: \"ssheet-separator\"},\n\t\t\t\t{\n\t\t\t\t\trows:[\n\t\t\t\t\t\t{ view: \"ssheet-color\", css: config.css,  name: config.name, width: 68, value: \"#000000\",\n\t\t\t\t\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[\"borders-color\"],\n\t\t\t\t\t\t\ttitle: \"<span class='webix_icon wxi-pencil'></span>\",\n\t\t\t\t\t\t\ton:{\n\t\t\t\t\t\t\t\tonChange: function(){\n\t\t\t\t\t\t\t\t\tvar suggest = this.getParentView().getParentView().getParentView();\n\t\t\t\t\t\t\t\t\tsuggest.updateMasterValue(false);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{ }\n\t\t\t\t\t]\n\t\t\t\t}\n\n\t\t\t]\n\t\t};\n\t},\n\tupdateMasterValue: function(hide){\n\t\tvar value = this.getValue();\n\t\tvar master = webix.$$(this.config.master);\n\t\tmaster.setValue(value);\n\t\tif(hide)\n\t\t\tthis.hide();\n\t},\n\tsetValue: function(value){\n\t\tif(value[0])\n\t\t\tthis.getList().select(value[0]);\n\t\tif(value[1])\n\t\t\tthis.getColorView().setValue(value[1]);\n\t},\n\tgetValue: function(){\n\t\treturn [this.getList().getSelectedId(), this.getColorView().getValue()||\"\"];\n\t},\n\tgetList: function(){\n\t\treturn this.getBody().getChildViews()[0];\n\t},\n\tgetColorView: function(){\n\t\treturn this.getBody().getChildViews()[2].getChildViews()[0];\n\t},\n\tgetItemText:function(){\n\t\treturn \"<span class='webix_ssheet_button_icon webix_ssheet_icon ssi-borders-all'>\";\n\t}\n},webix.ui.suggest);\n\nwebix.protoUI({\n\tname: \"ssheet-borders\",\n\t$cssName: \"richselect\",\n\t$init: function(config){\n\t\tconfig.options = {\n\t\t\tview: \"ssheet-borders-suggest\",\n\t\t\tfitMaster: false,\n\t\t\tdata: config.data\n\t\t};\n\n\t\tthis.$ready.push(webix.bind(function(){\n\t\t\tthis.getPopup().config.master = this.config.id;\n\t\t},this));\n\n\t},\n\tsetValue: function(value){\n\t\tif(webix.isArray(value)){\n\t\t\tif(!this.config.value || value[0] !=  this.config.value[0] || value[1] !=  this.config.value[1]){\n\t\t\t\tthis.getPopup().setValue(value);\n\t\t\t}\n\t\t\tthis.config.value = value;\n\t\t\tif (value[0])\n\t\t\t\tthis.callEvent(\"onChange\");\n\t\t}\n\t\treturn value;\n\t},\n\tgetValue: function(){\n\t\treturn  this.getPopup().getValue().join(\",\");\n\t},\n\tgetList: function(){\n\t\treturn this.getPopup().getBody().getChildViews()[0];\n\t},\n\tgetColorView: function(){\n\t\treturn this.getPopup().getBody().getChildViews()[1].getChildViews()[0];\n\t}\n},webix.ui.richselect);","// toolbar: color selector\nwebix.protoUI({\n\t$cssName: \"colorboard\",\n\tname: \"ssheet-colorboard\",\n\tdefaults:{\n\t\tcss: \"webix_ssheet_colorboard\",\n\t\tpalette: [\n\t\t\t[\"#000000\", \"#434343\", \"#666666\", \"#999999\", \"#b7b7b7\", \"#cccccc\", \"#d9d9d9\", \"#efefef\", \"#f3f3f3\", \"#ffffff\"],\n\t\t\t[\"#980000\", \"#ff0000\", \"#ff9900\", \"#ffff00\", \"#00ff00\", \"#00ffff\", \"#4a86e8\", \"#0000ff\", \"#9900ff\", \"#ff00ff\"],\n\t\t\t[\"#e6b8af\", \"#f4cccc\", \"#fce5cd\", \"#fff2cc\", \"#d9ead3\", \"#d0e0e3\", \"#c9daf8\", \"#cfe2f3\", \"#d9d2e9\", \"#ead1dc\"],\n\t\t\t[\"#dd7e6b\", \"#ea9999\", \"#f9cb9c\", \"#ffe599\", \"#b6d7a8\", \"#a2c4c9\", \"#a4c2f4\", \"#9fc5e8\", \"#b4a7d6\", \"#d5a6bd\"],\n\t\t\t[\"#cc4125\", \"#e06666\", \"#f6b26b\", \"#ffd966\", \"#93c47d\", \"#76a5af\", \"#6d9eeb\", \"#6fa8dc\", \"#8e7cc3\", \"#c27ba0\"],\n\t\t\t[\"#a61c00\", \"#cc0000\", \"#e69138\", \"#f1c232\", \"#6aa84f\", \"#45818e\", \"#3c78d8\", \"#3d85c6\", \"#674ea7\", \"#a64d79\"],\n\t\t\t[\"#85200c\", \"#990000\", \"#b45f06\", \"#bf9000\", \"#38761d\", \"#134f5c\", \"#1155cc\", \"#0b5394\", \"#351c75\", \"#741b47\"],\n\t\t\t[\"#5b0f00\", \"#660000\", \"#783f04\", \"#7f6000\", \"#274e13\", \"#0c343d\", \"#1c4587\", \"#073763\", \"#20124d\", \"#4c1130\"]\n\t\t]\n\t}\n},webix.ui.colorboard);\n\nwebix.protoUI({\n\t$cssName: \"richselect\",\n\tname: \"ssheet-color\",\n\tdefaults:{\n\t\tcss: \"webix_ssheet_color\",\n\t\ticon: \"wxi-menu-down\",\n\t\tsuggest:{\n\t\t\tborderless: true,\n\t\t\tbody:{\n\t\t\t\tview: \"ssheet-colorboard\",\n\t\t\t\theight: 202,\n\t\t\t\ton:{\n\t\t\t\t\tonSelect: function(value){\n\t\t\t\t\t\tthis.getParentView().setMasterValue({ value:value });\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\t$init: function(){\n\t\tthis.$view.className += \" webix_ssheet_color\";\n\t},\n\t$renderInput: function(config, divStart, id){\n\t\tvar color  = this.renderColor.call(this);\n\t\tdivStart = divStart.replace(/([^>]>)(.*)(<\\/div)/, function(match, p1, p2, p3){\n\t\t\treturn p1+config.title +color+p3;\n\t\t});\n\n\t\treturn webix.ui.colorpicker.prototype.$renderInput.call(this,config, divStart, id);\n\t},\n\t$setValue: function(value){\n\t\tvar popup =  webix.$$(this.config.popup.toString());\n\t\tvar colorboard = popup.getBody();\n\t\tif(value){\n\t\t\tcolorboard.setValue(value);\n\t\t\tthis.config.value = value;\n\t\t\tthis.getColorNode().style.backgroundColor = value;\n\t\t}\n\n\t},\n\trenderColor: function(){\n\t\treturn \"<div class='webix_ssheet_cp_color' style='background-color:\"+this.config.value+\";'> </div>\";\n\t},\n\tgetColorNode: function(){\n\t\treturn this.$view.firstChild.firstChild.childNodes[1];\n\t},\n\t$renderIcon:function(){\n\t\treturn webix.ui.text.prototype.$renderIcon.apply(this,arguments);\n\t}\n},webix.ui.colorpicker);","webix.protoUI({\n\t$cssName: \"window\",\n\tname: \"ssheet-dialog\",\n\t$init: function(config){\n\t\tthis.$view.className += \" webix_ssheet_dialog\";\n\t\tthis.config.buttons = config.buttons;\n\t},\n\tgetHeaderConfig: function(label){\n\t\treturn {\n\t\t\tpaddingX: 10,\n\t\t\tpaddingY: 5,\n\t\t\theight: 60,\n\t\t\tcols: [\n\t\t\t\t{ view: \"label\", label: label},\n\t\t\t\t{ view: \"icon\", css:\"webix_ssheet_hide_icon\", icon:\"webix_ssheet_icon ssi-close\", width: 50, click: function(){\n\t\t\t\t\tvar parentView = this.getTopParentView();\n\t\t\t\t\tparentView.callEvent(\"onHideClick\",[]);\n\t\t\t\t}}\n\t\t\t]\n\t\t};\n\t},\n\tgetBodyConfig: function(content){\n\t\tcontent.borderless = true;\n\t\tvar elements = this.getFormElements(content);\n\t\tvar config = {\n\t\t\tview: \"form\",\n\t\t\tcss: \"webix_ssheet_form\",\n\t\t\tpaddingY: 0,\n\t\t\telements: elements\n\t\t};\n\t\treturn config;\n\t},\n\tgetFormElements: function(content){\n\t\tvar elements;\n\t\tif(webix.isArray(content))\n\t\t\telements= content;\n\t\telse{\n\t\t\telements = [];\n\t\t\telements.push(content);\n\t\t}\n\t\tif(this.config.buttons){\n\t\t\telements.push({height:1});\n\t\t\telements.push( {\n\t\t\t\tmargin: 10,\n\t\t\t\tcols:[\n\t\t\t\t\t{},\n\t\t\t\t\t{view: \"button\", css: \"ssheet_cancel_button\", label: webix.i18n.spreadsheet.labels.cancel, autowidth:true, click: function(){\n\t\t\t\t\t\tvar parentView = this.getTopParentView();\n\t\t\t\t\t\tparentView.callEvent(\"onCancelClick\",[]);\n\t\t\t\t\t}},\n\t\t\t\t\t{view: \"button\", label: webix.i18n.spreadsheet.labels.save, autowidth:true, click: function(){\n\t\t\t\t\t\tvar parentView = this.getTopParentView();\n\t\t\t\t\t\tparentView.callEvent(\"onSaveClick\",[]);\n\t\t\t\t\t}}\n\t\t\t\t]\n\t\t\t});\n\t\t}\n\t\telements.push({height:10, borderless: true});\n\t\treturn elements;\n\t},\n\tbody_setter: function(value){\n\t\tif(typeof value == \"object\"){\n\t\t\tvalue.paddingY = value.paddingY||0;\n\t\t\tif(value.view == \"form\" && value.elements){\n\t\t\t\tvalue.elements = this.getFormElements(value.elements);\n\t\t\t\tif(!value.css)\n\t\t\t\t\tvalue.css = \"webix_ssheet_form\";\n\t\t\t}\n\t\t\telse\n\t\t\t\tvalue = this.getBodyConfig(value);\n\t\t}\n\n\t\treturn webix.ui.window.prototype.body_setter.call(this,value);\n\t},\n\thead_setter:function(value){\n\t\tif(value){\n\t\t\tvalue = this.getHeaderConfig(value);\n\t\t}\n\t\treturn webix.ui.window.prototype.head_setter.call(this,value);\n\t},\n\tdefaults:{\n\t\tpadding:0,\n\t\tmove:true,\n\t\thead: true,\n\t\tbuttons: true,\n\t\t//we need to retain focus in table area, so disabling the autofocusing feature\n\t\tautofocus:false,\n\t\twidth: 350\n\t}\n}, webix.ui.window, webix.IdSpace);\n\n\n\nwebix.protoUI({\n\t$cssName: \"datatable\",\n\tname: \"ssheet-dialog-table\",\n\t$init: function(config){\n\t\tif(!config.headerRowHeight)\n\t\t\tconfig.headerRowHeight = 34;\n\t\tthis.$view.className += \" webix_ssheet_table webix_ssheet_dialog_table\";\n\t}\n},webix.ui.datatable);","webix.protoUI({\n\tname: \"ssheet-form-popup\",\n\tdefaults:{\n\t\tpadding:0,\n\t\tborderless: true\n\t},\n\t$init: function(){\n\t\tthis.$view.className += \" webix_ssheet_form\";\n\t}\n}, webix.ui.suggest);\n\nwebix.protoUI({\n\tname: \"ssheet-form-suggest\",\n\tdefaults:{\n\t\tpadding:0,\n\t\tborderless: true\n\t},\n\t$init: function(){\n\t\tthis.$view.className += \" webix_ssheet_suggest\";\n\t}\n}, webix.ui.suggest);\n\nwebix.protoUI({\n\t$cssName: \"colorpicker\",\n\tname: \"ssheet-colorpicker\",\n\t$init: function(){\n\t\tthis.$view.className += \" webix_ssheet_colorpicker\";\n\t},\n\tdefaults:{\n\t\ticon: \"wxi-menu-down\",\n\t\tsuggest:{\n\t\t\tborderless: true,\n\t\t\tbody:{\n\t\t\t\tview: \"ssheet-colorboard\",\n\t\t\t\theight: 202,\n\t\t\t\ton:{\n\t\t\t\t\tonSelect: function(value){\n\t\t\t\t\t\tthis.getParentView().setMasterValue({ value:value });\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n},webix.ui.colorpicker);","webix.protoUI({\n\tname:\"formlate\",\n\tsetValue:function(a){ return this.setHTML(a); },\n\tgetValue:function(){ return \"\"; }\n}, webix.ui.template);","webix.protoUI({\n\tname:\"ssheet-icons\",\n\t$cssName: \"dataview\",\n\t$init: function(){\n\t\tthis.$view.className += \" webix_ssheet_dataview\";\n\t},\n\tdefaults:{\n\t\tborderless: true,\n\t\ttemplate: \"<span class='webix_ssheet_button_icon #css#' ></span>\",\n\t\ttype:{\n\t\t\twidth: 36,\n\t\t\theight: 36\n\t\t}\n\t}\n},webix.ui.dataview);","webix.protoUI({\n\tname: \"ssheet-suggest\",\n\tdefaults:{\n\t\tpadding:0,\n\t\tcss: \"webix_ssheet_suggest\"\n\t}\n},webix.ui.contextmenu);","webix.protoUI({\n\tname: \"suggest-formula\",\n\tdefaults: {\n\t\tfitMaster: false,\n\t\twidth: 200,\n\t\tfilter(item, value) {\n\t\t\tconst editor = webix.$$(this.config.master);\n\t\t\tconst cursor = editor.getInputNode().selectionStart;\n\t\t\tconst val = editor.getValue();\n\n\t\t\tif(val.charAt(0) !== \"=\") return;\n\n\t\t\tlet str1 = val.substring(0, cursor).match(/([a-zA-Z]+)$/);\n\t\t\tlet str2 = val.charAt(cursor).search(/[^A-Za-z0-9]/);\n\n\t\t\tif(str1 && (cursor === val.length || str2 === 0))\n\t\t\t\tvalue = str1[0];\n\n\t\t\treturn item.value.toString().toLowerCase().indexOf(value.toLowerCase()) === 0;\n\t\t}\n\t},\n\t$init() {\n\t\tthis.attachEvent(\"onBeforeShow\", (node) => {\n\t\t\tif(node.tagName){\n\t\t\t\tconst editor = webix.$$(this.config.master);\n\t\t\t\tconst text = editor.getValue();\n\n\t\t\t\t//only for formulas\n\t\t\t\tif(!text || text.charAt(0) !== \"=\") return false;\n\n\t\t\t\tconst sizes = webix.html.offset(node);\n\n\t\t\t\tconst selectionStart = editor.getInputNode().selectionStart;\n\t\t\t\tconst textWidth = webix.html.getTextSize(text.substring(0, selectionStart), \"webix_ssheet_formula\").width;\n\n\t\t\t\tconst y = sizes.y + sizes.height;\n\t\t\t\tconst x = sizes.x + textWidth;\n\n\t\t\t\twebix.ui.popup.prototype.show.apply(this, [{x, y}]);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\t},\n\tsetMasterValue(data, refresh) {\n\t\tconst text = data.id ? this.getItemText(data.id) : (data.text||data.value);\n\t\twebix.$$(this.config.master).setValueHere(text);\n\n\t\tif (!refresh)\n\t\t\tthis.hide(true);\n\n\t\tthis.callEvent(\"onValueSuggest\", [data, text]);\n\t},\n\t$enterKey: function() {\n\t\tif (this.isVisible())\n\t\t\treturn webix.ui.suggest.prototype.$enterKey.apply(this, arguments);\n\t}\n}, webix.ui.suggest);","webix.protoUI({\n\tname: \"ssheet-button\",\n\t$cssName: \"button\",\n\tdefaults:{\n\t\ttype:\"htmlbutton\",\n\t\twidth: 40\n\t},\n\t$init: function(config){\n\t\tthis.$view.className += \" webix_ssheet_button\"+(config.arrow?\" webix_ssheet_button_menu\":\"\");\n\t\tif(config.label || config.icon){\n\t\t\tlet icon = (config.icon||config.name),\n\t\t\t\ttext = config.label||\"\";\n\t\t\tif(config.arrow)\n\t\t\t\ttext += \"<span class='webix_ssheet_button_icon webix_ssheet_icon_arrow webix_icon wxi-menu-down'></span>\";\n\t\t\tconfig.label = \"<span class='webix_ssheet_button_icon webix_ssheet_icon ssi-\"+icon+\"'></span> \"+text;\n\t\t\tconfig.tooltip = webix.i18n.spreadsheet.tooltips[config.name]||\"\";\n\t\t}\n\t\tif(config.options && !config.popup)\n\t\t\tconfig.popup = getPopupConfig(config.options);\n\t}\n},webix.ui.button);\n\n\nwebix.protoUI({\n\tname: \"ssheet-button-icon-top\",\n\t$cssName: \"button\",\n\tdefaults:{\n\t\ttype:\"htmlbutton\",\n\t\twidth: 70,\n\t\theight: 70\n\t},\n\t$init: function(config){\n\t\tthis.$view.className += \" ssheet_button_icon_top\";\n\t\tif(config.label) {\n\t\t\tlet icon = (config.icon || config.name||\"\"),\n\t\t\t\ttext = config.label;\n\t\t\tconfig.label = \"<span class='webix_ssheet_button_icon webix_ssheet_icon ssi-\" + icon + \"'></span><br/>\";\n\t\t\tconfig.label += \"<span class='ssheet_button_icon_top_text'>\"+text+\"</span>\";\n\t\t\tif (config.arrow)\n\t\t\t\tconfig.label += \"<br/><span class='ssheet_button_icon_top_arrow webix_icon wxi-menu-down'></span>\";\n\t\t\tconfig.tooltip = webix.i18n.spreadsheet.tooltips[config.name]||\"\";\n\t\t}\n\t\tif(config.options && !config.popup)\n\t\t\tconfig.popup = getPopupConfig(config.options);\n\t}\n},webix.ui.button);\n\n\nfunction getPopupConfig(options){\n\treturn {\n\t\tview: \"ssheet-suggest\",\n\t\tcss: \"webix_ssheet_suggest\",\n\t\tautowidth:true,\n\t\ttemplate: function(obj){\n\t\t\tvar text = \"\";\n\t\t\tif(obj.icon)\n\t\t\t\ttext += \"<span class='webix_ssheet_button_icon webix_ssheet_icon ssi-\" + obj.icon + \"'></span> \";\n\t\t\ttext += obj.value || webix.i18n.spreadsheet.menus[obj.id] || obj.id;\n\t\t\treturn text;\n\t\t},\n\t\tdata: options,\n\t\ton:{\n\t\t\tonItemClick: function(id){\n\t\t\t\tvar button = this.config.master;\n\t\t\t\tif(button){\n\t\t\t\t\tlet view = webix.$$(button).getTopParentView();\n\t\t\t\t\tvar params = [this.getItem(id)];\n\t\t\t\t\tif(webix.$$(button).config.area){\n\t\t\t\t\t\tlet area = view.$$(\"cells\").getSelectArea();\n\t\t\t\t\t\tif(area)\n\t\t\t\t\t\t\tparams = params.concat([area.start,area.end]);\n\t\t\t\t\t}\n\t\t\t\t\tview.callEvent(\"onCommand\",params);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n}","export function dayOfTheYear(date){\n\tconst start = new Date(date.getFullYear(), 0, 0);\n\tconst diff = (date - start) + ((start.getTimezoneOffset() - date.getTimezoneOffset()) * 60 * 1000);\n\treturn Math.floor(diff / (1000 * 60 * 60 * 24));\n}\n\nexport function getJsDateFromExcel(excelDate) {\n\tconst date = new Date((excelDate - 25569) * 86400 * 1000);\n\treturn new Date(date.getTime() + date.getTimezoneOffset() * 60000);\n}\n\nexport function getExcelDateFromJs(jsDate) {\n\tconst returnDateTime = 25569 + ((jsDate.getTime() - (jsDate.getTimezoneOffset() * 60000)) / (86400 * 1000));\n\treturn returnDateTime.toString();\n}\n\nexport function _to_number(v){\n\tif(v || v === 0){\n\t\tv = v*1;\n\t\tif(!isNaN(v)) return v;\n\t}\n\treturn false;\n}\n\nexport function _combine(data){\n\tvar arr = [];\n\tfor (var i = 0; i < data.length; i++){\n\t\tarr = arr.concat(data[i]);\n\t}\n\treturn arr;\n}","import \"./suggest_formula\";\nimport {split, position} from \"../math/parser\";\n\nwebix.protoUI({\n\tname: \"live-editor\",\n\t$cssName:\"texthighlight\",\n\t$init(config){\n\t\tconfig.suggest = {\n\t\t\tview: \"suggest-formula\",\n\t\t\tdata: config.suggestData\n\t\t};\n\t\tconfig.highlight = this.highlight;\n\n\t\tthis._highlightedCells = {};\n\t\tthis.$view.className += \" webix_ssheet_formula\";\n\n\t\tthis.attachEvent(\"onKeyPress\", (code, e) => {\n\t\t\tdelete this._update_range;\n\t\t\tif(code === 13) {\n\t\t\t\t//ignore Enter key if it was pressed to select some value from suggest\n\t\t\t\tif ((new Date() - (this._last_value_set || 0)) > 300){\n\t\t\t\t\tthis.showActiveSheet();\n\t\t\t\t\tthis.updateCellValue();\n\t\t\t\t\t//we have 'enter' hot key to activate editor\n\t\t\t\t\twebix.delay(()=>{\n\t\t\t\t\t\tthis.getTopParentView()._table.moveSelection(\"down\");\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\twebix.html.preventEvent(e);\n\t\t\t}\n\t\t});\n\n\t\tthis.attachEvent(\"onAfterRender\", function(){\n\t\t\twebix.eventRemove(this.keydownEv);\n\n\t\t\tthis.keydownEv = webix.event(this.getInputNode(), \"keydown\", e => {\n\t\t\t\tthis.endEdit(e);\n\t\t\t});\n\t\t});\n\t},\n\thighlight(value){\n\t\tlet html = \"\";\n\t\tconst master = this.getTopParentView();\n\t\tconst escapeText = webix.template.escape;\n\n\t\tfor(let area in this._highlightedCells){\n\t\t\tconst cells = this._highlightedCells[area];\n\t\t\tthis.changeCellCss(cells[0], cells[1], cells[2], true);\n\t\t}\n\t\tthis._highlightedCells = {};\n\n\t\t//value can be null\n\t\tif(value && value[0]==\"=\"){\n\t\t\tconst ranges = master.ranges._ranges;\n\t\t\tconst parts = split(value, true, ranges);\n\t\t\tconst sheet = master.getActiveSheet();\n\n\t\t\tlet colorIndex = 1;\n\n\t\t\tfor(let i = 0; i < parts.length; i++){\n\t\t\t\tif((i+1)%2 != 0)\n\t\t\t\t\thtml += escapeText(parts[i]);\n\t\t\t\telse{\n\t\t\t\t\tconst crossheet = webix.isArray(parts[i]);\n\t\t\t\t\tconst cellSheet = crossheet ? this.prepareSheet(parts[i][0], parts[i][2]) : \"\";\n\t\t\t\t\tconst activeMath = this._activeMath;\n\n\t\t\t\t\tconst activeSheet = !crossheet && (!activeMath || activeMath == sheet);\n\t\t\t\t\tlet cell = position(crossheet ? parts[i][1] : parts[i]);\n\t\t\t\t\tconst cellText = crossheet ? cellSheet+parts[i][1] : parts[i];\n\n\t\t\t\t\tconst rangeName = /^[A-Za-z]+$/.test(parts[i]);\n\t\t\t\t\tif(activeSheet || (crossheet && parts[i][0] == sheet)){\n\t\t\t\t\t\tlet repeatedColor;\n\t\t\t\t\t\t//range\n\t\t\t\t\t\tif((parts[i+1] == \":\" && parts[i+2]) || rangeName){\n\t\t\t\t\t\t\tlet nextCell, nextCellText;\n\n\t\t\t\t\t\t\tif(rangeName){\n\t\t\t\t\t\t\t\tconst cells = ranges[parts[i]].split(\":\");\n\t\t\t\t\t\t\t\tcell = position(cells[0]);\n\t\t\t\t\t\t\t\tnextCell = position(cells[1]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\tnextCell = position(crossheet ? parts[i+2][1] : parts[i+2]);\n\t\t\t\t\t\t\t\tnextCellText = crossheet ? cellSheet+parts[i+2][1] : parts[i+2];\n\t\t\t\t\t\t\t\ti+=2;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\trepeatedColor = this.setColor(cell[0], cell[1], nextCell[0], nextCell[1], colorIndex);\n\t\t\t\t\t\t\thtml += `<span class=\"webix_ssheet_highlight_color_${repeatedColor||colorIndex}\">${rangeName ? parts[i] : cellText+\":\"+nextCellText}</span>`;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//cell\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\trepeatedColor = this.setColor(cell[0], cell[1], cell[0], cell[1], colorIndex);\n\t\t\t\t\t\t\thtml += `<span class=\"webix_ssheet_highlight_color_${repeatedColor||colorIndex}\">${cellText}</span>`;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst colors = 7;\n\t\t\t\t\t\tif(!repeatedColor)\n\t\t\t\t\t\t\tcolorIndex += colorIndex == colors ? -1*(colors-1) : 1;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t\thtml += cellText;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse\n\t\t\thtml = escapeText(value);\n\n\t\tmaster.$$(\"cells\").refresh();\n\n\t\tif(document.activeElement == this.getInputNode())\n\t\t\tthis.paintValue();\n\t\treturn html;\n\t},\n\tshowActiveSheet(){\n\t\tconst master = this.getTopParentView();\n\t\tdelete master.$handleSelection;\n\n\t\tif(this._activeMath){\n\t\t\tif(this._activeMath != master.getActiveSheet()){\n\t\t\t\tconst val = this.getValue();\n\n\t\t\t\tconst cell = this.config.activeCell;\n\t\t\t\tthis.define({activeCell:null});\n\n\t\t\t\tmaster.showSheet(this._activeMath);\n\n\t\t\t\twebix.delay(()=>{\n\t\t\t\t\tmaster._table.select(cell.row, cell.column);\n\t\t\t\t\tthis.setValue(val);\n\t\t\t\t\tthis.updateCellValue();\n\t\t\t\t});\n\t\t\t}\n\t\t\tdelete this._activeMath;\n\t\t}\n\t},\n\tchangeCellCss(row, col, index, remove){\n\t\tconst css = `webix_ssheet_highlight_background_${index}`;\n\t\tfor (let r = row.start; r <= row.end; r++)\n\t\t\tfor (let c = col.start; c <=  col.end; c++)\n\t\t\t\tthis.getTopParentView().$$(\"cells\")[remove?\"removeCellCss\":\"addCellCss\"](r, c, css, true);\n\t},\n\tendEdit(e){\n\t\tlet code = e.which || e.keyCode;\n\n\t\t//if it is a formula - force user to finish it by click outside or 'enter'\n\t\tif(code == 9 || (code>36 && code<41 && this.getValue().charAt(0)!==\"=\")){\n\t\t\tlet dir = (code == 40)?\"down\":(code === 39?\"right\":(code ==37?\"left\":\"up\"));\n\t\t\tif (code === 9)\n\t\t\t\tdir = \"right\";\n\n\t\t\tthis.updateCellValue();\n\t\t\tthis.getTopParentView()._table.moveSelection(dir);\n\t\t}\n\t},\n\tpaintValue(){\n\t\tlet master = this.getTopParentView();\n\t\tif(!this._activeMath || this._activeMath == master.getActiveSheet()){\n\t\t\tlet cell = this.config.activeCell;\n\t\t\tlet node = master._table.getItemNode(cell);\n\t\t\tif(cell && node) \n\t\t\t\tnode.innerHTML = webix.template.escape(this.getValue());\n\t\t}\n\t},\n\tupdateCellValue() {\n\t\tlet newv = this.getValue();\n\t\tlet master = this.getTopParentView();\n\t\tlet cell = this.config.activeCell;\n\n\t\tif (!cell)\n\t\t\tthis.setValue(\"\");\n\t\telse if (newv != master.getCellValue(cell.row, cell.column)){\n\t\t\tthis.config.value = newv;\n\t\t\tmaster.setCellValue(cell.row, cell.column, newv);\n\t\t\tmaster.refresh();\n\t\t}\n\t},\n\t$setValueHere(value){\n\t\tthis.setValueHere(value);\n\t},\n\tsetValueHere(value) {\n\t\tthis._last_value_set = new Date();\n\n\t\tconst formula = this.getValue();\n\t\tif(formula && formula.charAt(0)===\"=\"){\n\t\t\tconst cursor = this.getInputNode().selectionStart;\n\t\t\tlet str1 = formula.substring(0, cursor);\n\t\t\tlet str2 = formula.substring(cursor);\n\t\t\tconst updatedStr = str1.replace(/([a-zA-Z(]+)$/, value);\n\n\t\t\t//suggest called via up/down key\n\t\t\tstr1 = (updatedStr == str1 ? str1 + value : updatedStr) + \"(\";\n\n\t\t\tthis.setValue(str1 + str2);\n\t\t\tthis.getInputNode().setSelectionRange(str1.length, str1.length);\n\t\t}\n\t},\n\texpectRange(){\n\t\tlet text = this.getValue().trim();\n\t\tlet last = text.substr(text.length-1,1);\n\t\treturn last.match(/[(,]/);\n\t},\n\texpectOperator(){\n\t\tlet text = this.getValue();\n\t\tconst cursor = this.getInputNode().selectionStart;\n\t\treturn text[0] == \"=\" && text[cursor-1] && text[cursor-1].match(/[+&\\-/*%=(:,]/);\n\t},\n\tsetRange(range, replace){\n\t\tconst cursor = this.getInputNode().selectionStart;\n\t\tconst formula = this.getValue();\n\n\t\tlet str1, str2;\n\n\t\t//check if range was added by click\n\t\tif(replace)\n\t\t\treplace = this._update_range && cursor == this._update_range.pos + this._update_range.len;\n\n\t\tconst lastPos = replace ? this._update_range.pos : cursor;\n\n\t\tstr1 = formula.substring(0, lastPos) + range;\n\t\tstr2 = formula.substring(cursor);\n\n\t\tthis._update_range = {pos: lastPos, len: range.length};\n\n\t\tthis.setValue(str1 + str2);\n\t\tthis.getInputNode().setSelectionRange(str1.length, str1.length);\n\t},\n\tprepareSheet(sheet, escaped){\n\t\tconst condition = webix.isUndefined(escaped) ? sheet.indexOf(\" \") != -1 : escaped;\n\t\treturn (condition ? `'${sheet}'` : sheet) + \"!\";\n\t},\n\tprepareArea(first, second){\n\t\treturn {\n\t\t\tstart: Math.min(first, second),\n\t\t\tend: Math.max(first, second)\n\t\t};\n\t},\n\tsetColor(row1, col1, row2, col2, color){\n\t\tconst row = this.prepareArea(row1, row2);\n\t\tconst col = this.prepareArea(col1, col2);\n\t\tconst index = [row.start, row.end, col.start, col.end].join(\",\");\n\t\tconst coloredArea = this._highlightedCells[index];\n\n\t\tif(!coloredArea){\n\t\t\tthis._highlightedCells[index] = [row, col, color];\n\t\t\tthis.changeCellCss(row, col, color);\n\t\t}\n\t\telse\n\t\t\treturn coloredArea[2];\n\t}\n}, webix.ui.texthighlight);","webix.protoUI({\n\tname: \"ssheet-separator\",\n\tdefaults:{\n\t\tcss: \"webix_ssheet_toolbar_spacer\",\n\t\ttemplate: \" \",\n\t\twidth: 1,\n\t\tborderless: true\n\t}\n},webix.ui.view);","webix.protoUI({\n\tname: \"sheets\",\n\tdefaults:{\n\t\tlayout: \"x\",\n\t\tborderless: true,\n\t\tcss:\"ssheet_list_sheets\",\n\t\tselect: true,\n\t\tdrag: \"order\",\n\t\tdragscroll:\"x\",\n\t\tscroll:false\n\t}\n},webix.EditAbility,webix.ui.list);","// toolbar: toogle button\nwebix.protoUI({\n\t$cssName: \"toggle\",\n\tname:\"ssheet-toggle\",\n\ttoggle:function(){\n\t\tvar value = this.getValue() == this.config.onValue?true:false;\n\t\tthis.setValue(!value);\n\t},\n\t$setValue:function(value){\n\t\tif(value == this.config.offValue)\n\t\t\tvalue = false;\n\t\telse if(value == this.config.onValue)\n\t\t\tvalue = true;\n\t\twebix.ui.toggle.prototype.$setValue.call(this,value);\n\t},\n\tgetValue:function(){\n\t\tvar config = this.config;\n\t\tvar value = config.value;\n\t\treturn  !value || value==config.offValue?(config.offValue||false):(config.onValue||true);\n\t},\n\tdefaults:{\n\t\ttemplate:function(obj, common){\n\t\t\tvar css = (obj.value === true ||obj.value == obj.onValue) ? \" webix_pressed\" : \"\";\n\t\t\tvar inp = common.$renderInput(obj, common);\n\t\t\treturn \"<div class='webix_el_box\"+css+\"' style='width:\"+obj.awidth+\"px; height:\"+obj.aheight+\"px'>\"+inp+\"</div>\";\n\t\t}\n\t}\n}, webix.ui.toggle);","webix.protoUI({\n\tname: \"ssheet-bar-title\",\n\tdefaults:{\n\t\tborderless: true\n\t},\n\t$init: function(){\n\t\tthis.$view.className += \" webix_ssheet_subbar_title\";\n\t}\n},webix.ui.template);","webix.protoUI({\n\tname:\"multicheckbox\",\n\tdefaults:{\n\t\tpadding:0,\n\t\ttype:\"clean\",\n\t\tborderless:true,\n\t\telementsConfig:{\n\t\t\tlabelWidth:10\n\t\t}\n\t},\n\t$init:function(config){\n\t\tconfig.rows = [{height:0.000001}];\n\t\tthis.$ready.push(function(){\n\t\t\tthis._initOnChange();\n\t\t});\n\t},\n\t_initOnChange(){\n\t\tthis.attachEvent(\"onChange\", function(newv){\n\t\t\tconst name = this.$eventSource.config.name;\n\n\t\t\tthis.blockEvent();\n\t\t\tif(name == \"$all\"){\n\t\t\t\tfor(let i in this.elements)\n\t\t\t\t\tthis.elements[i].setValue(newv);\n\t\t\t\tif(!newv)\n\t\t\t\t\tthis._getCheckboxes()[0].setValue(1);\n\t\t\t}\n\t\t\telse{\n\t\t\t\tconst count = this.getValue().length;\n\t\t\t\tthis.elements.$all.setValue(count == this._count ? 1 : 0);\n\t\t\t\tif(!count)\n\t\t\t\t\tthis._getCheckboxes()[0].setValue(1);\n\t\t\t}\n\t\t\tthis.unblockEvent();\n\t\t});\n\t},\n\tsetValue:function(value){\n\t\tthis.elements = {};\n\t\tthis._count = value.length;\n\n\t\tif(value.length > 1){\n\t\t\tlet elements = [];\n\t\t\tlet base = [];\n\t\t\tconst maxHeight = 400;\n\n\t\t\tvalue.forEach(sheet => {\n\t\t\t\tbase.push({ view: \"checkbox\", labelRight: sheet.name, name: sheet.name, value: sheet.active});\n\t\t\t});\n\n\t\t\tconst baseHeight = base.length * webix.skin.$active.inputHeight;\n\t\t\tconst scroll = baseHeight > maxHeight;\n\n\t\t\telements.push({\n\t\t\t\tview:\"scrollview\", body:{rows:base},\n\t\t\t\tscroll: scroll,\n\t\t\t\theight: scroll ? maxHeight : baseHeight\n\t\t\t});\n\n\t\t\telements.push({ template:\"<div class='ss_sep_line'></div>\", height:10 });\n\t\t\telements.push({ view:\"checkbox\", labelRight:webix.i18n.spreadsheet.labels[\"export-all-sheets\"], name:\"$all\", value:0 });\n\n\t\t\twebix.ui(elements, this);\n\t\t}\n\t\telse if(this.getChildViews().length > 1){\n\t\t\twebix.ui([{height:0.000001}], this);\n\t\t}\n\t},\n\tgetValue:function(){\n\t\tconst checkboxes = this._getCheckboxes();\n\t\tlet output = [];\n\n\t\t//save order\n\t\tfor(let i = 0; i < checkboxes.length; i++)\n\t\t\tif(checkboxes[i].getValue())\n\t\t\t\toutput.push(checkboxes[i].config.name);\n\n\t\treturn output;\n\t},\n\t_getCheckboxes(){\n\t\tconst scrollview = this.queryView(\"scrollview\");\n\t\treturn scrollview ? scrollview.getBody().getChildViews() : [];\n\t}\n}, webix.ui.form);","webix.protoUI({\n\tname:\"formlist\",\n\tdefaults:{\n\t\tpaddingY: 5,\n\t\theight: 120,\n\t},\n\t$init:function(config){\n\n\t\tconfig.cols = [\n\t\t\t{\n\t\t\t\tcss:\"webix_inp_label\",\n\t\t\t\ttemplate:config.label,\n\t\t\t\twidth:config.labelWidth,\n\t\t\t\tborderless:true\n\t\t\t},\n\t\t\t{\n\t\t\t\tview:\"list\",\n\t\t\t\tdata:config.data,\n\t\t\t\tcss:config.css,\n\t\t\t\ttemplate:config.template,\n\t\t\t\tselect: true,\n\t\t\t\tscroll:false,\n\t\t\t\tborderless:true,\n\t\t\t\ton:{\n\t\t\t\t\tonSelectChange:()=>{\n\t\t\t\t\t\tthis.getParentView().callEvent(\"onChange\", []);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t},\n\tsetValue:function(value){this.getChildViews()[1].select(value);},\n\tgetValue:function(){return this.getChildViews()[1].getSelectedId();},\n\trefresh: function(){this.getChildViews()[1].refresh();},\n\tfocus:function(){}\n}, webix.ui.layout);","import {getJsDateFromExcel, getExcelDateFromJs} from \"../math/methods/helpers\";\n\nwebix.editors.excel_date = webix.extend({\n\tgetValue:function(){\n\t\tconst value = this.getInputNode().getValue();\n\t\treturn value ? getExcelDateFromJs(value) : \"\";\n\t},\n\tsetValue:function(value){\n\t\tconst noDate = (value === \"\" || isNaN(value*1));\n\t\tvalue = noDate ? new Date() : getJsDateFromExcel(value);\n\t\twebix.editors.popup.setValue.call(this, value);\n\t},\n\tpopupType:\"excel_date\"\n}, webix.editors.date);\n\nwebix.editors.$popup.excel_date = {\n\tview:\"popup\",\n\tbody:{ \n\t\tview:\"calendar\",\n\t\ticons:true,\n\t\ttimepicker:true\n\t}\n};\n","const group = {\n\tvalue: null,\n\tset: function(method, master){\n\t\tif(!this.value){\n\t\t\tthis.start();\n\t\t\tmethod.call(master);\n\t\t\tthis.end();\n\t\t}\n\t\telse\n\t\t\tmethod.call(master);\n\t},\n\tstart(){\n\t\tthis.value = webix.uid();\n\t},\n\tend(){\n\t\tthis.value = null;\n\t}\n};\n\nexport default group;","export function init(view){\n\tconst events = [\n\t\t{name:\"onSheetAdd\", type:\"insert\"},\n\t\t{name:\"onSheetRemove\", type:\"remove\"},\n\t\t{name:\"onSheetRename\", type:\"rename\"},\n\t\t{name:\"onCellChange\"},\n\t\t{name:\"onStyleChange\"},\n\t\t{name:\"onAction\"},\n\t\t{name:\"onRowOperation\"},\n\t\t{name:\"onColumnOperation\"},\n\t\t{name:\"onAfterConditionSet\"},\n\t\t{name:\"onAfterRangeSet\"},\n\t\t{name:\"onAfterSpan\"},\n\t\t{name:\"onAfterSplit\"},\n\t\t{name:\"onRowResize\", view: \"cells\"},\n\t\t{name:\"onColumnResize\", view: \"cells\"}\n\t];\n\n\tlet thread;\n\tfor (let i = 0; i < events.length; i++){\n\t\tconst handler = events[i];\n\t\t(handler.view ? view.$$(handler.view) : view).attachEvent(handler.name, function(name, newName){\n\t\t\tif (view._loading_data) return;\n\n\t\t\tlet params;\n\t\t\tif(handler.type)\n\t\t\t\tparams = handler.type == \"rename\" ? [handler.type, newName, name] : [handler.type, name];\n\t\t\telse\n\t\t\t\tparams = [\"update\", view.getActiveSheet()];\n\n\t\t\tclearTimeout(thread);\n\t\t\tthread = webix.delay(() => view.callEvent(\"onChange\", params));\n\t\t});\n\t}\n\n\tview.attachEvent(\"onChange\", function(){\n\t\tsave(view, \"all\");\n\t});\n}\n\nexport function save(view, name, data){\n\tvar save = view.config.save;\n\tvar url;\n\tif (!save) return;\n\n\tif(name == \"all\"){\n\t\tif(!save.all)\n\t\t\treturn;\n\t\tdata = { data: view.serialize({ sheets: true }) };\n\t\turl = save.all;\n\t}\n\telse{\n\t\turl = typeof save === \"string\" ? save + \"/\" + name : save[name];\n\t}\n\n\turl = webix.proxy.$parse(url);\n\n\tif(url){\n\t\tif (typeof url === \"function\")\n\t\t\treturn url(name, data);\n\n\t\tif (url.$proxy && url.save)\n\t\t\treturn url.save(view, data, null, null);\n\n\t\tvar ajax = webix.ajax();\n\t\tif (name === \"all\")\n\t\t\tajax.headers({ \"Content-type\" : \"application/json\" });\n\t\tajax.post(url, data);\n\t}\n}","export const decode = {};\nexport const encode = {};\n\nconst alpha = \"ABCDEFGHIJKLMNOPQRSTUVWXYZ\";\nfor (var i=1; i<1000; i++){\n\tvar prefixIndex = parseInt((i-1)/alpha.length);\n\tvar str = (prefixIndex?alpha[prefixIndex-1]:\"\")+alpha[(i-1)%(alpha.length)];\n\n\tdecode[str] = i;\n\tencode[i] = str;\n}\n\nencode[0]=encode[1];\n\n\nexport function adress(text){\n\tvar size = (text.charCodeAt(1) < 59) ? 1 : 2;\n\tvar col = text.substr(0, size);\n\tvar row = text.substr(size);\n\n\treturn [row*1, decode[col]];\n}\n\nexport function range(text, view){\n\tvar nind = text.indexOf(\"!\");\n\tvar sheet = \"\";\n\n\t//parse sheet names\n\tif (nind !== -1){\n\t\tsheet = text.substr(0, nind);\n\t\tif (sheet[0] === \"'\")\n\t\t\tsheet = sheet.substr(1, sheet.length-2);\n\t\ttext = text.substr(nind+1);\n\t}\n\n\tvar parts = text.split(\":\");\n\tif (parts.length != 2 && view){\n\t\ttext = view.ranges.getCode(text, sheet);\n\t\tif (!text) return null;\n\t\tparts = text.split(\":\");\n\t} \n\n\tvar d1 = adress(parts[0]);\n\tvar d2 = adress(parts[1]);\n\treturn [d1[0], d1[1], d2[0], d2[1], sheet];\n}\n\n\nvar notAlphaNum = /[^A-Za-z0-9]/;\nfunction escapeSheet(text){\n\tif (notAlphaNum.test(text))\n\t\treturn `'${text}'`;\n\treturn text;\n}\n\nexport function toRange(x,y,x2,y2,sheet){\n\treturn (sheet?(escapeSheet(sheet)+\"!\"):\"\")+encode[y]+x+\":\"+encode[y2]+x2;\n}\nexport function toSheetRange(x,y,sheet){\n\treturn (sheet?(escapeSheet(sheet)+\"!\"):\"\")+x+\":\"+y;\n}\n\nexport function rangeObj(text, view){\n\tif (typeof text === \"object\") return text;\n\tlet a = range(text, view);\n\treturn { start:{ row:a[0], column:a[1]}, end:{ row:a[2], column:a[3] }, sheet: a[4] };\n}\n\nexport function eachRange(text, view, callback, data){\n\tvar range = rangeObj(text);\n\tfor (let row = range.start.row; row <= range.end.row; row++) {\n\t\tfor (let column = range.start.column; column <=  range.end.column; column++) {\n\t\t\tcallback(view, {row: row, column: column}, data);\n\t\t}\n\t}\n}\n\nvar rangeTest = /(([A-Za-z0-9]+|'[^']+')!|)[A-Z]+[0-9]+:[A-Z]+[0-9]+/;\nexport function isRange(text){\n\treturn rangeTest.test(text);\n}\n\nexport function changeRange(text,name,inc,start){\n\tlet updated = false;\n\n\tif(isRange(text)){\n\t\tlet [r1,c1,r2,c2,sheet] = range(text);\n\n\t\t//ranges like B2:A1\n\t\tif(r1 > r2)\n\t\t\t[r1, r2] = [r2, r1];\n\t\tif(c1 > c2)\n\t\t\t[c1, c2] = [c2, c1];\n\n\t\tif (name === \"row\" && start.row <= r2){\n\t\t\tif((inc < 0 && start.row < r1) || (inc > 0 && start.row <= r1))\n\t\t\t\tr1 += inc;\n\t\t\tr2 += inc;\n\n\t\t\tif(r2<r1)\n\t\t\t\treturn \"\";\n\n\t\t\tupdated = true;\n\t\t}\n\t\telse if (name === \"column\" && start.column <= c2){\n\t\t\tif((inc < 0 && start.column < c1) || (inc > 0 && start.column <= c1))\n\t\t\t\tc1 += inc;\n\t\t\tc2 += inc;\n\n\t\t\tif(c2<c1)\n\t\t\t\treturn \"\";\n\n\t\t\tupdated = true;\n\t\t}\n\t\tif(updated)\n\t\t\ttext = toRange(r1,c1,r2,c2,sheet);\n\t}\n\n\treturn text;\n}","export const toolbarSizes = {\n\twidth:38,\n\tmargin: 7,\n\tpaddingY: 1,\n\tsectorPadding: 5,\n\tsectorMargin: 0\n};\n\n// default styles for toolbar elements\nexport const defaultStyles = {\n\t\"color\"         : \"#666666\",\n\t\"background\"    : \"#ffffff\",\n\t\"font-family\"   : \"'PT Sans', Tahoma\",\n\t\"font-size\" : \"15px\",\n\t\"text-align\": \"left\",\n\t\"vertical-align\": \"top\",\n\t\"white-space\": \"nowrap\",\n\t\"format\": \"common\"\n};\n\nexport function setSkinDefaults(){\n\tconst material = webix.skin.$name == \"material\" || webix.skin.$name == \"mini\";\n\ttoolbarSizes.width = webix.skin.$active.inputHeight+2;\n\ttoolbarSizes.titleHeight = webix.skin.$name == \"mini\" ? 18 : 20;\n\n\tdefaultStyles[\"font-family\"] = material ? \"'Roboto', sans-serif\" : \"'PT Sans', Tahoma\";\n}","import group from \"./undo_group\";\nimport {save} from \"./save\";\nimport {eachRange} from \"../helpers/column_names\";\nimport {defaultStyles} from \"../toolbar/defaults\";\n\n//do not change order, it will break server side compatibility\n//add new options to the end of this list\nexport const style_names = [\n\t\"color\",\"background\",\"text-align\",\n\t\"font-family\",\"font-size\",\n\t\"font-style\",\"text-decoration\",\"font-weight\",\n\t\"vertical-align\", \"wrap\", \"borders\", \"format\",\n\t\"border-right\", \"border-bottom\",\"border-left\", \"border-top\"\n];\n\nconst _style_map = {\n\t\"vertical-align\": {\n\t\t\"top\": function(){\n\t\t\treturn \"display: block;\";\n\t\t},\n\t\t\"middle\": function(obj){\n\t\t\tvar align = \"flex-start\";\n\t\t\tif(obj[\"text-align\"] == \"center\")\n\t\t\t\talign = \"center\";\n\t\t\telse if(obj[\"text-align\"] == \"right\")\n\t\t\t\talign = \"flex-end\";\n\t\t\tvar result = \"display: flex; align-items: center;justify-content:\"+align+\";\";\n\t\t\treturn result;\n\t\t},\n\t\t\"bottom\": function(obj){\n\t\t\tvar align = \"flex-start\";\n\t\t\tif(obj[\"text-align\"] == \"center\")\n\t\t\t\talign = \"center\";\n\t\t\telse if(obj[\"text-align\"] == \"right\")\n\t\t\t\talign = \"flex-end\";\n\t\t\tvar result = \"display: flex; align-items:flex-end;justify-content:\"+align+\";\";\n\t\t\treturn result;\n\t\t}\n\t},\n\t\"wrap\": {\n\t\t\"wrap\": function(){\n\t\t\tvar padding = 7 - (34-webix.skin.$active.rowHeight);\n\t\t\treturn \"white-space: normal !important; line-height:normal !important; padding-top:\"+padding+\"px;padding-bottom:\"+padding+\"px;\";\n\t\t},\n\t\t\"nowrap\": function(){\n\t\t\treturn \"\";\n\t\t}\n\t},\n\t\"format\":\"\",\n\t\"borders\": \"\",\n\t\"border-left\":function(obj){\n\t\tif(obj[\"border-left\"])\n\t\t\treturn \"border-left: 1px solid \"+obj[\"border-left\"]+ \" !important;\";\n\t\treturn \"\";\n\t},\n\t\"border-top\":function(obj){\n\t\tif(obj[\"border-top\"])\n\t\t\treturn \"border-top: 1px solid \"+obj[\"border-top\"]+ \" !important;\";\n\t\treturn \"\";\n\t},\n\t\"border-right\":function(obj){\n\t\tif(obj[\"border-right\"])\n\t\t\treturn \"border-right: 1px solid \"+obj[\"border-right\"]+ \" !important;\";\n\t\treturn \"\";\n\t},\n\t\"border-bottom\": function(obj){\n\t\tif(obj[\"border-bottom\"])\n\t\t\treturn \"border-bottom: 1px solid \"+obj[\"border-bottom\"]+ \" !important;\";\n\t\treturn \"\";\n\t},\n\t\"font-weight\": function(obj){\n\t\t//Roboto bold - font-weight:500 (looks better, than 700). Roboto is default font for material skins.\n\t\tif(obj[\"font-weight\"] == \"bold\"){\n\t\t\tconst family = obj[\"font-family\"] || defaultStyles[\"font-family\"];\n\t\t\treturn \"font-weight:\" + (family == \"'Roboto', sans-serif\" ? 500 : 700) + \";\";\n\t\t}\n\t\treturn \"\";\n\t}\n};\n\n\nconst border_checks = {\n\t\"border-left\":\t\tfunction(cell, area, mode){ return cell.column == area.start.column || mode ==\"no\"; },\n\t\"border-right\":\t\tfunction(cell, area, mode){ return cell.column == area.end.column || mode == \"all\" || mode ==\"no\"; },\n\t\"border-top\":\t\tfunction(cell, area , mode){ return cell.row == area.start.row || mode ==\"no\"; },\n\t\"border-bottom\":\tfunction(cell, area, mode){ return cell.row == area.end.row || mode == \"all\"|| mode ==\"no\"; }\n};\n\nconst _style_handlers = {\n\t\"borders\": function(view, style, value, cell){\n\t\tvar area = view.$$(\"cells\").getSelectArea();\n\t\tvalue = value.split(\",\");\n\t\tvar type = value[0];\n\t\tvar color = value[1];\n\n\t\tvar modes = [\"border-left\", \"border-right\", \"border-bottom\", \"border-top\"];\n\n\t\tif(type == \"no\")\n\t\t\tcolor = \"\";\n\t\telse if(type == \"top-bottom\"){\n\t\t\tmodes = [\"border-top\",\"border-bottom\"];\n\t\t}\n\t\telse if (type != \"all\" && type != \"outer\")\n\t\t\tmodes = [\"border-\"+type];\n\t\t\n\t\tfor (var i = 0; i < modes.length; i++){\n\t\t\tvar mode = modes[i];\n\t\t\tlet result = view.callEvent(\"onAction\", [\"check-borders\", {row:cell.row, column:cell.column, area, type, mode}]);\n\t\t\tif (result === true || border_checks[mode](cell, area, type))\n\t\t\t\tstyle = _updateStyle(view, style, mode, color, cell);\n\t\t}\n\t\treturn style;\n\t}\n};\n\nvar sizeEl;\nexport function init(view){\n\tview.attachEvent(\"onStyleSet\", (name, value) => _applyStyles(view, name, value));\n\tview.attachEvent(\"onDataParse\", (data) => _parse(view, data));\n\tview.attachEvent(\"onDataSerialize\", (data) => _serialize(view, data));\n\tview.attachEvent(\"onReset\", () => reset(view));\n\tview.attachEvent(\"onUndo\", (type, row, column, style) => {\n\t\tif(type == \"style\")\n\t\t\t_undoStyle(view, row, column, style);\n\t});\n\n\treset(view);\n\n\tif (!sizeEl)\n\t\tsizeEl = webix.html.create(\"DIV\", { style:\"visibility:hidden; position:absolute; top:0px; left:0px; overflow:hidden;\"}, \"\");\n}\n\nfunction reset(view){\n\tview._styles = {};\n\tview._styles_cache = {};\n\tview._styles_max = 1;\n\n\tlet prefix = \".wss_\"+view.$index;\n\twebix.html.removeStyle(prefix);\n}\n\nexport function getStyle(view, cell){\n\tvar styles = view.getRow(cell.row).$cellCss;\n\tif (styles){\n\t\tvar styleid = styles[cell.column];\n\t\tif (styleid)\n\t\t\treturn view._styles[styleid];\n\t}\n\treturn null;\n}\n\n// undo\nfunction _undoStyle(view, row, column, style){\n\tvar cell = {row: row, column: column};\n\tsetStyle(view, cell, style);\n}\n\nfunction _serialize(view, obj){\n\tvar styles = [];\n\n\tfor (var key in view._styles_cache)\n\t\tstyles.push([view._styles_cache[key].id, key]);\n\n\tobj.styles = styles;\n}\n\nexport function addStyle(view, props, origin){\n\tvar style = {\n\t\tprops:_styleFromText(\";;;;;;;;;;;;;;;\")\n\t};\n\n\tif (origin)\n\t\tfor (var key in origin.props)\n\t\t\tstyle.props[key] = origin.props[key];\n\n\tfor (let  key in props)\n\t\tstyle.props[key] = props[key];\n\t\t\n\n\tstyle.text = _styleToText(style);\n\tvar cache = view._styles_cache[style.text];\n\tif (cache)\n\t\treturn cache;\n\n\t_addStyle(view, style);\n\n\treturn style;\n}\n\nfunction _parse(view, obj){\n\tif (obj.styles)\n\t\tfor (let i=0; i < obj.styles.length; i++){\n\t\t\tvar styleObj = obj.styles[i];\n\t\t\tvar style = {\n\t\t\t\tid: styleObj[0],\n\t\t\t\ttext:styleObj[1],\n\t\t\t\tprops: _styleFromText(styleObj[1])\n\t\t\t};\n\n\t\t\t_addStyle(view, style, true);\n\t\t}\n\n\tfor (let i = 0; i < obj.data.length; i++){\n\t\tvar [row, column, , css] = obj.data[i];\n\n\t\tif (css)\n\t\t\tupdate_style_data(view, row, column, view._styles[css]);\n\t}\n}\n\nfunction _applyStyles(view, name, value){\n\t//this - spreadsheet\n\tgroup.set(function(){\n\t\tview.eachSelectedCell(function(cell){\n\t\t\t_applyCellStyles(view, cell, name, value);\n\t\t});\n\t});\n\tview.refresh();\n}\n\nfunction _applyCellStyles(view, cell, name, value){\n\tvar ostyle = getStyle(view, cell);\n\tvar nstyle = _updateStyle(view, ostyle, name, value, cell);\n\n\tif (nstyle && nstyle != ostyle)\n\t\t_setStyle(view, cell, nstyle, ostyle);\n}\n\nfunction _updateStyle(view, style, name, value, cell){\n\n\tif(_style_handlers[name]){\n\t\treturn _style_handlers[name](view, style, value, cell);\n\t}\n\n\tif (style && style.props[name] == value) return style;\n\n\tvar nstyle = { text:\"\", id:0, props: (style?webix.copy(style.props):{}) };\n\tnstyle.props[name] = value;\n\tnstyle.text = _styleToText(nstyle);\n\n\tvar cache = view._styles_cache[nstyle.text];\n\tif (cache)\n\t\treturn cache;\n\n\t_addStyle(view,nstyle);\n\n\treturn nstyle;\n}\n\nfunction update_style_data(view, row, column, style){\n\tconst item = view.getRow(row);\n\n\titem.$cellCss = item.$cellCss || {};\n\titem.$cellFormat = item.$cellFormat || {};\n\n\tif(style){\n\t\titem.$cellCss[column] = style.id;\n\t\titem.$cellFormat[column] = style.props.format || null;\n\t} else {\n\t\tdelete item.$cellCss[column];\n\t\tdelete item.$cellFormat[column];\n\t}\n}\n\nexport function setStyle(view, cell, style){\n\tvar old = getStyle(view, cell);\n\treturn _setStyle(view, cell, style, old);\n}\n\nexport function setRangeStyle(view, range, style) {\n\teachRange(range, view, _setStyle, style);\n}\n\nexport function getTextSize(view, text, css, x, y){\n\tlet width = 0;\n\tlet height = 0;\n\n\tsizeEl.innerHTML = text;\n\tsizeEl.style.width = (x||1)+\"px\";\n\tsizeEl.style.height = (y||1)+\"px\";\n\tsizeEl.className = \"webix_table_cell webix_cell \"+css;\n\tview._table.$view.appendChild(sizeEl);\n\n\twidth = Math.max(width, sizeEl.scrollWidth);\n\theight = Math.max(height, sizeEl.scrollHeight);\n\n\tview._table.$view.removeChild(sizeEl);\n\tsizeEl.innerHTML = \"\";\n\n\treturn { width: width, height: height };\n}\n\nfunction _setStyle(view, cell, style, old){\n\tgroup.set(()=>{\n\t\tif(view.callEvent(\"onBeforeStyleChange\", [cell.row, cell.column, style, old])){\n\t\t\tconst format = style && style.props.format || null;\n\t\t\tconst oldFormat = old && old.props.format || null;\n\t\t\tif(format != oldFormat)\n\t\t\t\tview.callEvent(\"onFormatChange\", [cell.row, cell.column, format, oldFormat]);\n\n\t\t\tupdate_style_data(view, cell.row, cell.column, style);\n\t\t\tview.callEvent(\"onStyleChange\", [cell.row, cell.column, style, old]);\n\t\t\tview.saveCell(cell.row,cell.column);\n\t\t}\n\t});\n}\n\nfunction _buildCssString(style) {\n\tlet css = \"\";\n\n\tfor (var key in style){\n\t\tif (style[key]){\n\t\t\tif( _style_map[key]){\n\t\t\t\tif(_style_map[key][style[key]])\n\t\t\t\t\tcss += _style_map[key][style[key]](style);\n\t\t\t\telse if(typeof  _style_map[key] == \"function\")\n\t\t\t\t\tcss += _style_map[key](style);\n\t\t\t}\n\t\t\telse\n\t\t\t\tcss+= key+\":\"+style[key]+\";\";\n\t\t}\n\t}\n\n\treturn css;\n}\n\nfunction _addStyle(view, style, silent){\n\tview._styles_cache[style.text] = style;\n\n\twhile (!style.id || view._styles[style.id])\n\t\tstyle.id = \"wss\"+(view._styles_max++);\n\tview._styles[style.id] = style;\n\n\tconst css = _buildCssString(style.props);\n\tlet prefix = \".wss_\"+view.$index;\n\twebix.html.addStyle(prefix+\" .\"+style.id+\"{\"+css+\"}\", prefix);\n\n\tif (!silent)\n\t\tsave(view, \"styles\", { name:style.id, text: style.text } );\n}\n\nfunction _styleToText(style){\n\tvar id = [];\n\tfor (var i=0; i<style_names.length; i++)\n\t\tid.push(style.props[style_names[i]]);\n\treturn id.join(\";\");\n}\n\nfunction _styleFromText(text){\n\tvar parts = text.split(\";\");\n\tvar props = {};\n\tfor (var i=0; i<style_names.length; i++)\n\t\tprops[style_names[i]] = parts[i];\n\treturn props;\n}\n\n\n\nexport function clearRangeStyle(view, range){\n\tgroup.set(function(){\n\t\teachRange(range, view, function(view, cell){\n\t\t\tlet style = getStyle(view,cell);\n\t\t\tif (style)\n\t\t\t\tsetStyle(view, cell, null);\n\t\t});\n\t});\n}\n\nexport function compactStyles(view){\n\tlet params  = view.serialize();\n\n\tlet data = params.data;\n\tlet styles = params.styles;\n\n\tlet used = {};\n\tfor (let i=0; i<data.length; i++){\n\t\tlet name = data[i][3];\n\t\tif (name)\n\t\t\tused[name] = 1;\n\t}\n\n\tlet newStyles = [];\n\tfor(let i = 0; i<styles.length; i++){\n\t\tlet name = styles[i][0];\n\t\tif (used[name])\n\t\t\tnewStyles.push(styles[i]);\n\t}\n\n\tparams.styles = newStyles;\n\treset(view);\n\t_parse(view, params);\n}","import {addStyle} from \"./styles\";\nimport {getJsDateFromExcel} from \"../math/methods/helpers\";\nimport group from \"./undo_group\";\n\nexport function init(view){\n\tview.attachEvent(\"onDataParse\", (data) => load(view, data));\n\tview.attachEvent(\"onDataSerialize\", (data, config) => serialize(view, data, config));\n}\n\nexport let formatHelpers = {};\n\nlet formats;\nlet formatsCount;\nlet formatSources;\nlet formatCache;\n\nexport function setDefaultFormats(){\n\tconst formatsLocale = webix.i18n.spreadsheet.formats;\n\tformats = {};\n\tformatsCount = 0;\n\tformatSources = {};\n\tformatCache = {};\n\tformatHelpers = {\n\t\tprice : {\n\t\t\tgetFormat : function(value, extra){\n\t\t\t\textra.css = \"webix_ssheet_format_price\";\n\t\t\t\treturn webix.i18n.priceFormat(value);\n\t\t\t},\n\t\t\tvalues:webix.extend({\n\t\t\t\tzeros: webix.i18n.priceSettings.decimalSize, \n\t\t\t\tsymbol: webix.i18n.priceFormat(\"\"),\n\t\t\t\tseparator: 1, negative:1, type: \"price\"\n\t\t\t}, getDelimiters(\"price\"))\n\t\t},\n\t\t\"int\" : {\n\t\t\tgetFormat : function(value, extra){\n\t\t\t\textra.css = \"webix_ssheet_format_int\";\n\t\t\t\treturn webix.i18n.numberFormat(value);\n\t\t\t},\n\t\t\tvalues:webix.extend({\n\t\t\t\tzeros: webix.i18n.decimalSize,\n\t\t\t\tseparator: 1, negative:1, type: \"int\",\n\t\t\t}, getDelimiters(\"int\"))\n\t\t},\n\t\tpercent : {\n\t\t\tgetFormat : function(value, extra){\n\t\t\t\textra.css = \"webix_ssheet_format_percent\";\n\t\t\t\treturn Math.round(value*100)+\"%\";\n\t\t\t},\n\t\t\tvalues:webix.extend({\n\t\t\t\tzeros: 0, separator: 0, negative:1, type: \"percent\",\n\t\t\t}, getDelimiters(\"percent\"))\n\t\t},\n\t\tdate : {\n\t\t\tgetFormat : function(value, extra){\n\t\t\t\textra.css = \"webix_ssheet_format_date\";\n\t\t\t\treturn format2code(formatsLocale.dateFormat, getDelimiters(\"date\"))(value);\n\t\t\t},\n\t\t\tvalues: { type:\"date\", date:formatsLocale.dateFormat }\n\t\t},\n\t\tstring : {\n\t\t\tgetFormat : function(value, extra){\n\t\t\t\textra.css = \"webix_ssheet_format_text\";\n\t\t\t\treturn value;\n\t\t\t},\n\t\t\tvalues: { type:\"string\" }\n\t\t}\n\t};\n\n\tfor(let i in formatHelpers){\n\t\tformatSources[i] = serializeFormat(formToValues(i, formatHelpers[i].values));\n\t\tformatCache[formatSources[i]] = i;\n\t}\n}\n\nexport function getDelimiters(type){\n\tif(type == \"price\")\n\t\treturn { groupSign:webix.i18n.priceSettings.groupDelimiter, decimalSign:webix.i18n.priceSettings.decimalDelimiter };\n\telse \n\t\treturn { groupSign:webix.i18n.groupDelimiter, decimalSign:webix.i18n.decimalDelimiter };\n}\n\nfunction serialize(view, data){\n\tconst formats = [];\n\tconst defaultFormats = [\"percent\", \"int\", \"price\", \"date\", \"string\"];\n\n\tfor(let i in formatSources){\n\t\tif(defaultFormats.indexOf(i) == -1) //exclude default formats\n\t\t\tformats.push([i,formatSources[i]]);\n\t}\n\tdata.formats = formats;\n}\n\nfunction load(view,data){\n\tvar i,\n\t\tformats = data.formats;\n\n\tif(formats)\n\t\tfor(i = 0; i < formats.length; i++)\n\t\t\tcreateFormatName(formats[i][1],formats[i][0]);\n}\n\nexport function getFormat(name){\n\treturn formatHelpers[name] ? formatHelpers[name].getFormat : formatHelpers[name];\n}\n\nexport function getFormatSource(name, toexcel){\n\tif(toexcel){\n\t\tlet parsed = parseFormat({values: formatHelpers[name].values, format: formatSources[name]});\n\t\treturn serializeFormat(parsed, true);\n\t}\n\telse\n\t\treturn formatSources[name];\n}\n\nfunction createFormatName(str, values){\n\tif (formatCache[str]) return formatCache[str];\n\n\tlet name = typeof(values) == \"object\" ? \"fmt\"+(formatsCount) : values;\n\tformatsCount++;\n\n\tformats[name] = str;\n\n\tvalues = webix.extend(\n\t\ttypeof(values) == \"object\" ? values : { format:str, type:\"custom\" }, \n\t\tgetDelimiters(\"custom\")\n\t);\n\n\tformatHelpers[name] = {\n\t\tgetFormat:format2code(str, {decimalSign: values.decimalSign, groupSign: values.groupSign}),\n\t\tvalues: values\n\t};\n\n\tformatSources[name] = str;\n\tformatCache[str] = name;\n\n\treturn name;\n}\n\nexport function addFormat(view, row, column, format, type){\n\tif(!type)\n\t\ttype = {format:format, type: \"custom\"};\n\tvar old = view.getStyle(row, column);\n\tvar fmtstring = createFormatName(format, type);\n\tvar nev = addStyle(view, { format: fmtstring }, old);\n\tview.setStyle(row, column, nev);\n}\n\n\nfunction splitFormat(str){\n\tvar conditional = str.match(/.*\\[[><=].*/g);\n\tvar parts = str.split(\";\");\n\tif (!conditional){\n\t\tif (parts.length > 1){\n\t\t\tparts[0] = (parts.length > 2 ? \"[>0]\" : \"[>=0]\")+parts[0];\n\t\t\tparts[1] = \"[<0]\"+parts[1];\n\t\t\tif (parts[2])\n\t\t\t\tparts[2] = \"[=0]\"+parts[2];\n\t\t}\n\t}\n\treturn parts;\n}\n\nexport function format2code(str, delimiters){\n\tconst errorMessage = webix.i18n.spreadsheet.table[\"format-error\"];\n\tlet parts = splitFormat(str);\n\tlet code = [\"var spaces = \\\"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\\\";\"];\n\tfor (var i=0; i<parts.length; i++){\n\t\tvar separated = separateFmt(parts[i]);\n\t\tcode.push(genCode(separated.condition, separated.color.toLowerCase(), separated.fmt, i, parts.length > 0, delimiters));\n\t}\n\n\treturn new Function(\"val\",\"extra\", `try{ ${code.join(\"\\n\")} return val; } catch(err) { return \"${errorMessage}\"; }`);\n}\n\nfunction genCode(check, color, line, ind, isAbs, delimiters){\n\tvar str = \"\";\n\tif (check){\n\t\tif (!ind) str+=\"if\"; else str+=\"else if\";\n\t\tif (check[0] === \"=\") check = \"=\"+check;\n\t\tstr+=\"(val\"+check+\"){\";\n\t\tif (isAbs) str+=\"val = Math.abs(val);\";\n\t}\n\tif (color)\n\t\tstr+=\"extra.css = \\\"webix_ssheet_format_\"+color+\"\\\";\";\n\n\tstr += genFormatCode(line, delimiters);\n\n\treturn str+(check?\"}\":\"\");\n}\n\nconst dateTypes = {\n\t\"yy\": \"%y\",\n\t\"yyyy\": \"%Y\",\n\t\"m\": \"%n\",\n\t\"mm\": \"%m\",\n\t\"mmm\": \"%M\",\n\t\"mmmm\": \"%F\",\n\t\"mmmmm\":\"%F\", //not supported by webix\n\t\"d\": \"%j\",\n\t\"dd\": \"%d\",\n\t\"ddd\": \"%D\",\n\t\"dddd\": \"%l\"\n};\n\nconst timeTypes = {\n\t\"h\": \"%G\",\n\t\"hh\": \"%H\",\n\t\"m\": \"%i\", //not supported by webix\n\t\"mm\": \"%i\",\n\t\"s\": \"%s\", //not supported by webix\n\t\"ss\": \"%s\",\n\t\"AM/PM\": \"%A\"\n};\n\nconst dateOrder = Object.keys(dateTypes).sort((a, b) => b.length - a.length);\nconst timeOrder = Object.keys(timeTypes).sort((a, b) => b.length - a.length);\n\nfunction excelDateToWebix(text, lastDateType){\n\tconst typesOrder = [\n\t\t{name:\"date\", order:dateOrder, types:dateTypes}, \n\t\t{name:\"time\", order:timeOrder, types:timeTypes}\n\t];\n\n\t// \"m\"/\"mm\" format can be either date (%n/%m) or time (%i), so check last date type\n\tconst basedOnLast = /^m{1,2}(?!m)/.test(text);\n\tif(basedOnLast && lastDateType != \"date\")\n\t\ttypesOrder.reverse();\n\n\tfor(let i = 0; i < typesOrder.length; i++){\n\t\tconst type = typesOrder[i];\n\t\tfor(let j = 0; j < type.order.length; j++)\n\t\t\tif(text.indexOf(type.order[j]) == 0)\n\t\t\t\treturn {\n\t\t\t\t\tformat: type.types[type.order[j]],\n\t\t\t\t\tlength: type.order[j].length,\n\t\t\t\t\ttype: type.name\n\t\t\t\t};\n\t}\n}\n\nfunction genFormatCode(line, delimiters){\n\tif (!line)\n\t\treturn \"return val;\";\n\n\tlet str = \"return \\\"\\\"\";\n\n\tlet isQuote;\n\tlet fmt = \"\";\n\tlet multiply = 1;\n\tlet comma, numberPlaceholder, textPlaceholder;\n\tlet date = [];\n\tlet lastDateType = \"date\";\n\n\tfor (var i=0; i<line.length; i++){\n\t\tvar betweenPlaceholders = placeholder(line[i-1])&&placeholder(line[i+1]);\n\t\tif (line[i] == \"\\\"\"){\n\t\t\tif(webix.isUndefined(isQuote))\n\t\t\t\tisQuote = i;\n\t\t\telse {\n\t\t\t\tstr += `+\"${line.substr(isQuote+1, i-isQuote-1)}\"`;\n\t\t\t\tisQuote = undefined;\n\t\t\t}\n\t\t\tcontinue;\n\t\t}\n\t\tif (!webix.isUndefined(isQuote))\n\t\t\tcontinue;\n\t\tif(line[i] == \"%\")\n\t\t\tmultiply = multiply*100;\n\n\t\tif(/[a-zA-Z]/.test(line[i])){\n\t\t\tconst datePart = excelDateToWebix(line.substr(i), lastDateType);\n\t\t\tif(datePart){\n\t\t\t\tif(numberPlaceholder || textPlaceholder)\n\t\t\t\t\treturn \"throw \\\"unexpected number placeholder\\\";\";\n\t\t\t\tdate.push(datePart.format);\n\t\t\t\tstr += \"/*date*/\"; //update this value after date format is ready\n\t\t\t\tlastDateType = datePart.type;\n\t\t\t\ti += datePart.length-1;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\telse\n\t\t\t\tstr += `+\"${line[i]}\"`;\n\t\t}\n\t\telse if (line[i] === delimiters.decimalSign && betweenPlaceholders){\n\t\t\tfmt+= delimiters.decimalSign;\n\t\t}\n\t\telse if(line[i]==\"@\"){\n\t\t\tif(numberPlaceholder || date.length)\n\t\t\t\treturn \"throw \\\"unexpected number placeholder\\\";\";\n\t\t\tif(!textPlaceholder){\n\t\t\t\tstr+=\"+fmt\";\n\t\t\t\ttextPlaceholder = true;\n\t\t\t}\n\t\t\tfmt+=line[i];\t\t\n\t\t}\n\t\telse if (placeholder(line[i])){\n\t\t\tif(textPlaceholder || date.length)\n\t\t\t\treturn \"throw \\\"unexpected text placeholder\\\";\";\n\t\t\tif (!numberPlaceholder) {\n\t\t\t\tstr+=\"+fmt\";\n\t\t\t\tnumberPlaceholder=true;\n\t\t\t}\n\t\t\tfmt+=line[i];\n\t\t}\n\t\telse if (line[i] === delimiters.groupSign && betweenPlaceholders)\n\t\t\tcomma = true;\n\t\telse\n\t\t\tstr += `+\"${line[i]}\"`;\n\t}\n\n\tif(date.length){\n\t\t// 12-hour or 24-hour clock depends on AM/PM in format\n\t\tif(date.indexOf(\"%A\") != -1)\n\t\t\tdate = date.map(datePart => {\n\t\t\t\tswitch(datePart){\n\t\t\t\t\tcase \"%G\": return \"%g\";\n\t\t\t\t\tcase \"%H\": return \"%h\";\n\t\t\t\t\tdefault: return datePart;\n\t\t\t\t}\n\t\t\t});\n\n\t\tfor(let i = 0; i < date.length; i++)\n\t\t\tstr = str.replace(\"/*date*/\", `+dateParts[${i}]`);\n\t}\n\n\treturn `\n\t\t${date.length ? `val = (${getJsDateFromExcel})(val); var dateParts = webix.Date.dateToStr(\"${date.join(\";\")}\")(val).split(\";\");` : \"\"}\n\t\t${fmt ? `${numberFormat(fmt, comma, delimiters, multiply)};` : \"\"}\n\t\t${str};`;\n}\n\nfunction numberFormat(fmt, comma, delimiters, multiply){\n\tvar str = `if(/^@+$/.test(\"${fmt}\") || isNaN(val)){ var fmt = val; }else {`;\n\tvar decimal = delimiters.decimalSign;\n\tvar [left, right] = getParts(fmt, decimal);\n\tright = (right || \"\").split(\"\").reverse().join(\"\");\n\n\t//calculate indexes in mask\n\tvar lzeros = left.indexOf(\"0\"); if (lzeros>=0) lzeros = left.length - lzeros;\n\tvar lfills = left.indexOf(\"?\"); if (lfills>=0) lfills = left.length - lfills;\n\tvar rzeros = right.indexOf(\"0\"); if (rzeros>=0) rzeros = right.length - rzeros;\n\tvar rfills = right.indexOf(\"?\"); if (rfills>=0) rfills = right.length - rfills;\n\tvar rmax = right.length;\n\n\tstr += `\n\tval = val*${multiply};\n\tvar parts = val.toFixed(${rmax}).split(\".\");\n\tvar left = parts[0];\n\tvar lsize = left.length; \n\tvar right = parts[1] || \"\";\n\tif (left.length < ${lzeros}) left = \"0000000000\".substr(0, ${lzeros} - left.length)+left;\n\tif (left.length < ${lfills}) left = spaces.substr(0, 6*(${lfills} - left.length))+left;\n\tif (${comma}) {\n\t\tvar buf = [];\n\t\tvar start = 3;\n\t\twhile (lsize > start) { buf.push(left.substr(left.length-start,3)); start+=3; }\n\t\tvar last = left.substr(0,left.length-start+3);\n\t\tif (last !== \"-\")\n\t\t\tbuf.push(last);\n\t\telse\n\t\t\tbuf.push(\"-\"+buf.pop());\n\n\t\tleft = buf.reverse().join(\"${delimiters.groupSign}\");\n\t}\n\tif (right){\n\t\tvar zpoint = right.length-1;\n\t\twhile (zpoint >= ${rzeros}){\n\t\t\tif (right[zpoint] !== \"0\"){\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tzpoint--;\n\t\t}\n\n\t\tif (zpoint <= right.length)\n\t\t\tright = right.substr(0, zpoint+1);\n\n\t\tif (right.length < ${rfills}){\n\t\t\tright += spaces.substr(0, 6*(${rfills} - right.length));\n\t\t}\n\t}\n\tvar fmt = left+(right?\"${decimal}\":\"\")+right;\n\t`;\n\n\treturn str+\"}\\n\";\n}\n\nfunction updateDecimals(fmt, inc, val){\n\tlet parsed = parseFormat(fmt);\n\tfor(let i = 0; i < parsed.length; i++){\n\t\tif(parsed[i].decimals){\n\t\t\tif(inc>0)\n\t\t\t\tparsed[i].right.placeholders += Array(inc+1).join(\"0\");\n\t\t\telse\n\t\t\t\tparsed[i].right.placeholders = parsed[i].right.placeholders.slice(0, inc);\n\t\t}\n\t\telse{\n\t\t\tconst withoutText = !parsed[i].left.text && !parsed[i].right.text;\n\t\t\tconst withoutPlaceholders = !parsed[i].left.placeholders && !parsed[i].right.placeholders;\n\t\t\t//check if cell value have decimals (not cell format)\n\t\t\tif(inc < 0 && withoutText && withoutPlaceholders && webix.rules.isNumber(val) && val.indexOf(\".\") > -1){\n\t\t\t\tparsed[i].left.placeholders = \"0\";\n\t\t\t\tparsed[i].right.placeholders = Array(val.split(\".\")[1].length).join(Array(inc+1).join(\"0\"));\n\t\t\t}\n\t\t\t//ignore text\n\t\t\telse if(inc > 0 && (parsed[i].left.placeholders || withoutText)){\n\t\t\t\tparsed[i].left.placeholders = parsed[i].left.placeholders || \"0\";\n\t\t\t\tparsed[i].right.placeholders = Array(inc+1).join(\"0\");\n\t\t\t\tparsed[i].decimals = true;\n\t\t\t}\n\t\t}\n\t\tparsed[i].decimals = parsed[i].right.placeholders.length > 0;\n\t}\n\n\treturn serializeFormat(parsed);\n}\n\nexport function changeAreaDecimals(view, inc, row, column){\n\tlet cells = getCells(view, row, column);\n\tif(cells.length == 0)\n\t\treturn;\n\n\tconst item = view.$$(\"cells\").getItem(cells[0].row)[cells[0].column];\n\tconst firstValue = item ? item.toString() : item;\n\tconst firstStyle = view.getStyle(cells[0].row, cells[0].column);\n\n\tif(webix.rules.isNumber(firstValue) || (firstStyle && firstStyle.props.format)){\n\t\tgroup.set(function(){\n\t\t\tfor(let i = 0; i < cells.length; i++)\n\t\t\t\tchangeCellDecimals(view, inc, cells[i]);\n\t\t});\n\t\tview.refresh();\n\n\t\tconst name = view.getStyle(cells[0].row, cells[0].column).props.format;\n\t\tview.$$(\"bar\").setValues({format:name.indexOf(\"fmt\") < 0 ? name : \"custom\"}, true);\n\t}\n}\n\nexport function changeCellDecimals(view, inc, cell){\n\tlet format;\n\tconst style = view.getStyle(cell.row, cell.column);\n\tlet value = view.$$(\"cells\").getItem(cell.row)[cell.column];\n\tvalue = value ? value.toString() : \"\";\n\n\tif(style && style.props.format){\n\t\tconst name = style.props.format;\n\t\tformat = webix.copy({values:formatHelpers[name].values, format:getFormatSource(name)});\n\t\tformat.format = updateDecimals(format, inc, value);\n\n\t\tif(format.values && format.values.hasOwnProperty(\"zeros\"))\n\t\t\tformat.values.zeros = Math.max(format.values.zeros+inc, 0);\n\t}\n\t//add format for cell without format\n\telse{\n\t\tconst zeros = webix.rules.isNumber(value) && value.split(\".\")[1] ? Math.max(value.split(\".\")[1].length+inc, 0) : Math.max(inc, 0);\n\n\t\tformat = {values:{negative:1, zeros:zeros, separator:0, type:\"int\"}};\n\t\tformat.format = serializeFormat(formToValues(format.values.type, format.values));\n\t}\n\taddFormat(view, cell.row, cell.column, format.format, format.values);\n}\n\nexport function isCustom(name){\n\treturn name != \"common\" && (name.indexOf(\"fmt\") != -1 || formatHelpers[name].values.type == \"custom\");\n}\n\nexport function formToValues(type, formValues){\n\tif(type == \"string\")\n\t\treturn [{left:{text:\"@\"}}];\n\tif(formValues.date)\n\t\treturn [{left:{text:formValues.date}}];\n\n\tlet values = [{condition:\">=0\", left:{text:\"\"},right:{text:\"\"}}, {condition:\"<0\", left:{text:\"\"}, right:{text:\"\"}}];\n\twebix.extend(values, getDelimiters(type));\n\tvalues[0].right.placeholders = values[1].right.placeholders = formValues.zeros ? Array(formValues.zeros + 1).join(\"0\") : \"\";\n\tvalues[0].separator = values[1].separator = formValues.separator && type != \"percent\";\n\tvalues[0].left.placeholders = values[1].left.placeholders = values[0].separator ? \"#\"+values.groupSign +\"0\" : \"0\";\n\tvalues[0].decimals = values[1].decimals = formValues.zeros ? true : false;\n\tvalues[1].color = formValues.negative != 1 ? \"red\" : \"\";\n\tvalues[1].left.text += formValues.negative < 3 ? \"-\" : \"\";\n\n\tif(type === \"percent\")\n\t\tvalues[0].right.text = values[1].right.text  = \"%\";\n\telse if(type === \"price\"){\n\t\tconst symbol = formatHelpers.price.values.symbol;\n\t\tconst right = symbol.indexOf(\" \") == 0;\n\n\t\tvalues[1][right?\"right\":\"left\"].text += symbol;\n\t\tvalues[0][right?\"right\":\"left\"].text += symbol;\n\t}\n\n\treturn values;\n}\n\nexport function serializeFormat(values, toExcel){\n\tlet fmt = \"\";\n\tfor(let i = 0; i < values.length; i++){\n\t\tif(values[i].condition)\n\t\t\tfmt += \"[\"+values[i].condition+\"]\";\n\t\tif(values[i].color)\n\t\t\tfmt += \"[\"+values[i].color+\"]\";\n\n\t\tif(values[i].left){\n\t\t\tif(values[i].left.text){\n\t\t\t\tlet leftText = values[i].left.text;\n\t\t\t\tfmt += leftText;\n\t\t\t}\n\t\t\tif(values[i].left.placeholders){\n\t\t\t\tlet leftPlaceholders = values[i].left.placeholders;\n\t\t\t\tfmt += toExcel ? leftPlaceholders.replace(values.groupSign, \",\") : leftPlaceholders;\n\t\t\t}\n\t\t}\n\n\t\tif(values[i].decimals)\n\t\t\tfmt += toExcel ? \".\" : values.decimalSign;\n\n\t\tif(values[i].right){\n\t\t\tif(values[i].right.placeholders)\n\t\t\t\tfmt += values[i].right.placeholders;\n\t\t\tif(values[i].right.text){\n\t\t\t\tlet rightText = values[i].right.text;\n\n\t\t\t\tfmt += rightText;\n\t\t\t}\n\t\t}\n\t\tif(i != values.length - 1)\n\t\t\tfmt += \";\";\n\t}\n\treturn fmt;\n}\n\nfunction parseFormat(fmt){\n\tconst fmtParts = fmt.format.split(\";\");\n\tlet values = [];\n\n\tfor(let i = 0; i < fmtParts.length; i++){\n\t\tlet separated = separateFmt(fmtParts[i]);\n\t\tvalues[i] = {color:separated.color, condition:separated.condition, left:{}, right:{}};\n\n\t\tconst format = separated.fmt;\n\n\t\tvalues.groupSign = fmt.values.groupSign;\n\t\tvalues.decimalSign = fmt.values.decimalSign;\n\n\t\tif(format.indexOf(values.groupSign) > -1)\n\t\t\tvalues[i].separator = true;\n\n\t\tconst sepFmtParts = getParts(format, values.decimalSign);\n\n\t\tlet left = sepFmtParts[0];\n\t\tlet right = sepFmtParts[1] || \"\";\n\n\t\tif(sepFmtParts[1])\n\t\t\tvalues[i].decimals = true;\n\n\t\tleft = getFmtPartValues(left, \"left\", values.groupSign);\n\t\tright = getFmtPartValues(right, \"right\", values.groupSign);\n\n\t\tvalues[i].left = {\n\t\t\ttext: left.leftText,\n\t\t\tplaceholders: left.placeholders\n\t\t};\n\n\t\tvalues[i].right = {\n\t\t\ttext: left.rightText + right.rightText,\n\t\t\tplaceholders: right.placeholders\n\t\t};\n\t}\n\treturn values;\n}\n\nfunction getFmtPartValues(fmtPart, type, groupSign){\n\tlet firstPlaceholder;\n\tif(type == \"left\"){\n\t\tfirstPlaceholder = fmtPart.match(/[#?0]/);\n\t\tfirstPlaceholder = firstPlaceholder ? firstPlaceholder.index : Infinity;\n\t}\n\n\tlet leftText = \"\";\n\tlet rightText = \"\";\n\tlet placeholders = \"\";\n\tfor(let k = 0; k < fmtPart.length; k++){\n\t\tif(!placeholder(fmtPart[k])){\n\t\t\tif(fmtPart[k] == groupSign && placeholder(fmtPart[k+1]) && placeholder(fmtPart[k-1])){\n\t\t\t\tplaceholders += fmtPart[k];\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif(type == \"left\")\n\t\t\t\tif(k < firstPlaceholder){\n\t\t\t\t\tleftText += fmtPart[k];\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\trightText += fmtPart[k];\n\t\t}\n\t\telse\n\t\t\tplaceholders += fmtPart[k];\n\t}\n\treturn {leftText: leftText, rightText: rightText, placeholders: placeholders};\n}\n\nfunction separateFmt(line){\n\tlet color = \"\";\n\tlet check = \"\";\n\tlet start = line.indexOf(\"[\");\n\tif (start !== -1){\n\t\tif (line[1].match(/[><=]/)){\n\t\t\tlet end = line.indexOf(\"]\");\n\t\t\tcheck = line.substr(start+1, end-start-1);\n\t\t\tline = line.substr(end+1);\n\t\t}\n\t}\n\n\tstart = line.indexOf(\"[\");\n\tif (start !== -1){\n\t\tlet end = line.indexOf(\"]\");\n\t\tcolor = line.substr(start+1, end-start-1);\n\t\tline = line.substr(end+1);\n\t}\n\treturn {condition:check, color:color, fmt:line};\n}\n\nfunction getCells(view, row, column){\n\tif(row && column){\n\t\tif (typeof row === \"object\" && typeof column === \"object\"){\n\t\t\tlet cells = [];\n\t\t\tfor (let r = row.row; r<=column.row; r++)\n\t\t\t\tfor (let c = row.column; c<=column.column; c++)\n\t\t\t\t\tcells.push({row: r, column: c});\n\t\t\treturn cells;\n\t\t}\n\t\telse\n\t\t\treturn [{row: row, column: column}];\n\t}\n\telse\n\t\treturn view.getSelectedId(true);\n}\n\nfunction placeholder(val){\n\treturn val === \"0\" || val === \"#\" || val === \"?\";\n}\n\nfunction getParts(str, decimal){\n\t// it is nessesary to use \"/\" before decimal to escape regex special characters\n\tconst match = str.match(\"[#?0][/\"+decimal+\"][#?0]\");\n\tif(match)\n\t\treturn [str.substring(0, match.index+1), str.substring(match.index+2)];\n\telse\n\t\treturn [str];\n}\n\n//simple check: take into account only first condition\nexport function checkFormat(format, type){\n\tformat = format && format.fmt ? format.fmt : getFormatSource(format);\n\tif(!format) return;\n\tconst parts = splitFormat(format);\n\tconst separated = separateFmt(parts[0]).fmt;\n\n\tlet quot;\n\tif(separated)\n\t\tfor(let i = 0; i < separated.length; i++){\n\t\t\tif(separated[i] == \"\\\"\")\n\t\t\t\tquot = !quot;\n\t\t\tif(quot) continue;\n\n\t\t\tif(type == \"date\" && /[a-zA-Z]/.test(separated)){\n\t\t\t\tconst datePart = excelDateToWebix(separated.substr(i));\n\t\t\t\tif(datePart)\n\t\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif(type == \"string\" && separated[i] == \"@\")\n\t\t\t\treturn true;\n\t\t}\n}\n\nexport function getFormatName(view, row, col){\n\tconst item = view.getRow(row);\n\treturn item.$cellFormat && item.$cellFormat[col];\n}\n\nexport function isDateInvalid(value){\n\treturn value < -99974430.925 || value > 100025569.125;\n}","import {changeAreaDecimals} from \"../operations/formats\";\n\nexport const actions = {\n\tspan: function(view){\n\t\tvar range = view.$$(\"cells\").getSelectArea();\n\t\tif(range){\n\t\t\tif(isMerged(view,range)){\n\t\t\t\tview.splitCell();\n\t\t\t}\n\t\t\telse{\n\t\t\t\tlet values = [];\n\t\t\t\tfor(let r = range.start.row; r<=range.end.row; r++){\n\t\t\t\t\tfor(let c = range.start.column; c<=range.end.column; c++){\n\t\t\t\t\t\tlet value = view.getCellValue(r,c);\n\t\t\t\t\t\tif(value) values.push(value);\n\t\t\t\t\t\tif(values.length >1) break;\n\t\t\t\t\t}\n\t\t\t\t\tif(values.length >1) break;\n\t\t\t\t}\n\t\t\t\tif(values.length>1){\n\t\t\t\t\tview.confirm({\n\t\t\t\t\t\ttext:webix.i18n.spreadsheet.labels[\"merge-cell-confirm\"]\n\t\t\t\t\t}).then(()=> view.combineCells() );\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t\tview.combineCells();\n\t\t\t}\n\t\t}\n\t},\n\tundo: function(view){\n\t\tview.undo();\n\t},\n\tredo: function(view){\n\t\tview.redo();\n\t},\n\t\"hide-gridlines\": function(view){\n\t\tview.hideGridlines(\"toggle\");\n\t},\n\t\"hide-headers\": function(view){\n\t\tview.hideHeaders(\"toggle\");\n\t},\n\t\"freeze-columns\": function(view){\n\t\tvar table = view.$$(\"cells\");\n\t\tvar select = table.getSelectedId();\n\t\tview.freezeColumns(select && select.column!=\"rowId\"?select.column : 0);\n\t},\n\t\"freeze-rows\":function(view){\n\t\tvar table = view.$$(\"cells\");\n\t\tvar select = table.getSelectedId();\n\t\tview.freezeRows(select ? select.row : 0);\n\t},\n\t\"increase-decimals\": function(view){\n\t\tchangeAreaDecimals(view, 1);\n\t},\n\t\"decrease-decimals\": function(view){\n\t\tchangeAreaDecimals(view, -1);\n\t},\n};\n\nfunction isMerged(view,range){\n\tvar i, j,\n\t\tc0 = range.start,\n\t\tc1 = range.end;\n\n\tfor( i = c0.row*1; i <= c1.row*1; i++ ){\n\t\tfor( j = c0.column*1; j <= c1.column*1; j++ ){\n\t\t\tif(view.$$(\"cells\").getSpan(i, j))\n\t\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n}\n","import {toolbarSizes, defaultStyles} from \"./defaults\";\nimport {formatHelpers} from \"../operations/formats\";\n\n// options for 'font-family' select\nexport const fontFamily = [\n\t{id: \"Arial\", value: \"Arial\"},\n\t{id: \"'Roboto', sans-serif\", value: \"Roboto\"},\n\t{id: \"'PT Sans', Tahoma\", value: \"PT Sans\"},\n\t{id: \"Tahoma\", value: \"Tahoma\"},\n\t{id: \"Verdana\", value: \"Verdana\"},\n\t{id: \"Calibri, Tahoma\", value:\"Calibri\"}\n];\n\n// options for 'format' select\nfunction getCellFormats(){\n\tconst locale = webix.i18n.spreadsheet.labels;\n\treturn [\n\t\t{id: \"common\", value: locale.common },\n\t\t{id: \"price\", value: locale.currency, example: \"98.20\"},\n\t\t{id: \"int\", value: locale.number, example: \"2120.02\"},\n\t\t{id: \"percent\", value: locale.percent, example:\"0.5\"},\n\t\t{id: \"date\", value: locale.date, example:\"45000\"},\n\t\t{id: \"string\", value: locale.string, example:\"012345\"},\n\t\t{id: \"custom\", value: locale[\"custom-format\"]},\n\t];\n}\n\nexport function getColumnOperation(view){\n\tconst locale = webix.i18n.spreadsheet.menus;\n\tlet colOperations = [\n\t\t{ id:\"add\",    group:\"column\", value:locale[\"insert-column\"]},\n\t\t{ id:\"del\",    group:\"column\", value:locale[\"delete-column\"]},\n\t\t{ id:\"show\",   group:\"column\", value:locale[\"show-column\"]},\n\t\t{ id:\"hide\",   group:\"column\", value:locale[\"hide-column\"]}\n\t];\n\tif(view.config.resizeCell != false)\n\t\tcolOperations.push({ id:\"resize\", group:\"column\", value:locale[\"resize-column\"]});\n\treturn colOperations;\n}\n\nexport function getRowOperation(view){\n\tconst locale = webix.i18n.spreadsheet.menus;\n\tlet rowOperations = [\n\t\t{ id:\"add\",    group:\"row\", value:locale[\"insert-row\"]},\n\t\t{ id:\"del\",    group:\"row\", value:locale[\"delete-row\"]},\n\t\t{ id:\"show\",   group:\"row\", value:locale[\"show-row\"]},\n\t\t{ id:\"hide\",   group:\"row\", value:locale[\"hide-row\"]}\n\t];\n\tif(view.config.resizeCell != false)\n\t\trowOperations.push({ id:\"resize\", group:\"row\", value:locale[\"resize-row\"]});\n\treturn rowOperations;\n}\n\n// options for 'clear' select\nexport function getClearOperation(){\n\treturn [\n\t\t{id: \"clear-value\",               value: getLocaleClear(\"value\")},\n\t\t{id: \"clear-style\",               value: getLocaleClear(\"style\")},\n\t\t{id: \"clear-conditional-formats\", value: getLocaleClear(\"conditional-formats\")},\n\t\t{id: \"clear-dropdown-editors\",    value: getLocaleClear(\"dropdown-editors\")},\n\t\t{id: \"clear-comments\",            value: getLocaleClear(\"comments\")},\n\t\t{ $template: \"Separator\" },\n\t\t{id: \"clear-all\",                 value: getLocaleClear(\"all\")}\n\t];\n}\n\n// options for 'borders' select\nconst borders = [\n\t{id: \"no\", value: \"no\"},\n\t{id: \"left\", value: \"left\"},\n\t{id: \"top\", value: \"top\"},\n\t{id: \"right\", value: \"right\"},\n\t{id: \"bottom\", value: \"bottom\"},\n\t{id: \"all\", value: \"all\"},\n\t{id: \"outer\", value: \"outer\"},\n\t{id: \"top-bottom\", value: \"top-bottom\"}\n];\n\nfunction getLocaleClear(value){\n\tvar locale = webix.i18n.spreadsheet.menus;\n\treturn locale[\"clear\"] + \" \" + locale[\"clear-\"+value].toLowerCase();\n}\n\n// options for 'font-size' select\nfunction getFontSize(){\n\tvar numbers = [\n\t\t\"8\",\"9\",\"10\",\"11\",\"12\",\"14\",\"15\",\n\t\t\"16\",\"18\",\"20\",\"22\",\"24\",\"28\",\"36\"\n\t];\n\tvar  fontSize = [];\n\n\tfor(var i =0; i < numbers.length; i++){\n\t\tfontSize.push({id: numbers[i]+webix.i18n.spreadsheet.labels.px, value: numbers[i]});\n\t}\n\treturn fontSize;\n}\n\nexport const styleFormats = {\n\t\"font-weight\": \"bold\",\n\t\"font-style\": \"italic\",\n\t\"text-decoration\": \"underline\"\n};\n\nexport const ui = {\n\tbutton: function(config){\n\t\treturn {\n\t\t\tview: \"ssheet-toggle\", width: config.width||toolbarSizes.width, id: config.name, name: config.name,  label: config.label,\n\t\t\tcss: config.css||\"\", onValue: styleFormats[config.name], offValue: \"normal\",\n\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[config.name]||\"\"\n\t\t};\n\t},\n\tcolorButton: function(config){\n\t\treturn   {\n\t\t\tview: \"ssheet-color\",  css: config.css,  name: config.name, width: config.width||toolbarSizes.width+24,\n\t\t\ttitle: \"<span class='webix_ssheet_button_icon webix_ssheet_color_button_icon webix_ssheet_icon ssi-\"+config.name+\"' ></span>\",\n\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[config.name]||\"\"\n\t\t};\n\t},\n\ticonButton: function(config){\n\t\tvar btn = webix.copy(config);\n\t\twebix.extend(btn, {view: \"button\", type:\"htmlbutton\", width: toolbarSizes.width, id: config.name,\n\t\t\tlabel: \"<span class='webix_ssheet_button_icon webix_ssheet_icon ssi-\"+config.name+\"'></span>\",\n\t\t\tcss: \"\",\n\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[config.name]||webix.i18n.spreadsheet.menus[config.name]||\"\"\n\t\t});\n\t\tif(config.onValue){\n\t\t\twebix.extend(btn,{view: \"ssheet-toggle\", onValue: config.onValue, offValue: config.offValue},true);\n\t\t}\n\n\t\treturn btn;\n\t},\n\tsegmented: function(config){\n\t\treturn  {\n\t\t\tview: \"segmented\", name: config.name, css:config.css||\"\", width: config.width||toolbarSizes.width+76,  options:config.options\n\t\t};\n\t},\n\tselect: function(config){\n\t\twebix.extend(config,{\n\t\t\tview: \"richselect\",\n\t\t\tid: config.name,\n\t\t\tvalue: defaultStyles[config.name],\n\t\t\tsuggest: {\n\t\t\t\tcss: \"webix_ssheet_suggest\",\n\t\t\t\t//fitMaster: false,\n\t\t\t\tpadding: 0,\n\t\t\t\tdata: config.options\n\t\t\t}\n\t\t});\n\n\t\tconfig.tooltip = webix.i18n.spreadsheet.tooltips[config.name]||\"\";\n\t\tif(config.popupWidth){\n\t\t\tconfig.suggest.fitMaster = false;\n\t\t\tconfig.suggest.width = config.popupWidth;\n\t\t}\n\t\tif(config.popupTemplate)\n\t\t\tconfig.suggest.body = {\n\t\t\t\ttemplate: config.popupTemplate\n\t\t\t};\n\t\tif(config.popupEvents){\n\t\t\tconfig.suggest.body = config.suggest.body || {};\n\t\t\tconfig.suggest.body.on = config.popupEvents;\n\t\t}\n\t\treturn config;\n\t},\n\tseparator: function(){\n\t\treturn {\n\t\t\tview: \"ssheet-separator\"\n\t\t};\n\t},\n\ttitle: function(config){\n\t\tvar title = config.title;\n\t\tif(title.indexOf(\"$\") === 0)\n\t\t\ttitle = \"\";\n\t\ttitle = webix.i18n.spreadsheet.labels[config.title]||title;\n\n\t\treturn {\n\t\t\ttemplate: title, view: \"ssheet-bar-title\", height: toolbarSizes.titleHeight\n\t\t};\n\t},\n\tborders: function(config){\n\t\treturn {view: \"ssheet-borders\", width:config.width||toolbarSizes.width+24, data: borders, id: config.name, name: config.name,\n\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[config.name] };\n\t},\n\talign: function(config){\n\t\treturn {view: \"ssheet-align\", value: defaultStyles[config.name], width:config.width||toolbarSizes.width+24, data: config.options,\n\t\t\tname: config.name, tooltip: webix.i18n.spreadsheet.tooltips[config.name] };\n\t},\n\tcondFormat: function(config){\n\t\treturn {\n\t\t\tview: \"ssheet-cond-format\",\n\t\t\twidth: 40,\n\t\t\tid: config.name,\n\t\t\tname: config.name\n\t\t};\n\t}\n};\n\nexport const buttonsMap = {\n\t\"font-family\": function(){\n\t\treturn  ui.select({name: \"font-family\", options:fontFamily, width: 100});\n\t},\n\t\"font-size\": function(){\n\t\treturn  ui.select({name: \"font-size\", options:getFontSize(), width: 64});\n\t},\n\t\"font-weight\": function(){\n\t\treturn ui.button({name:\"font-weight\",label: \"B\", css: \"webix_ssheet_bold\"});\n\t},\n\t\"font-style\": function(){\n\t\treturn ui.button({name: \"font-style\",label: \"I\",css:\"webix_ssheet_italic\"});\n\t},\n\t\"text-decoration\": function(){\n\t\treturn ui.button({name: \"text-decoration\",label: \"U\",css: \"webix_ssheet_underline\"});\n\t},\n\t\"color\": function(){\n\t\treturn ui.colorButton({name: \"color\",icon:\"font\",css:\"webix_ssheet_color\"});\n\t},\n\t\"background\": function(){\n\t\treturn  ui.colorButton({name: \"background\",icon:\"paint-brush\",css:\"webix_ssheet_background\", width: 64});\n\t},\n\t\"borders\": function(){\n\t\treturn ui.borders({ name: \"borders\" });\n\t},\n\t\"text-align\": function(){\n\t\tvar locale = webix.i18n.spreadsheet.tooltips;\n\t\treturn ui.align({name: \"text-align\", css: \"webix_ssheet_align\", options:[\n\t\t\t{id: \"left\", css: \"webix_ssheet_icon ssi-left\", tooltip: locale[\"align-left\"]},\n\t\t\t{id: \"center\", css: \"webix_ssheet_icon ssi-center\", tooltip: locale[\"align-center\"]},\n\t\t\t{id: \"right\", css: \"webix_ssheet_icon ssi-right\", tooltip: locale[\"align-right\"]}\n\t\t]});\n\t},\n\t\"vertical-align\": function(){\n\t\tvar locale = webix.i18n.spreadsheet.tooltips;\n\t\treturn  ui.align({name: \"vertical-align\", css: \"webix_ssheet_align\", options:[\n\t\t\t{id: \"top\", css: \"webix_ssheet_icon ssi-top\", tooltip: locale[\"align-top\"]},\n\t\t\t{id: \"middle\", css: \"webix_ssheet_icon ssi-middle\", tooltip: locale[\"align-middle\"]},\n\t\t\t{id: \"bottom\", css: \"webix_ssheet_icon ssi-bottom\", tooltip: locale[\"align-bottom\"]}\n\t\t]});\n\t},\n\t\"wrap\": function(){\n\t\treturn ui.iconButton({name: \"wrap\", onValue: \"wrap\",offValue:\"nowrap\"});\n\t},\n\t\"format\": function(){\n\t\treturn ui.select({\n\t\t\tname: \"format\", width: 106, options:getCellFormats(), popupWidth: 180,\n\t\t\tpopupTemplate: function(obj){\n\t\t\t\t//make it look like an actual cell\n\t\t\t\tvar format =  formatHelpers[obj.id] ? formatHelpers[obj.id].getFormat : \"\";\n\t\t\t\tvar cell = {css:\"\"};\n\t\t\t\tvar example = format && obj.example?format(obj.example, cell):\"\";\n\t\t\t\treturn obj.value + (format?\"<span class='webix_ssheet_right\"+(cell.css?\" \"+cell.css:\"\")+\"'>\"+example+\"</span>\":\"\");\n\t\t\t},\n\t\t\tpopupEvents:{\n\t\t\t\tonItemClick: function(id){\n\t\t\t\t\tif(id == \"custom\")\n\t\t\t\t\t\tthis.getTopParentView().callEvent(\"onCommand\", [{id:id}]);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t},\n\t\"column\": function(view){\n\t\treturn {\n\t\t\tname: \"column\",\n\t\t\tview: \"ssheet-button\", icon: \"column\",\n\t\t\tarrow: true, area: true, width: 58,\n\t\t\toptions:getColumnOperation(view)\n\t\t};\n\t},\n\t\"row\": function(view){\n\t\treturn {\n\t\t\tname: \"row\", view: \"ssheet-button\", icon: \"row\",\n\t\t\tarrow: true, area: true, width: 58,\n\t\t\toptions:getRowOperation(view)\n\t\t};\n\t},\n\t\"clear\": function(){\n\t\treturn {\n\t\t\tname: \"clear\", view: \"ssheet-button\", icon: \"clear-styles\",\n\t\t\tarrow: true, area: true, width: 58,\n\t\t\toptions:getClearOperation()\n\t\t};\n\t},\n\t\"comment\": function(){\n\t\treturn {\n\t\t\tname: \"comment\",\n\t\t\tview: \"ssheet-button\", icon: \"comments\",\n\t\t\tarrow: true, area: true, width: 55\n\t\t};\n\t}\n};","import {toolbarSizes} from \"./defaults\";\n\nfunction getText(text){\n\tvar locale = webix.i18n.spreadsheet;\n\treturn locale.menus[text] || locale.labels[text] || locale.tooltips[text] || text;\n}\nfunction calcButtons(){\n\tvar i, name, width,\n\t\tgroups = {\n\t\t\t\"undo\":[\"undo\",\"redo\"],\n\t\t\t\"insert\":[\"add-sparkline\",\"add-image\",\"add-comment\"]\n\t\t},\n\t\tresult = {};\n\n\tfor( name in groups){\n\t\tresult[name] = 0;\n\t\tfor(i=0; i < groups[name].length; i++){\n\t\t\twidth = webix.html.getTextSize(getText(groups[name][i]), \"webix_ssheet_button_measure\").width + 7;\n\t\t\tresult[name] = Math.max(width,result[name]);\n\t\t}\n\t}\n\treturn result;\n}\nexport function getAllElements(){\n\tvar sizes = calcButtons();\n\tvar titleHeight = toolbarSizes.titleHeight;\n\n\treturn [\n\t\t{\n\t\t\tpadding: 3,\n\t\t\tmargin: 0,\n\t\t\trows:[\n\t\t\t\t{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: \"sheet\", view: \"ssheet-button-icon-top\", label: getText(\"sheet\"), arrow: true,\n\t\t\t\t\t\t\toptions:[\n\t\t\t\t\t\t\t\t{id: \"new-sheet\"},\n\t\t\t\t\t\t\t\t{id: \"copy-sheet\"},\n\t\t\t\t\t\t\t\t{id: \"remove-sheet\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t{$button: \"excel-import\"},\n\t\t\t\t\t\t\t\t{$button: \"excel-export\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t{$button: \"print\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{},\n\t\t\t\t{template: getText(\"file\"), view: \"ssheet-bar-title\", height: titleHeight, width: 85}\n\t\t\t]\n\t\t},\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{$button: \"undo\", view: \"ssheet-button\", label: getText(\"undo\"), width: sizes.undo },\n\t\t\t\t{$button: \"redo\", view: \"ssheet-button\", label: getText(\"redo\"), width: sizes.undo},\n\t\t\t\t{template: getText(\"undo-redo\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmargin: 2,\n\t\t\t\t\t\t\tcols:[\n\t\t\t\t\t\t\t\t{$button: \"font-family\", width: (webix.skin.$active.inputHeight+2)*3+4},\n\t\t\t\t\t\t\t\t{$button: \"font-size\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{$button: \"borders\"}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmargin: 2,\n\t\t\t\t\t\t\tcols:[\n\t\t\t\t\t\t\t\t{$button: \"font-weight\"},\n\t\t\t\t\t\t\t\t{$button: \"font-style\"},\n\t\t\t\t\t\t\t\t{$button: \"text-decoration\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\n\t\t\t\t\t\t{$button: \"background\"},\n\t\t\t\t\t\t{$button: \"color\"}\n\t\t\t\t\t]\n\n\t\t\t\t},\n\t\t\t\t{template: getText(\"font\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{$button: \"text-align\"},\n\t\t\t\t\t\t{$button: \"span\"}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{$button: \"vertical-align\"},\n\n\t\t\t\t\t\t{$button: \"wrap\"}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{template: getText(\"align\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{$button: \"format\"},\n\t\t\t\t{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{$button: \"increase-decimals\"},\n\t\t\t\t\t\t{$button: \"decrease-decimals\"}\n\t\t\t\t\t]\n\t\t\t\t},\n\n\t\t\t\t{template: getText(\"number\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{cols:[\n\t\t\t\t\t{ $button: \"sort-asc\"},\n\t\t\t\t\t{ $button: \"create-filter\"},\n\t\t\t\t\t{ $button: \"conditional-format\"},\n\t\t\t\t\t{ $button: \"add-link\"},\n\t\t\t\t\t{ $button: \"clear\"}\n\t\t\t\t]},\n\t\t\t\t{cols:[\n\t\t\t\t\t{ $button: \"sort-desc\"},\n\t\t\t\t\t{ $button: \"add-range\"},\n\t\t\t\t\t{ $button: \"lock-cell\"},\n\t\t\t\t\t{ $button: \"add-dropdown\"}\n\t\t\t\t]},\n\t\t\t\t{template: getText(\"edit\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{$button: \"add-image\", view: \"ssheet-button\", label: getText(\"image\"), width:sizes.insert},\n\t\t\t\t\t\t{$button: \"add-comment\", view: \"ssheet-button\", label: getText(\"comment\"), width:sizes.insert},\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{$button: \"add-sparkline\", view: \"ssheet-button\", label: getText(\"graph\"), width:sizes.insert},\n\t\t\t\t{template: getText(\"insert\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{rows:[\n\t\t\t\t\t\t\t{$button:\"row\"},\n\t\t\t\t\t\t\t{$button:\"column\"}\n\t\t\t\t\t\t]},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t{$button:\"hide-gridlines\"},\n\t\t\t\t\t\t\t\t{$button:\"hide-headers\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t{$button:\"freeze-rows\"},\n\t\t\t\t\t\t\t\t{$button:\"freeze-columns\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{template: getText(\"view\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\t\t{view: \"ssheet-separator\"},\n\t\t{}\n\t];\n}","import {actions} from \"./toolbar/actions\";\nimport {defaultStyles} from \"./toolbar/defaults\";\nimport {toolbarButtons, getButtons} from \"./toolbar/helpers\";\nimport * as elm from \"./toolbar/all_elements\";\nimport {isCustom} from \"./operations/formats\";\n\nconst buttons = {\n\t\"undo-redo\": [\"undo\",\"redo\"],\n\t\"font\": [\"font-family\",\"font-size\",\"font-weight\",\"font-style\",\"text-decoration\",\"color\",\"background\",\"borders\"],\n\t\"align\": [\"text-align\",\"vertical-align\",\"wrap\",\"span\"],\n\t\"format\": [\"format\"]\n};\n\n\nexport function init(view){\n\tview.attachEvent(\"onComponentInit\", () => ready(view));\n\tvar elements = [];\n\n\tif(view.config.toolbar){\n\t\tlet allElements =  view.config.toolbar;\n\t\tif(allElements == \"full\"){\n\t\t\tallElements = elm.getAllElements();\n\t\t\tif(webix.isUndefined(view.config.bottombar))\n\t\t\t\tview.config.bottombar = true;\n\t\t}\n\t\telements =   toolbarButtons(view, allElements);\n\t}\n\telse\n\t\telements =   getButtons(view, view.config.buttons || buttons);\n\n\tvar bar = {\n\t\tview:\"toolbar\",\n\t\tcss: \"webix_ssheet_toolbar webix_layout_toolbar\",\n\t\tid:\"bar\",\n\t\tpadding:0,\n\t\telements: elements,\n\t\ton: {\n\t\t\tonChange: function (){\n\t\t\t\tvar source = this.$eventSource;\n\t\t\t\tvar value = source.getValue();\n\t\t\t\tvar name = source.config.name;\n\t\t\t\tif(name == \"format\" && value == \"common\")\n\t\t\t\t\tvalue = \"\";\n\t\t\t\tif(!(name == \"format\" && value == \"custom\"))\n\t\t\t\t\tview.callEvent(\"onStyleSet\", [name, value]);\n\t\t\t},\n\t\t\tonItemClick: function (id){\n\t\t\t\tvar viewId = view.innerId(id);\n\t\t\t\tif (actions[viewId])\n\t\t\t\t\tactions[viewId].call(this, view);\n\t\t\t\telse\n\t\t\t\t\tview.callEvent(\"onCommand\", [{ id: viewId }]);\n\t\t\t}\n\t\t}\n\t};\n\n\tview.callEvent(\"onViewInit\", [\"toolbar\", bar]);\n\treturn bar;\n\n}\n\nfunction ready(view){\n\tview.attachEvent(\"onAfterSelect\", (selected) => setValues(view, selected));\n}\n\nfunction setValues(view, selected) {\n\tvar styles = {};\n\tvar cell = selected[0];\n\tif(cell){\n\t\tvar obj = view.getStyle(cell.row, cell.column);\n\t\tif (obj)\n\t\t\tstyles = obj.props;\n\t}\n\n\tvar barStyles = webix.copy(styles);\n\n\tfor(var i in defaultStyles){\n\t\tif(!barStyles[i])\n\t\t\tbarStyles[i] = defaultStyles[i];\n\t}\n\n\tbarStyles.format = isCustom(barStyles.format) ? \"custom\" : barStyles.format;\n\n\tview.$$(\"bar\").setValues(barStyles);\n}","import {ui, buttonsMap} from \"./buttons\";\n\nexport function toolbarButtons(view,structure){\n\tvar checkButtons = function(cells){\n\t\tfor(var i =0; i < cells.length; i++){\n\t\t\tvar name = cells[i].$button;\n\t\t\tif (name){\n\t\t\t\tvar base = buttonsMap[name] ? buttonsMap[name](view) : ui.iconButton({name:name});\n\t\t\t\twebix.extend(cells[i], base);\n\t\t\t}\n\t\t\t\n\t\t\tif(cells[i].rows)\n\t\t\t\tcheckButtons(cells[i].rows);\n\t\t\tif(cells[i].cols)\n\t\t\t\tcheckButtons(cells[i].cols);\n\t\t}\n\t};\n\tcheckButtons(structure);\n\treturn structure;\n}\n\nexport function getButtons(view,structure){\n\tvar config = [];\n\tfor(var block in structure){\n\t\tconfig.push(elementsBlock(view, block, structure[block]));\n\t\tconfig.push(ui.separator());\n\t}\n\treturn config;\n}\n\nfunction blockColumns(view, buttons){\n\tvar cols = [];\n\tfor(var i =0; i < buttons.length; i++){\n\t\tlet name = buttons[i];\n\t\tif(typeof name == \"object\"){\n\t\t\tcols.push(name);\n\t\t}\n\t\telse {\n\t\t\tvar base = buttonsMap[name] ? buttonsMap[name](view) : ui.iconButton({name:name});\n\t\t\tcols.push(base);\n\t\t}\n\t}\n\treturn cols;\n}\n\n\nfunction elementsBlock(view, name, columns){\n\tvar block = {\n\t\trows:[\n\t\t\t{\n\t\t\t\tpadding:2,\n\t\t\t\tcols:[{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols: blockColumns(view, columns)\n\t\t\t\t}]\n\t\t\t},\n\t\t\tui.title({title:name})\n\t\t]\n\t};\n\treturn block;\n}","import {getTextSize} from \"./styles\";\n\nexport function selectRow(row, view, endRow){\n\tvar columns = view.$$(\"cells\").config.columns;\n\tvar firstColumn = columns[0].id == \"rowId\" ? 1 : 0;\n\n\tvar start = {\n\t\trow:row,\n\t\tcolumn:columns[firstColumn].id\n\t};\n\tvar last = {\n\t\trow: (endRow || row),\n\t\tcolumn: columns[columns.length-1].id\n\t};\n\n\tif(start.column && last.column)\n\t\t_selectRange(start, last, view);\n}\n\nexport function selectAll(view){\n\tvar order = view.$$(\"cells\").data.order;\n\tvar columns = view.$$(\"cells\").config.columns;\n\tvar firstColumn = columns[0].id == \"rowId\" ? 1 : 0;\n\n\tvar start = {\n\t\trow: order[0],\n\t\tcolumn: columns[firstColumn].id\n\t};\n\tvar last = {\n\t\trow: order[order.length-1],\n\t\tcolumn: columns[columns.length-1].id\n\t};\n\n\tif(start.column && last.column)\n\t\t_selectRange(start, last, view);\n}\n\nexport function selectColumn(column, view, endColumn){\n\tvar order = view.$$(\"cells\").data.order;\n\tvar startRow = order[0];\n\tvar lastRow = order[order.length-1];\n\n\tvar start = {row: startRow, column: column};\n\tvar last = {row: lastRow, column: (endColumn || column) };\n\n\t_selectRange(start, last, view);\n}\n\nexport function isColSelected(column, view){\n\tconst selectedArea = view.$$(\"cells\").getSelectArea();\n\tif (selectedArea){\n\t\tif (column >= selectedArea.start.column && column <= selectedArea.end.column)\n\t\t\treturn true;\n\t}\n\treturn false;\n}\n\nexport function isCellSelected(row, column, view){\n\treturn isRowSelected(row, view) && isColSelected(column, view);\n}\n\nexport function isRowSelected(row, view){\n\tconst selectedArea = view.$$(\"cells\").getSelectArea();\n\tif (selectedArea){\n\t\tif (row >= selectedArea.start.row && row <= selectedArea.end.row)\n\t\t\treturn true;\n\t}\n\treturn false;\t\n}\n\nexport function selectColumns(column, view) {\n\tconst selectedArea = view.$$(\"cells\").getSelectArea();\n\t\n\tif (!selectedArea)\n\t\tselectColumn(column, view);\n\telse {\n\t\tlet col1 = Math.min(selectedArea.start.column, selectedArea.end.column, column);\n\t\tlet col2 = Math.max(selectedArea.start.column, selectedArea.end.column, column);\n\t\tselectColumn(col1, view, col2);\n\t}\n}\n\nfunction _selectRange(a, b, view){\n\tview.$$(\"cells\").addSelectArea(a, b);\n}\n\n\nexport function adjustColumn(column, view) {\n\tlet width = 25;\n\n\tview._table.eachRow(function(row) {\n\t\tconst rowobj = this.getItem(row);\n\t\tconst text = this.getText(row, column);\n\t\tlet style = view.getStyle(row, column);\n\t\tlet css = style ? style.id : \"\";\n\n\t\tif (text) {\n\t\t\tlet size = getTextSize(view, text, css, 0, rowobj.$height);\n\t\t\tif (size.width > width) width = size.width;\n\t\t}\n\t});\n\tview._table.setColumnWidth(column, width);\n}\n\nexport function adjustRow(row, view) {\n\tlet height = 25;\n\t\n\tview._table.eachColumn(function(column) {\n\t\tconst text = this.getText(row, column);\n\t\tlet style = view.getStyle(row, column);\n\t\tlet css = style ? style.id : \"\";\n\n\t\tif (text) {\n\t\t\tlet size = getTextSize(view, text, css, this.getColumnConfig(column).width, 0);\n\t\t\tif (size.height > height) height = size.height;\n\t\t}\n\t});\n\tview._table.setRowHeight(row, height);\n}\n\nexport function highlightColRow(start,end, view){\n\tif(!view._table.config.header) return;\n\t\n\tvar sr = start.row, er = end.row, sc = start.column, ec = end.column;\n\tif(er<sr) [sr, er] = [er, sr];\n\tif(ec<sc) [sc, ec] = [ec, sc];\n\n\tview._table.eachRow(function(row){\n\t\tif(row >=sr && row<=er)\n\t\t\tview._table.addCellCss(row, \"rowId\", \"webix_highlight\");\n\t\telse \n\t\t\tview._table.removeCellCss(row, \"rowId\", \"webix_highlight\");\n\t});\n\n\tview._table.eachColumn(function(col){\n\t\tvar node = view._table.getHeaderNode(col);\n\t\tif(!node) return;\n\n\t\tif(col >=sc && col<=ec)\n\t\t\twebix.html.addCss(node, \"webix_highlight\");\n\t\telse\n\t\t\twebix.html.removeCss(node, \"webix_highlight\");\n\t});\n}\n\n\n\n\n\n\n","import * as cop from \"./operations/column_operations\";\nimport * as nms from \"./helpers/column_names\";\nimport * as fmt from \"./operations/formats\";\n\nexport function init(view, extra){\n\tview.attachEvent(\"onComponentInit\", () => ready(view));\n\n\tvar datatable = {\n\t\tview:\"datatable\", id:\"cells\", css:\"webix_ssheet_table webix_data_border wss_\"+view.$index,\n\t\theaderRowHeight: webix.skin.$name == \"contrast\" || webix.skin.$name == \"flat\" ? 24 : 20,\n\t\tspans: true,\n\t\tleftSplit: 1,\n\t\tareaselect:true,\n\t\teditable:true,\n\t\teditaction:(extra.liveEditor ? \"custom\" : \"dblclick\"),\n\t\tminRowHeight:1,\n\t\tnavigation:true\n\t};\n\n\t//enable clipboard by default\n\tif (extra.clipboard !== false){\n\t\textra.clipboard = \"custom\";\n\t\tif(extra.clipboardDecimalDelimiter)\n\t\t\textra.templateCopy = function(item) {\n\t\t\t\tif(webix.rules.isNumber(item))\n\t\t\t\t\titem = item.toString().replace(\".\", extra.clipboardDecimalDelimiter);\n\t\t\t\treturn item;\n\t\t\t};\n\t}\n\tif (extra)\n\t\tdatatable = webix.extend(datatable, extra, true);\n\n\treturn datatable;\n}\n\nfunction ready(view){\n\tvar grid = view._table;\n\n\tvar showHandler = webix.event(document.body, \"mousemove\", function(){\n\t\tvar thread;\n\t\treturn function(e) {\n\t\t\tclearTimeout(thread);\n\t\t\tthread = webix.delay(function(e){\n\t\t\t\tif(view.comments._activeComment.editStatus)\n\t\t\t\t\treturn;\n\n\t\t\t\tvar cell = grid.locate(e);\n\t\t\t\tvar visible = view.comments.commentsView && view.comments.commentsView.isVisible();\n\n\t\t\t\tif(cell && view.comments.get(cell.row, cell.column)){\n\t\t\t\t\tvar activeCell = view.comments._activeComment.cell;\n\t\t\t\t\tif((activeCell && (activeCell.row != cell.row || activeCell.column != cell.column)) || !visible)\n\t\t\t\t\t\tview.callEvent(\"onCommand\",[{id: \"add-comment\", cell, viewonly: true }]);\n\t\t\t\t}\n\t\t\t\telse if(visible && !view.comments.commentsView.$view.contains(e.target))\n\t\t\t\t\tview.callEvent(\"onCommentHide\", []);\n\t\t\t}, true, [e], 250);\n\t\t};\n\t}());\n\n\tview.attachEvent(\"onDestruct\", () => webix.eventRemove(showHandler));\n\n\t//in grid math\n\tif (view.config.math){\n\t\tgrid.config.editMath = true;\n\t}\n\n\t//saving value after edit\n\tgrid.attachEvent(\"onBeforeEditStop\", (st, ed) => {\n\t\t//ignore empty cells\n\t\tif (st.old === webix.undefined && st.value === \"\") return;\n\n\t\tif (st.value != st.old){\n\t\t\tview.setCellValue(ed.row, ed.column, st.value);\n\t\t\tgrid.refresh();\n\t\t}\n\t\tst.value = st.old;\n\t});\n\t\n\t//column drag event checking\n\tlet dragStartColumn;\n\tgrid.$view.firstChild.addEventListener(\"mousedown\", (e)=>{\n\t\t//column ids are starting from 0, thats why we adding 1\n\t\tdragStartColumn = e.target.parentNode.cellIndex + 1;\n\t});\n\tgrid.$view.firstChild.addEventListener(\"mouseup\", (e)=>{\n\t\tconst dragEndColumn = e.target.parentNode.cellIndex + 1;\n\t\tif (dragStartColumn && dragStartColumn !== dragEndColumn) {\n\t\t\tcop.selectColumn(dragStartColumn, view, dragEndColumn);\n\t\t\tdragStartColumn = undefined;\n\t\t}\n\t});\n\n\tgrid.attachEvent(\"onEnter\", function(ev){\n\t\tif (grid.getEditor()){\n\t\t\twebix.delay(function(){\n\t\t\t\tgrid.moveSelection(\"down\");\n\t\t\t});\n\t\t}\n\t\twebix.html.preventEvent(ev);\n\t});\n\n\t//prevent editing of locked cells\n\tview.attachEvent(\"onBeforeEditStart\", (row, column) => !view.isCellLocked(row, column));\n\tgrid.attachEvent(\"onBeforeEditStart\", (editor) => \n\t\tview.callEvent(\"onBeforeEditStart\", [editor.row, editor.column]) );\n\n\t//column and row selection\n\tgrid.attachEvent(\"onBeforeSelect\", (id) => id.column != \"rowId\" );\n\tgrid.attachEvent(\"onBeforeBlockSelect\", (start, end, finalStep) => {\n\t\tif (finalStep &&\n\t\t(start.column !== \"rowId\" || end.column !== \"rowId\")) {\n\t\t\tif (start.column === \"rowId\") start.column = 1;\n\t\t\tif (end.column === \"rowId\") end.column = 1;\n\t\t}\n\t\tif(start.column !== \"rowId\" || end.column !== \"rowId\"){\n\t\t\tcop.highlightColRow(start,end, view);\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t});\n\tgrid.attachEvent(\"onSelectChange\", () => {\n\t\tlet ids = grid.getSelectedId(true);\n\t\tif(ids.length){\n\t\t\tlet start = ids[0];\n\t\t\tlet end = ids[ids.length-1]?ids[ids.length-1]:ids[0];\n\t\t\tcop.highlightColRow(start, end, view);\n\t\t} else {\n\t\t\tlet data = {row:0, column:0};\n\t\t\tcop.highlightColRow(data, data, view);\n\t\t}\n\t});\n\n\tgrid.attachEvent(\"onItemDblClick\", (id) => {\n\t\tif (id.column === \"rowId\")\n\t\t\tcop.adjustRow(id.row, view);\n\t});\n\n\tlet lastHeaderClick = 0;\n\tgrid.attachEvent(\"onHeaderClick\", (id, e) => {\n\t\tif(id.column == \"rowId\"){\n\t\t\tcop.selectAll(view);\n\t\t\treturn;\n\t\t}\n\t\tlet headerClick = new Date();\n\t\tlet dblClick = (headerClick - lastHeaderClick <= 300);\n\n\t\tif (dblClick) {\n\t\t\tcop.adjustColumn(id.column, view);\n\t\t} else {\n\t\t\tlastHeaderClick = headerClick;\n\t\t\tif (e.shiftKey) {\n\t\t\t\tcop.selectColumns(id.column, view);\n\t\t\t} else {\n\t\t\t\tcop.selectColumn(id.column, view);\n\t\t\t}\n\t\t}\n\t});\n\n\t//select rows by shift click\n\tvar lastClickedRow = null;\n\tgrid.attachEvent(\"onItemClick\", (cell, e) => {\n\t\tif (cell.column === \"rowId\") {\n\t\t\tif (!e.shiftKey)\n\t\t\t\tcop.selectRow(cell.row, view);\n\t\t\telse {\n\t\t\t\tif (!lastClickedRow)\n\t\t\t\t\tcop.selectRow(cell.row, view);\n\t\t\t\telse\n\t\t\t\t\tcop.selectRow(lastClickedRow, view, cell.row);\n\t\t\t}\n\t\t\tlastClickedRow = cell.row;\n\t\t}\n\t});\n\n\t//reset API\n\tview.attachEvent(\"onReset\", () => reset(view));\n\n\tview.attachEvent(\"onBeforeSheetShow\", () => grid.editStop());\n\n\tgrid.attachEvent(\"onBlur\", function(){\n\t\t//after focus moved out, check and if it is somewhere\n\t\t//on the spreadsheet controls them move focus back to datatable\n\t\twebix.delay(function(){\n\t\t\tvar target = document.activeElement;\n\n\t\t\tif (target && target.tagName == \"INPUT\") return;\n\n\t\t\tvar focus = webix.UIManager.getFocus();\n\t\t\tvar need_focus = focus &&\n\t\t\t\tfocus != grid &&\n\t\t\t\tfocus.getTopParentView &&\n\t\t\t\tfocus.getTopParentView() === view;\n\n\t\t\tif (need_focus)\n\t\t\t\twebix.UIManager.setFocus(grid);\n\n\t\t}, this, [], 100);\n\t});\n\n\tsetDefaultCss(view);\n}\n\nfunction cell_template(view, obj, common, value, column){\n\tconst col = column.id;\n\tconst row = obj.id;\n\n\tconst format = fmt.getFormatName(view, row, col);\n\tconst commented = view.comments.get(row, col) ? \"<div class='ssheet_commented_sign'></div>\" : \"\";\n\n\tconst text = value === \"\" || isNaN(value);\n\tconst invalidDate = fmt.checkFormat(format, \"date\") && fmt.isDateInvalid(value);\n\n\t//text can be formatted only in case of string number format\n\tif(!invalidDate && (!text || fmt.checkFormat(format, \"string\"))){\n\t\tif (format){\n\t\t\tconst cell = { css:\"\" };\n\t\t\tconst helper = fmt.getFormat(format);\n\t\t\tif (helper){\n\t\t\t\tlet newvalue = helper(value, cell);\n\n\t\t\t\tif(newvalue != webix.i18n.spreadsheet.table[\"format-error\"]){\n\t\t\t\t\tif (cell.css)\n\t\t\t\t\t\treturn \"<div class='\"+cell.css+\"'>\"+newvalue+\"</div>\"+commented; \n\t\t\t\t\treturn newvalue+commented;\n\t\t\t\t}\n\t\t\t\telse if(!text)\n\t\t\t\t\tvalue = value * 1;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t\tvalue = value * 1;\n\t}\n\n\tif(webix.isUndefined(value) || value === null)\n\t\tvalue = \"\";\n\treturn value+commented;\n}\n\nexport function reset(view){\n\tvar grid = view.$$(\"cells\");\n\tgrid.clearAll();\n\n\tvar columns = view.config.columnCount;\n\tvar rows = view.config.rowCount;\n\n\tvar cols = [{\n\t\tid:\"rowId\", header:\"\", width:40,\n\t\tcss:\"sheet_column_0\",\n\t\ttemplate(el) {\n\t\t\treturn el.id;\n\t\t}\n\t}];\n\n\tfor (let i=1; i <= columns; i++) {\n\t\tcols.push({\n\t\t\tid:i,\n\t\t\teditor:\"text\",\n\t\t\theader: {\n\t\t\t\ttext: nms.encode[i],\n\t\t\t\tcss: view._hideColumn && view._hideColumn.indexOf(i+1) >= 0 ? \"webix_ssheet_hide_column\" : \"\"\n\t\t\t},\n\t\t\ttemplate:function(obj, common, value, column){\n\t\t\t\treturn cell_template(view, obj, common, value, column);\n\t\t\t}\n\t\t});\n\t\tview.callEvent(\"onColumnInit\",[cols[i]]);\n\t}\n\n\tgrid.refreshColumns(cols);\n\n\tif(view._hideColumn && view._hideColumn.length)\n\t\tview._hideColumn.map(id => grid.hideColumn(id));\n\n\n\tvar data = [];\n\tfor (let i=1; i<=rows; i++)\n\t\tdata.push({ id:i });\n\n\tgrid.parse(data);\n\n\tif(view._hideRow && view._hideRow.length) {\n\t\tgrid.filter(function(obj){\n\t\t\tif(view._hideRow.indexOf(obj.id) === -1) {\n\t\t\t\treturn true;\n\t\t\t}else {\n\t\t\t\tif(obj.id - 1 === 0){\n\t\t\t\t\tlet cell = view.$$(\"cells\").getColumnConfig(\"rowId\").header[0];\n\t\t\t\t\tcell.css = (cell.css || \"\") + \" webix_ssheet_hide_row\";\n\t\t\t\t\tview.$$(\"cells\").refreshColumns();\n\t\t\t\t}else {\n\t\t\t\t\tview.$$(\"cells\").addCellCss(obj.id - 1, \"rowId\", \"webix_ssheet_hide_row\");\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\t}\n}\n\n// nowrap by default\nfunction setDefaultCss(view){\n\twebix.html.addStyle(\"#\"+view._table.$view.id+\".webix_dtable .webix_cell { white-space:nowrap;}\");\n}","import group from \"./operations/undo_group\";\nimport {selectAll} from \"./operations/column_operations\";\nimport {styleFormats} from \"./toolbar/buttons\";\n\nexport function init(view){\n\tvar grid = view.$$(\"cells\");\n\n\tvar key = webix.env.isMac ? \"command\" : \"ctrl\";\n\twebix.UIManager.addHotKey(key+\"-a\", () => { if(!grid.getEditor()) selectAll(view); }, grid);\n\n\tif(!view.config.readonly){\n\t\twebix.UIManager.addHotKey(\"any\", (view, ev) => {\n\t\t\t//ignore shift key\n\t\t\tif ((ev.which || ev.keyCode)  == 16) return;\n\n\t\t\tvar sel = view.getSelectedId(true);\n\t\t\tif (sel.length){\n\t\t\t\tgrid.$anyKey = true;\n\t\t\t\tgrid.edit(sel[0]);\n\t\t\t}\n\t\t}, grid);\n\n\t\twebix.UIManager.addHotKey(\"enter\", (view) => {\n\t\t\tvar sel = view.getSelectedId(true);\n\t\t\tif (sel.length){\n\t\t\t\tif(view.config.liveEditor)\n\t\t\t\t\tgrid.callEvent(\"onBeforeLiveEditor\", [sel[0]]);\n\t\t\t\telse\n\t\t\t\t\tgrid.edit(sel[0]);\n\t\t\t}\n\t\t}, grid);\n\n\t\twebix.UIManager.addHotKey(\"backspace\", () => del(view), grid);\n\t\twebix.UIManager.addHotKey(\"delete\", () => del(view), grid);\n\n\t\tvar redo = webix.env.isMac ? \"command-shift-z\" : \"ctrl-y\";\n\t\twebix.UIManager.addHotKey(redo, () => view.redo(), grid);\n\t\twebix.UIManager.addHotKey(key+\"-z\", () => view.undo(), grid);\n\n\t\twebix.UIManager.addHotKey(key+\"-b\", () => styleHotKey(view, \"font-weight\"), grid);\n\t\twebix.UIManager.addHotKey(key+\"-i\", () => styleHotKey(view, \"font-style\"), grid);\n\t\twebix.UIManager.addHotKey(key+\"-u\", (v, e) => ctrlU(view, e), grid);\n\t\twebix.UIManager.addHotKey(key+\"-p\", (v, e) => ctrlP(view, e), grid);\n\t}\n}\n\nfunction del(view) {\n\tgroup.set(function(){\n\t\tview.eachSelectedCell((cell) => view.setCellValue(cell.row,cell.column, \"\"));\n\t\tview.refresh();\n\t});\n}\n\nfunction ctrlU(view, e) {\n\tstyleHotKey(view, \"text-decoration\");\n\treturn webix.html.preventEvent(e);\n}\nfunction ctrlP(view, e) {\n\tview.callEvent(\"onCommand\",[{id: \"print\"}]);\n\treturn webix.html.preventEvent(e);\n}\n\nfunction styleHotKey(view, attr) { \n\tvar cell = view.getSelectedId();\n\tif(cell){\n\t\tvar style = view.getStyle(cell.row, cell.column);\n\n\t\tvar elementOn = styleFormats[attr];\n\t\tvar elementOff = \"normal\";\n\n\t\tvar state = (style && style.props[attr] === elementOn)? elementOff : elementOn;\n\t\tview.callEvent(\"onStyleSet\", [attr, state]);\n\t}\n}","import {_to_number, _combine} from \"./helpers\";\n\n/*Empty cells, logical values like TRUE, or text are ignored.*/\nexport function SUM(){\n\tvar sum = 0, set = _combine(arguments);\n\tfor (var i = 0; i < set.length; i++){\n\t\tvar v = _to_number(set[i]);\n\t\tif (v !== false) sum+=v;\n\t}\n\treturn sum;\n}\n\n/*If a range or cell reference argument contains text, logical values, or empty cells, those values are ignored; \nhowever, cells with the value zero are included.*/\nexport function AVERAGE(){\n\tvar sum = 0, count = 0, set = _combine(arguments);\n\tfor (var i = 0; i < set.length; i++){\n\t\tvar v = _to_number(set[i]);\n\t\tif (v !== false){\n\t\t\tsum+=v; count++;\n\t\t}\n\t}\n\treturn sum/count;\n}\n\n/*Empty cells, logical values, text, or error values in the array or reference are not counted. */\nexport function COUNT(){\n\tvar count = 0, set = _combine(arguments);\n\tfor (var i = 0; i < set.length; i++){\n\t\tvar v = _to_number(set[i]);\n\t\tif (v !== false)\n\t\t\tcount++;\n\t}\n\treturn count;\n}\n\n/*counts the number of cells that are not empty in a range, zero is excluded.*/\nexport function COUNTA(){\n\tvar count = 0, set = _combine(arguments);\n\tfor (var i = 0; i < set.length; i++)\n\t\tif(set[i] && set[i]*1 !==0 ) count++;\n\treturn count;\n}\n\n/*Counts empty cells in a specified range of cells. Cells with zero values are not counted.*/\nexport function COUNTBLANK(){\n\tvar count = 0, set = _combine(arguments);\n\tfor (var i = 0; i < set.length; i++)\n\t\tif(!set[i]*1) count++;\n\treturn count;\n}\n\n/*Empty cells, logical values, or text in the array or reference are ignored.\nIf the arguments contain no numbers, MAX returns 0 (zero).*/\nexport function MAX(){\n\tvar max = \"\", set = _combine(arguments);\n\tfor (var i = 0; i < set.length; i++){\n\t\tvar v = _to_number(set[i]);\n\t\tif (v !== false && (v>max || max ===\"\"))\n\t\t\tmax = v;\n\t}\n\treturn max || 0;\n}\n\n/*Empty cells, logical values, or text in the array or reference are ignored. \nIf the arguments contain no numbers, MIN returns 0.*/\nexport function MIN(){\n\tvar min = \"\", set = _combine(arguments);\n\tfor (var i = 0; i < set.length; i++){\n\t\tvar v = _to_number(set[i]);\n\t\tif (v !== false && (v<min || min ===\"\"))\n\t\t\tmin = v;\n\t}\n\treturn min || 0;\n}\n\n/* Only numbers in the array or reference are multiplied. \nEmpty cells, logical values, and text in the array or reference are ignored.*/\nexport function PRODUCT(){\n\tvar product = \"\", set = _combine(arguments);\n\tfor (var i = 0; i < set.length; i++){\n\t\tvar v = _to_number(set[i]);\n\t\tif(v !== false)\n\t\t\tproduct = product===\"\"?v:product*v;\n\t}\n\treturn product;\n}\n\n/* For valid products only numbers are multiplied. Empty cells, logical values, and text are ignored.\nTreats array entries that are not numeric as if they were zeros.*/\nexport function SUMPRODUCT(sets){\n\tvar length = sets[0].length;\n\tfor(let i in sets)\n\t\tif(sets[i].length !== length)\n\t\t\treturn;\n\n\tvar sp = 0;\n\tfor (let i = 0; i < sets[0].length; i++){\n\t\tvar product = \"\";\n\t\tfor(var s in sets){\n\t\t\tvar v = _to_number(sets[s][i]);\n\t\t\tif(v !== false) product = product===\"\" ? v: product*v;\n\t\t\telse{ product = 0; break; }\n\t\t}\n\t\tif(!webix.isUndefined(product)) sp+=product;\n\t}\n\treturn sp;\n}\n\n/*Empty cells, logical values, text, or error values in the array or reference are ignored. */\nexport function SUMSQ(){\n\tvar sq = 0, set = _combine(arguments);\n\tfor (var i = 0; i < set.length; i++){\n\t\tvar v = _to_number(set[i]);\n\t\tif(typeof v ===\"number\")\n\t\t\tsq += Math.pow(v, 2);\n\t}\n\treturn sq;\n}\n\n/*Empty cells, logical values, text, or error values in the array or reference are ignored. */\nexport function VARP(){\n\tvar set = _combine(arguments);\n\tvar count = this.COUNT(set);\n\tvar avg = this.AVERAGE(set);\n\t\n\tvar sum = 0;\n\tfor (var i = 0; i < set.length; i++){\n\t\tvar v = _to_number(set[i]);\n\t\tif(v !== false)\n\t\t\tsum += Math.pow(v - avg, 2);\n\t}\n\treturn sum/count;\n}\n\n/* Empty cells, logical values, text, or error values in the array or reference are ignored. */\nexport function STDEVP(){\n\tvar set = _combine(arguments);\n\treturn Math.sqrt(this.VARP(set));\n}\n\n/*real numbers*/\nexport function POWER(num, pow){\n\tvar n = _to_number(num), p = _to_number(pow);\n\tif(typeof n == \"number\" && typeof p ==\"number\")\n\t\treturn Math.pow(n, p);\n\t\n}\n\n/*real numbers*/\nexport function QUOTIENT(num, div){\n\tvar n = _to_number(num), d = _to_number(div);\n\tif(typeof n == \"number\" && typeof d ==\"number\")\n\t\treturn n/d;\n}\n\n/*Returns a positive square root.*/\nexport function SQRT(num){\n\tvar v = _to_number(num);\n\tif(v !== false && v>=0)\n\t\treturn Math.sqrt(v);\n}\n\nexport function ABS(num){\n\tvar v = _to_number(num);\n\tif(v !== false)\n\t\treturn Math.abs(v);\n}\n\nexport function RAND(){\n\treturn Math.random();\n}\n\nexport function PI(){\n\treturn Math.PI;\n}\n\n/*Rounds a number down to the nearest integer*/\nexport function INT(num){\n\tvar v = _to_number(num);\n\tif(v !== false)\n\t\treturn Math.round(v);\n}\n\n/*rounds a number to a specified number of digits*/\nexport function ROUND(num, digits){\n\tvar v = _to_number(num);\n\tvar d = _to_number(digits) || 0;\n\tif(v !== false)\n\t\treturn parseFloat(v.toFixed(d));\n}\n\n/*rounds a number down to a specified number of digits*/\nexport function ROUNDDOWN(num, digits){\n\tvar v = _to_number(num);\n\tvar d = _to_number(digits) || 0;\n\tif(v !== false)\n\t\treturn  Math.floor(v*Math.pow(10, d))/Math.pow(10,d);\n}\n\n/*rounds a number up to a specified number of digits*/\nexport function ROUNDUP(num,digits){\n\tvar v = _to_number(num);\n\tvar d = _to_number(digits) || 0;\n\tif(v !== false)\n\t\treturn Math.ceil(v*Math.pow(10, d))/Math.pow(10,d);\n}\n\n/*Truncates a number to an integer by removing the fractional part of the number.*/\nexport function TRUNC(num){\n\tvar v = _to_number(num);\n\tif(v !== false)\n\t\treturn parseInt(v);\n}\n\n/*Returns number rounded up to the nearest even integer*/\nexport function EVEN(num){\n\tvar v = _to_number(num);\n\tif(v !== false){\n\t\tvar r = Math.round(v);\n\t\treturn r%2?r+1:r;\n\t}\n}\n\n/*Returns number rounded up to the nearest odd integer*/\nexport function ODD(num){\n\tvar v = _to_number(num);\n\tif(v !== false){\n\t\tvar r = Math.round(v);\n\t\treturn r%2?r:r+1;\n\t}\n}","export function CONCATENATE(){\n\tvar data = Array.prototype.slice.call(arguments);\n\tdata = data.map(function(obj){\n\t\tif (typeof obj === \"object\")\n\t\t\treturn obj.join(\"\");\n\t\treturn obj;\n\t});\n\treturn data.join(\"\");\n}\n \nexport function LEFT(text, count) {\n\tif (!text) { return \"\"; }\n\treturn text.substring(0, count);\n}\n\nexport function MID(text, start, count) {\n\tif (!text) { return \"\"; }\n\treturn text.substring(start, start + count);\n}\n\nexport function RIGHT(text, count) {\n\tif (!text) { return \"\"; }\n\treturn text.substring(text.length - count);\n}\n\nexport function LOWER(text) {\n\tif (!text) { return \"\"; }\n\treturn text.toLowerCase();\n}\n\nexport function UPPER(text) {\n\tif (!text) { return \"\"; }\n\treturn text.toUpperCase();\n}\n\nexport function PROPER(text) {\n\tif (!text) { return \"\"; }\n\tvar temp = text.toLowerCase().split(\" \");\n\ttext = \"\";\n\tfor (var idx in temp) {\n\t\ttext += (text ? \" \" : \"\") + temp[idx].substring(0, 1).toUpperCase() + temp[idx].substring(1);\n\t}\n\treturn text;\n}\n\nexport function TRIM(text) {\n\tif (!text) { return \"\"; }\n\treturn text.trim();\n}\n\nexport function LEN(text) {\n\tif (!text && text !== 0) { return 0; }\n\treturn text.toString().length;\n}","import {getJsDateFromExcel, getExcelDateFromJs, dayOfTheYear} from \"./helpers\";\n\nexport function DATE(year, month, day){\n\tconst date = new Date(year, month-1, day);\n\treturn getExcelDateFromJs(date);\n}\n\nexport function TIME(hour, minute, second){\n\tconst date = new Date(1900, 0, 1, hour, minute, second);\n\treturn getExcelDateFromJs(date);\n}\n\nexport function DAY(date){\n\treturn getJsDateFromExcel(date).getDate();\n}\n\nexport function MONTH(date){\n\treturn getJsDateFromExcel(date).getMonth()+1;\n}\n\nexport function YEAR(date){\n\treturn getJsDateFromExcel(date).getFullYear();\n}\n\nexport function NOW(){\n\tconst date = new Date();\n\treturn getExcelDateFromJs(date);\n}\n\nexport function DATEDIF(start, end, unit){\n\tif(unit != \"D\"){\n\t\tstart = getJsDateFromExcel(start);\n\t\tend = getJsDateFromExcel(end);\n\t}\n\n\tswitch(unit){\n\t\tcase \"Y\":\n\t\t\treturn end.getFullYear() - start.getFullYear();\n\t\tcase \"M\":{\n\t\t\tlet months = (end.getFullYear() - start.getFullYear()) * 12;\n\t\t\treturn months + end.getMonth() - (start.getMonth());\n\t\t}\n\t\tcase \"D\":{ \n\t\t\treturn Math.floor(end - start);\n\t\t}\n\t\tcase \"MD\":{\n\t\t\tconst diff = end.getDate() - start.getDate();\n\t\t\tif(diff < 0){\n\t\t\t\tconst startDateDays = new Date(start.getFullYear(), start.getMonth() + 1, 0).getDate();\n\t\t\t\treturn end.getDate() + startDateDays - start.getDate();\n\t\t\t}\n\t\t\treturn diff;\n\t\t}\n\t\tcase \"YM\":{\n\t\t\tconst months = end.getMonth() - start.getMonth();\n\t\t\treturn months < 0 ? 12 + months : months;\n\t\t}\n\t\tcase \"YD\":{\n\t\t\tconst diff = dayOfTheYear(end) - dayOfTheYear(start);\n\t\t\treturn diff < 0 ? 365 + diff : diff;\n\t\t}\n\t}\n}","export function IMAGE(url){\n\treturn `<img class=\"webix_ssheet_cimage\" src=\"${webix.template.escape(url)}\">`;\n}\n\nexport function SPARKLINE(arr, type, color1, color2){\n\tvar i, config = { type: type, color: color1, negativeColor:color2  },\n\t\twidth =  type == \"pie\"? 60: 150;\n\tfor(i =0 ; i < arr.length; i++)\n\t\tarr[i] = arr[i]||0;\n\treturn webix.Sparklines.getTemplate(config)(arr, { width:width, height: 35 });\n}\n\nexport function LINK(url, text){\n\ttext = text || url;\n\treturn `<a target=\"blank\" href=\"${webix.template.escape(url)}\">${webix.template.escape(text)}</a>`;\n}\n\nexport function IF(check, pos, neg){\n\tif (check)\n\t\treturn pos;\n\telse\n\t\treturn neg;\t\n}","import * as numbers from \"./methods/numbers\";\nimport * as strings from \"./methods/strings\";\nimport * as date from \"./methods/date\";\nimport * as other from \"./methods/other\";\n\nexport const methods = {};\n\nwebix.extend(methods, numbers);\nwebix.extend(methods, strings);\nwebix.extend(methods, date);\nwebix.extend(methods, other);\n\nexport function addMethod(name, handler){\n\tmethods[name] = handler;\n}","import * as methods from \"./math/methods\";\n\nlet methodsName = [];\nfor(let i in methods.methods)\n\tif( i!=\"__esModule\") methodsName.push(i);\n\nexport function init(view){\n\tview.attachEvent(\"onComponentInit\", () => ready(view));\n\n\treturn {\n\t\tview:\"toolbar\",\n\t\tcss:\"webix_ssheet_toolbar\",\n\t\telements:[\n\t\t\t{\n\t\t\t\tview:\"label\",\n\t\t\t\tlabel:webix.i18n.spreadsheet.liveEditor[\"edit\"],\n\t\t\t\twidth:60\n\t\t\t},\n\t\t\t{\n\t\t\t\tview:\"live-editor\",\n\t\t\t\tdisabled:true,\n\t\t\t\tid:\"liveEditor\",\n\t\t\t\tsuggestData: methodsName\n\t\t\t}\n\t\t]\n\t};\n}\n\nfunction ready(view){\n\tvar editor = view.$$(\"liveEditor\");\n\n\t//block native editor, and move focus to the custom input\n\t//edit by key press\n\tview._table.attachEvent(\"onBeforeEditStart\", function(cell){\n\t\tlet mode = view._table.$anyKey;\n\t\tview._table.$anyKey = false;\n\n\t\treturn startEdit(this, cell, mode);\n\t});\n\t//edit by enter key\n\tview._table.attachEvent(\"onBeforeLiveEditor\", function(cell){\n\t\treturn startEdit(this, cell, false);\n\t});\n\t//edit by dbl-click\n\tview._table.attachEvent(\"onItemDblClick\", function(){\n\t\teditor.focus();\n\t});\n\n\tview._table.attachEvent(\"onAfterScroll\", function(){\n\t\tif(editor.$view.contains(document.activeElement))\n\t\t\teditor.paintValue();\n\t});\n\n\tview.attachEvent(\"onCellChange\", (r,c,v) => {\n\t\tvar cell = editor.config.activeCell;\n\t\tif (cell && cell.row == r && cell.column == c)\n\t\t\teditor.setValue(v);\n\t});\n\n\tview.attachEvent(\"onAfterSelect\", (data) => {\n\t\tif (!view.$handleSelection){\n\t\t\tlet cell = data[0];\n\t\t\tfillEditor(cell);\n\t\t}\n\t});\n\n\tview.attachEvent(\"onBeforeSheetShow\", (name)=> {\n\t\tconst cell = editor.config.activeCell;\n\t\tif(cell){\n\t\t\tconst cursor = editor.getInputNode().selectionStart;\n\t\t\tconst val = editor.getValue();\n\t\t\tif(view.getCellValue(cell.row, cell.column) != val){\n\t\t\t\tif(!editor._activeMath)\n\t\t\t\t\teditor._activeMath = view.getActiveSheet();\n\t\t\t\twebix.delay(()=>{\n\t\t\t\t\tif(name == editor._activeMath){\n\t\t\t\t\t\tview.$handleSelection = null;\n\t\t\t\t\t\tconst cell = editor.config.activeCell;\n\t\t\t\t\t\tview._table.select(cell.row, cell.column);\n\t\t\t\t\t}\n\n\t\t\t\t\teditor.setValue(val);\n\t\t\t\t\t//update highlight\n\t\t\t\t\teditor.refresh();\n\n\t\t\t\t\teditor.focus();\n\t\t\t\t\teditor.getInputNode().setSelectionRange(cursor, cursor);\n\t\t\t\t\teditor.paintValue();\n\n\t\t\t\t\tview.$handleSelection = function(a,b,st,en){ return pasteRange(st, en, a); };\n\t\t\t\t});\n\t\t\t}\n\t\t\telse{\n\t\t\t\teditor.define({activeCell:null});\n\t\t\t\teditor.setValue(\"\");\n\t\t\t\teditor.disable();\n\t\t\t}\n\t\t}\n\t});\n\n\tview.attachEvent(\"onReset\", () => view.$handleSelection = null);\n\n\tview.attachEvent(\"onAction\", function(name, options){\n\t\tif(name == \"lock\" || name == \"filter\" || name == \"dropdown\")\n\t\t\tdisableEditor(options.row,  options.column);\n\t});\n\n\tfunction startEdit(table, cell, clear){\n\t\tvar cellEditor = table.getColumnConfig(cell.column).editor;\n\t\t//do not interfere with custom editors\n\t\tif (cellEditor == \"text\" && fillEditor(cell, clear)){\n\t\t\teditor.focus();\n\t\t\tif(!clear)\n\t\t\t\teditor.paintValue();\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t}\n\n\tfunction disableEditor(row,column){\n\t\tif (view.getCellEditor(row, column) || view.getCellFilter(row, column) || view.isCellLocked(row, column)){\n\t\t\teditor.setValue(\"\");\n\t\t\teditor.disable();\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tfunction fillEditor(cell, clear){\n\t\tif(disableEditor(cell.row, cell.column))\n\t\t\treturn false;\n\t\teditor.enable();\n\t\teditor.config.activeCell = cell;\n\t\teditor.setValue( clear ? \"\" : view.getCellValue(cell.row, cell.column) );\n\n\t\tview.$handleSelection = function(a,b,st,en){ return pasteRange(st, en, a); };\n\t\treturn true;\n\t}\n\n\tfunction pasteRange(st, en, cell){\n\t\tlet sheet = \"\";\n\t\tif(editor._activeMath){\n\t\t\tconst activeSheet = view.getActiveSheet();\n\t\t\tif(editor._activeMath != activeSheet)\n\t\t\t\tsheet = editor.prepareSheet(activeSheet);\n\t\t}\n\n\t\tconst range = st == en ? sheet+st : `${sheet+st}:${sheet+en}`;\n\t\tconst updateRange = editor._update_range;\n\n\t\tif(updateRange && updateRange.pos == editor.getInputNode().selectionStart - updateRange.len)\n\t\t\teditor.setRange(range, true);\n\t\telse if(editor.expectOperator())\n\t\t\teditor.setRange(range);\n\t\telse\n\t\t\treturn endEdit(cell);\n\n\t\twebix.delay(() => editor.focus());\n\n\t\treturn false;\n\t}\n\n\tfunction endEdit(st){\n\t\tif (editor.isEnabled()){\n\t\t\teditor.showActiveSheet();\n\t\t\teditor.updateCellValue();\n\t\t\teditor.setValue(st ? view.getCellValue(st.row, st.column) : \"\");\n\t\t}\n\t\treturn true;\n\t}\n}\n","export function find(arr, func){\n\tvar result = findIndex(arr, func);\n\treturn arr[result];\n}\n\nexport function findIndex(arr, func){\n\tvar result = -1;\n\tfor(var i =0; result<0 && i < arr.length; i++){\n\t\tif(func(arr[i]))\n\t\t\tresult = i;\n\t}\n\treturn result;\n}\n\nexport function getDimension(data, rows, cols){\n\t//var [ row, column, value, style] = obj.data[i];\n\tfor (var i=0; i<data.length; i++){\n\t\tlet line = data[i];\n\t\tif (line[0]>rows) rows=line[0];\n\t\tif (line[1]>cols) cols=line[1];\n\t}\n\treturn [rows*1, cols*1];\n}","import * as arr from \"./helpers/array\";\n\nconst options = [\n\t\"rename-sheet\",\n\t\"remove-sheet\"\n];\n\nconst actionMap = {\n\t\"remove-sheet\": function(view){\n\t\tview.confirm({\n\t\t\ttext: webix.i18n.spreadsheet.labels[\"sheet-remove-confirm\"]\n\t\t}).then(()=>{\n\t\t\tremove(view, view._activeSheet);\n\t\t});\n\t},\n\t\"rename-sheet\": function(view){\n\t\tedit(view, view._activeSheet);\n\t},\n\t\"new-sheet\": function(view){\n\t\tadd(view);\n\t},\n\t\"copy-sheet\": function(view){\n\t\tcopy(view);\n\t}\n};\n\nexport function init(view){\n\tview.attachEvent(\"onComponentInit\", () => ready(view));\n}\n\nexport function defaultBottom(view){\n\tvar readonly = view.config.readonly;\n\tvar tabWidth = view.config.sheetTabWidth;\n\tvar toolbar =  {\n\t\tview: \"toolbar\",\n\t\tid: \"bottom-toolbar\",\n\t\tcss: \"webix_ssheet_bottom_toolbar webix_layout_toolbar\",\n\t\tpaddingY: 0,\n\t\theight: 34,\n\t\telements:[\n\t\t\t{\n\t\t\t\tview: \"button\", type:\"htmlbutton\", width: 34, id: \"add-sheet\",\n\t\t\t\tlabel: \"<span class='webix_ssheet_icon_add_sheet'></span>\",\n\t\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[\"add-sheet\"]||\"\", hidden:readonly\n\t\t\t},\n\t\t\t{\n\t\t\t\tid:\"sheets\",\n\t\t\t\tview:\"sheets\",\n\t\t\t\twidth: 5 * tabWidth,\n\t\t\t\teditable:!readonly,\n\t\t\t\teditaction: \"dblclick\",\n\t\t\t\teditor:\"text\",\n\t\t\t\teditValue:\"value\",\n\t\t\t\ttype:{\n\t\t\t\t\twidth: tabWidth,\n\t\t\t\t\theight: 32,\n\t\t\t\t\ttemplate: function(obj){\n\t\t\t\t\t\treturn \"<div>\"+obj.value+\"</div>\"+\n\t\t\t\t\t\t\t(!readonly?\"<div class='webix_input_icon wxi-menu-down webix_ssheet_sheet_arrow'></div>\":\"\");\n\t\t\t\t\t},\n\t\t\t\t\t//remove skin selection css on dnd\n\t\t\t\t\tcss:\"ssheet_order_sheets\"\n\t\t\t\t},\n\t\t\t\tonClick:{\n\t\t\t\t\twebix_ssheet_sheet_arrow: function(e, id){\n\t\t\t\t\t\tinitSheetMenu(view, e, id);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\ton:{\n\t\t\t\t\tonItemClick: function(id){\n\t\t\t\t\t\tif(id != view._activeSheet)\n\t\t\t\t\t\t\tview.showSheet(id);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tview: \"button\", type:\"htmlbutton\", width: 34, id: \"prev-sheet\", disabled:true, hidden:true,\n\t\t\t\tlabel: \"<span class='webix_icon wxi-menu-left'></span>\", batch:\"pager\",\n\t\t\t\tclick:function(){scrollSheets(view, -1);}\n\t\t\t},\n\t\t\t{\n\t\t\t\tview: \"button\", type:\"htmlbutton\", width: 34, id: \"next-sheet\", hidden:true,\n\t\t\t\tlabel: \"<span class='webix_icon wxi-menu-right'></span>\", batch:\"pager\",\n\t\t\t\tclick:function(){scrollSheets(view, 1);}\n\t\t\t}\n\t\t]\n\t};\n\n\tview.callEvent(\"onViewInit\", [\"bottom-toolbar\", toolbar]);\n\n\treturn toolbar;\n}\n\nfunction scrollSheets(view, direction){\n\tvar sheets = view.$$(\"sheets\");\n\tsheets.scrollTo(sheets.getScrollState().x+(direction*view.config.sheetTabWidth), 0);\n}\n\nfunction menuInit(view){\n\tvar data = [];\n\tfor(var i=0; i < options.length;i++)\n\t\tdata.push({id: options[i], value:webix.i18n.spreadsheet.menus[options[i]]||options[i]});\n\n\tvar menu =  {\n\t\tview: \"ssheet-suggest\",\n\t\tdata: data\n\t};\n\tview.callEvent(\"onViewInit\", [\"sheet-menu\", menu]);\n\treturn menu;\n}\n\nexport function reset(view, obj){\n\tlet tabs = view.$$(\"sheets\");\n\tif (tabs){\n\t\ttabs.clearAll();\n\t\tlet set = [];\n\t\tobj.sheets.forEach(function(sheet){\n\t\t\tset.push({id:sheet.name, value: sheet.name});\n\t\t});\n\t\ttabs.parse(set);\n\t}\n}\n\nfunction ready(view){\n\tprepare(view);\n\n\tif(view.$$(\"add-sheet\"))\n\t\tview.$$(\"add-sheet\").attachEvent(\"onItemClick\", function(){\n\t\t\tadd(view);\n\t\t});\n\n\tview.attachEvent(\"onAfterSheetShow\", (name) => selectSheet(view,name));\n\n\tview.attachEvent(\"onCommand\", function(command){\n\t\tif(actionMap[command.id])\n\t\t\tactionMap[command.id](this);\n\t});\n\n\tif(view.$$(\"sheets\")){\n\t\tview.$$(\"sheets\").data.attachEvent(\"onStoreUpdated\", () => changePagerVisability(view));\n\t\tview.$$(\"sheets\").attachEvent(\"onAfterScroll\", () => changePagerStatus(view));\n\t\tview.$$(\"sheets\").attachEvent(\"onAfterDrop\", (context) => dataOrder(view,context.start,context.index));\n\t\tview.$$(\"sheets\").attachEvent(\"onAfterEditStop\", (state) => rename(view,state.old,state.value));\n\t}\n}\n\nfunction initSheetMenu(view, e, id){\n\tif(!view.$sheetMenu){\n\t\tview.$sheetMenu = webix.ui(menuInit(view));\n\t\tview._destroy_with_me.push(view.$sheetMenu);\n\t\tview.$sheetMenu.attachEvent(\"onItemClick\", (id)=> callAction(view,id));\n\t}\n\n\tif(view.$sheetMenu.getItem(\"remove-sheet\"))\n\t\tif(view.$$(\"sheets\").count() == 1)\n\t\t\tview.$sheetMenu.disableItem(\"remove-sheet\");\n\t\telse\n\t\t\tview.$sheetMenu.enableItem(\"remove-sheet\");\n\tif(view.callEvent(\"onBeforeSheetMenu\", [id])){\n\t\tview.$sheetMenu.show(e);\n\t}\n}\n\nfunction changePagerStatus(view){\n\tconst sheets = view.$$(\"sheets\");\n\tconst scrollPos = sheets.getScrollState().x;\n\n\tif(scrollPos == 0){\n\t\tview.$$(\"prev-sheet\").disable();\n\t}\n\telse{\n\t\tview.$$(\"prev-sheet\").enable();\n\t\tvar tabWidth = view.config.sheetTabWidth;\n\t\tif(scrollPos == (sheets.count()-(sheets.config.width/tabWidth))*tabWidth){\n\t\t\tview.$$(\"next-sheet\").disable();\n\t\t\treturn;\n\t\t}\n\t}\n\tview.$$(\"next-sheet\").enable();\n}\n\nfunction changePagerVisability(view){\n\tvar toolbar = view.$$(\"bottom-toolbar\");\n\tvar sheets = view.$$(\"sheets\");\n\n\tif(sheets.count() <= (sheets.config.width/view.config.sheetTabWidth))\n\t\ttoolbar.showBatch(\"pager\", false);\n\telse\n\t\ttoolbar.showBatch(\"pager\");\n}\n\nfunction dataOrder(view, name, num){\n\tfor (let id in view._sheets) {\n\t\tif (view._sheets[id].name == name) {\n\t\t\tconst item = view._sheets.splice(id, 1);\n\t\t\tview._sheets.splice(num, 0, item[0]);\n\t\t\tbreak;\n\t\t}\n\t}\n}\n\nexport function add(view, content){\n\tvar index, name, newIndex;\n\n\tindex = arr.findIndex(view._sheets, x => x.name == view._activeSheet);\n\tnewIndex = index>-1?index+1:view._sheets.length;\n\tname = getNewTitle(view);\n\tcontent = content || {data:[]};\n\tview._sheets.splice(newIndex, 0, {\n\t\tname: name,\n\t\tcontent: content\n\t});\n\tview.$$(\"sheets\").add({id: name, value: name},newIndex);\n\tview.showSheet(name);\n\tview.callEvent(\"onSheetAdd\", [name]);\n\treturn name;\n}\n\nfunction getNewTitle(view){\n\tvar index = view._sheets.length+1;\n\twhile(getSheet(view, (webix.i18n.spreadsheet.labels.sheet+index)))\n\t\tindex++;\n\tvar name = webix.i18n.spreadsheet.labels.sheet+index;\n\treturn name;\n}\n\nfunction selectSheet(view,name){\n\tif(view.$$(\"sheets\")){\n\t\tview.$$(\"sheets\").select(name);\n\t\tview.$$(\"sheets\").showItem(name);\n\t}\n}\n\nexport function edit(view,name){\n\tview.$$(\"sheets\").edit(name);\n}\n\nexport function remove(view,name){\n\tvar index, newSheet;\n\tif(view._sheets.length >1){\n\t\tindex = arr.findIndex(view._sheets,x => x.name == name);\n\t\tview._sheets.splice(index,1);\n\t\tif(!view._sheets[index])\n\t\t\tindex = 0;\n\t\tnewSheet = \tview._sheets[index];\n\t\tview._activeSheet = null;\n\t\tif(view.$$(\"sheets\")){\n\t\t\tview.$$(\"sheets\").remove(name);\n\t\t\tview.$$(\"sheets\").refresh();\n\t\t}\n\t\tview.showSheet(newSheet.name);\n\t\tview.callEvent(\"onSheetRemove\", [name]);\n\t}\n}\n\nexport function rename(view,name,newName){\n\tif (name == newName) return;\n\n\t//correct sheet name\n\tvar i = 1;\n\twhile (!newName || getSheet(view, newName)){\n\t\tnewName = webix.i18n.spreadsheet.labels.sheet + i;\n\t\ti++;\n\t}\n\tnewName = newName.replace(/[*?:[\\]\\\\/]/g,\"\").substring(0, 31);\n\n\tvar sheet = getSheet(view, name);\n\tvar sheets = view.$$(\"sheets\");\n\n\tsheet.name = newName;\n\tif(view._activeSheet == name)\n\t\tview._activeSheet = newName;\n\n\tif(sheets){\n\t\tlet item = sheets.getItem(name);\n\t\titem.value = newName;\n\t\tsheets.data.changeId(name,newName);\n\t\tsheets.refresh(newName);\n\t}\n\n\tview.callEvent(\"onSheetRename\", [name, newName]);\n}\n\nexport function serialize(view, obj){\n\tgetSheet(view, view._activeSheet).content = obj;\n\treturn view._sheets;\n}\n\nexport function load(view, obj){\n\tobj = webix.isArray(obj)?{sheets:obj}:obj;\n\t\n\tif((obj.excel || !obj.sheets) && view._activeSheet){\n\t\t//loading into active sheet\n\t\tvar name = view._activeSheet;\n\t\tgetSheet(view, name).content = obj;\n\t\trefresh(view, obj);\n\t} else {\n\t\t//creating new set of sheets\n\t\tprepare(view, obj);\n\t}\n}\n\nexport function prepare(view, obj){\n\tif(!obj) obj = {data:[]}; \n\tif(!obj.sheets)\n\t\tobj = newSheet(obj);\n\t\n\tvar name = obj.sheets[0].name;\n\tview._activeSheet = \"\";\n\tview._sheets = obj.sheets;\n\treset(view, obj);\n\tshow(view, name);\n}\n\nexport function newSheet(obj){\n\treturn {\n\t\tsheets:[{\n\t\t\tname: webix.i18n.spreadsheet.labels.sheet + 1,\n\t\t\tcontent: obj\n\t\t}]\n\t};\n}\n\nexport function show(view,name){\n\tif (name == view._activeSheet) return;\n\n\tif(view.callEvent(\"onBeforeSheetShow\", [name])){\n\t\tif (view._activeSheet)\n\t\t\tgetSheet(view, view._activeSheet).content = view.serialize();\n\n\t\tview._activeSheet = name;\n\t\tvar obj = getSheet(view, name).content;\n\t\trefresh(view, obj);\n\n\t\tview.callEvent(\"onAfterSheetShow\", [name]);\n\t}\n}\n\nexport function getSheet(view, name){\n\treturn arr.find(view._sheets, x => x.name == name);\n}\n\nexport function eachSheet(view, callback){\n\tfor (var i=0; i<view._sheets.length; i++)\n\t\tcallback(view._sheets[i].name);\n}\n\nexport function getActive(view){\n\treturn view._activeSheet;\n}\n\nfunction refresh(view, obj){\n\tlet [rows, cols] = arr.getDimension(obj.data, view.config.rowCount, view.config.columnCount);\n\tview.callEvent(\"onReset\", []);\n\tif (rows != view.config.rowCount || cols != view.config.columnCount){\n\t\tview.config.rowCount = rows;\n\t\tview.config.columnCount = cols;\n\t\tview._resetTable();\n\t}\n\n\tview._loading_data = true;\n\tview.callEvent(\"onDataParse\", [obj]);\n\tview._loading_data = false;\n\tview._table.refresh();\n\tif(view.config.bottombar)\n\t\tview.$$(\"sheets\").refresh();\n}\n\nfunction copy(view){\n\tadd(view, view.serialize());\n}\n\nfunction callAction(view, id){\n\tif(!view.$sheetMenu.data.getMark(id, \"webix_disabled\"))\n\t\tactionMap[id](view);\n}\n\n","import \"../views/formlate\";\n\nexport class Dialog{\n\tconstructor(view){\n\t\tthis.view = view;\n\t}\n\t$init(){}\n\t$show(){}\n\t$hide(){}\n\topen(){\n\t\tif(!this.$dialog){\n\t\t\tthis.$dialog = webix.ui(this.$init());\n\t\t\tthis.view._destroy_with_me.push(this.$dialog);\n\t\t\tthis.$dialog.attachEvent(\"onHide\", ()=>this.$hide());\n\t\t}\n\n\t\tvar form = this.$dialog.getBody();\n\t\tthis.$dialog.show();\n\t\tif (this.$show(this.$dialog, form) === false)\n\t\t\tthis.close();\n\t}\n\tclose(){\n\t\twebix.UIManager.setFocus(this.view);\n\t\tthis.$dialog.hide();\n\t}\n}","export function image(url){\n\treturn `=IMAGE(\"${url}\")`;\n}\n\nexport function chart(config){\n\tlet result = `=SPARKLINE(${config.range},\"${config.type}\"`;\n\tif (config.type === \"bar\")\n\t\tresult += `,\"${config.color}\",\"${config.negativeColor}\"`;\n\telse if(config.color)\n\t\tresult += `,\"${config.color}\"`;\n\treturn result+\")\";\n\n}\n\nexport function parseImage(value){\n\tif (value && value.indexOf(\"=IMAGE(\") === 0)\n\t\treturn {\n\t\t\turl: unescape(value.substr(7, value.length-8))\n\t\t};\n}\n\nexport function parseChart(value){\n\tif (value && value.indexOf(\"=SPARKLINE(\") === 0){\n\t\tlet text = value.substr(11, value.length-12).split(\",\");\n\t\treturn {\n\t\t\trange: text[0],\n\t\t\ttype: unescape(text[1]),\n\t\t\tcolor: unescape(text[2]),\n\t\t\tnegativeColor: unescape(text[3])\n\t\t};\n\t}\n}\n\nfunction unescape(text){\n\tif (!text) return \"\";\n\n\ttext = text.trim();\n\tif (text[0] === \"\\\"\") \n\t\ttext = text.substr(1);\n\tif (text[text.length-1] === \"\\\"\")\n\t\ttext = text.substr(0, text.length-1);\n\treturn text;\n}","import {Dialog} from \"./common\";\nimport {parseImage} from \"../math/writer\";\n\nexport const action = \"add-image\";\n\nexport class DialogBox extends Dialog{\n\t$show(box, form){\n\t\tthis.cell = this.view.getSelectedId();\n\t\tif(!this.cell)\n\t\t\treturn false;\n\n\t\tform.elements.preview.setHTML(\"\");\n\t\tform.elements.url.setValue(\"\");\n\n\t\t//sync state of dialog to data with  the selected cell\n\t\tlet value = this.view.getCellValue(this.cell.row, this.cell.column);\n\t\tlet data = parseImage(value);\n\t\tif (data && data.url)\n\t\t\tform.elements.url.setValue(data.url);\n\t\n\t\tform.elements.url.focus();\n\t}\n\t$init(){\n\n\t\tvar save = this.view.config.save;\n\t\tvar server = (save && save.images) || null;\n\t\t\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\thead: webix.i18n.spreadsheet.labels[\"image-title\"],\n\t\t\tmove: true,\n\t\t\tposition: \"center\",\n\t\t\tbody:{\n\t\t\t\tview:\"form\",\n\t\t\t\telements:[\n\t\t\t\t\t{ view:\"text\", name:\"url\",  placeholder:webix.i18n.spreadsheet.labels[\"image-url\"], on:{\n\t\t\t\t\t\t\"onChange\": showPreview\n\t\t\t\t\t}},\n\t\t\t\t\t{ view:\"label\", label:webix.i18n.spreadsheet.labels[\"image-or\"], align: \"center\"},\n\t\t\t\t\t{ view:\"uploader\", label:webix.i18n.spreadsheet.labels[\"image-upload\"], upload:server, on:{\n\t\t\t\t\t\t\"onBeforeFileAdd\": startLoad,\n\t\t\t\t\t\t\"onFileUpload\": endLoad\n\t\t\t\t\t}},\n\t\t\t\t\t{ view:\"formlate\", name:\"preview\", borderless: true, css: \"webix_ssheet_preview\", template:\"\", height:50 }\n\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => okClick(this),\n\t\t\t\tonHideClick: () => this.close(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n}\n\n\nfunction startLoad(file){ \n\tif (!this.config.upload){\n\t\tvar reader = new FileReader();\n\t\treader.onload = (e) => this.getFormView().elements.url.setValue(e.target.result);\n\t\treader.readAsDataURL(file.file);\n\t\treturn false;\n\t} else\n\t\tthis.getFormView().elements.preview.setHTML(\"\");\n}\n\nfunction endLoad(item, response){\n\tthis.getFormView().elements.url.setValue(response.imageURL);\n}\n\nfunction okClick(dialog){\n\tvar cell = dialog.cell;\n\tvar image = fillUrl(dialog.$dialog.getBody().elements.url.getValue());\n\tdialog.view.addImage(cell.row, cell.column, image);\n\tdialog.close();\n}\n\nfunction showPreview(image){\n\tif (image){\n\t\timage = webix.template.escape(fillUrl(image));\n\t\tthis.getFormView().elements.preview.setHTML(\"<img class='webix_ssheet_cimage' src='\"+image+\"'></img>\");\n\t}\n}\n\nfunction fillUrl(url){\n\tif (!/^[/]|((https?:\\/|data:image)\\/)/i.test(url))\n\t\turl = \"http://\" + url;\n\treturn url;\n}","import * as parser \t\t\tfrom \"./parser\";\n\n//convert math string to the js function\nlet actives = {};\nlet passives = {};\nexport function _parse(value, core, passive){\n\tvar struct = parser.parse(value, core, passive);\n\tif(passive && !passives[passive])\n\t\tpassives[passive] = {};\n\tvar cache = passive ? passives[passive] : actives;\n\tstruct.handler = cache[value] = cache[value] || _build_function(struct.code);\n\treturn struct;\n}\n\nexport function clearMathCache(activeOnly){\n\tactives = {};\n\tif(!activeOnly)\n\t\tpassives = {};\n}\n\nfunction error_function(){\n\treturn webix.i18n.spreadsheet.table[\"math-error\"];\n}\nfunction _build_function(value){\n\ttry{\n\t\treturn new Function(value);\n\t} catch(e){\n\t\treturn error_function;\n\t}\n}","import * as nms from \"../helpers/column_names\";\nimport {split} from \"../math/parser\";\n\nexport function updateMath(formula, action, area){\n\tconst stack = split(formula);\n\tconst max = stack.length;\n\tconst start = area ? area.start : null;\n\tconst end = area ? area.end : null;\n\tconst {count, id} = action;\n\n\tfor (let i = 1; i < max; i+=2) {\n\t\tlet [row, column, flags] = stack[i];\n\n\t\tconst isRowFix = flags & 1;\n\t\tconst isColumnFix = flags & 2;\n\n\t\t// for cut operations we need to check whether referenced values are inside cut block. if so - update them.\n\t\tif (id == \"move\" && (!action.cut || (row >= start.row && row <= end.row && column >= start.column && column <= end.column))){\n\t\t\tcolumn += isColumnFix ? 0 : action.column;\n\t\t\trow += isRowFix ? 0 : action.row;\n\t\t}\n\t\telse if (id == \"row\" && action.start <= row){\n\t\t\tif(count < 0 && action.start + Math.abs(count) > row){\n\t\t\t\tstack[i] = \"#REF!\";\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\trow += isRowFix ? 0 : count;\n\t\t}\n\t\telse if (id == \"column\" && action.start <= column){\n\t\t\tif(count < 0 && action.start + Math.abs(count) > column){\n\t\t\t\tstack[i] = \"#REF!\";\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tcolumn += isColumnFix ? 0 : count;\n\t\t}\n\n\t\tif (column <= 0 || row <= 0)\n\t\t\tstack[i] = \"#REF!\";\n\t\telse\n\t\t\tstack[i] = (isColumnFix?\"$\":\"\") + nms.encode[column] + (isRowFix?\"$\":\"\") + row;\n\t}\n\n\treturn stack.join(\"\");\n}\n\nexport function updateSheetNames(formula, oldName, newName, extra){\n\tvar stack = split(formula, true);\n\tfor(var i = 0; i < stack.length; i++){\n\t\tif(webix.isArray(stack[i])){\n\t\t\tvar thisSheet = stack[i][0] === oldName;\n\t\t\tif(!extra.multiSheet && thisSheet)\n\t\t\t\textra.multiSheet = true;\n\t\t\tvar sheet = thisSheet ? newName : stack[i][0];\n\t\t\tstack[i] = \"'\"+sheet+\"'!\"+stack[i][1];\n\t\t}\n\t}\n\treturn stack.join(\"\");\n}","//TODO\n// ### column deleting | adding\n// recalculate positions\n\n// ### copy paste between sheets\n// force sheet name\n\n// ### triggers\n// a <- p <- a\n// register triggers from passive sheet\n\n// ### sheet renaming\n// adjust math on sheet rename\n// adjust ranges on sheet rename\n\nimport {getActive, getSheet} from \"../sheets\";\nimport {range} from \"../helpers/column_names\";\nimport {clearMathCache} from \"./cache\";\nimport {updateSheetNames} from \"./updater\";\n\n\nexport function init(view, core, helpers){\n\tview.attachEvent(\"onBeforeSheetShow\", function(){\n\t\tdelete view._mathSheetCache[getActive(view)];\n\t});\n\tview.attachEvent(\"onSheetRename\", function(name, newName){\n\t\tview._sheets.forEach((sheet)=>{\n\t\t\tlet extra = {multiSheet:false};\n\t\t\tconst edit = [\"data\", \"editors\", \"conditions\", \"ranges\"];\n\t\t\tedit.forEach((param)=>{\n\t\t\t\tif(sheet.content[param])\n\t\t\t\t\tsheet.content[param].forEach((value)=>{\n\t\t\t\t\t\tswitch (param) {\n\t\t\t\t\t\t\tcase \"data\":\n\t\t\t\t\t\t\t\tif(value[2][0] === \"=\")\n\t\t\t\t\t\t\t\t\tvalue[2] = updateSheetNames(value[2], name, newName, extra);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase \"editors\": {\n\t\t\t\t\t\t\t\tconst options = value[2].options;\n\t\t\t\t\t\t\t\tif(options){\n\t\t\t\t\t\t\t\t\tif(typeof options == \"string\")\n\t\t\t\t\t\t\t\t\t\tvalue[2].options = updateSheetNames(options, name, newName, extra);\n\t\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t\t\tfor (let i = 0; i < options.length; i++){\n\t\t\t\t\t\t\t\t\t\t\tconst option = typeof options[i] == \"string\" ? options[i] : options[i].value;\n\t\t\t\t\t\t\t\t\t\t\toptions[i] = updateSheetNames(option, name, newName, extra);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tcase \"conditions\":\n\t\t\t\t\t\t\t\tif(value[3][0] === \"=\")\n\t\t\t\t\t\t\t\t\tvalue[3] = updateSheetNames(value[3], name, newName, extra);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase \"ranges\":\n\t\t\t\t\t\t\t\tvalue[1] = updateSheetNames(value[1], name, newName, extra);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t});\n\t\t\tif(extra.multiSheet === true){\n\t\t\t\tdelete view._mathSheetCache[sheet.name];\n\t\t\t\tgetAccessor(view, sheet.name);\n\t\t\t\tclearMathCache();\n\t\t\t}\n\t\t});\n\t\tdelete view._mathSheetCache[name];\n\t});\n\tview.attachEvent(\"onSheetRemove\", function(name){\n\t\tdelete view._mathSheetCache[name];\n\t});\n\n\tview._mathSheetCore = core;\n\tview._mathSheetHelpers = helpers;\n}\n\nexport function getAccessor(view, name){\n\tconst cache = view._mathSheetCache;\n\n\tif (!cache[name]){\n\t\tconst helpers = (!name || name == getActive(view)) ? activeAccessor(view) : passiveAccessor(view, name);\n\n\t\t//invalid sheet name\n\t\tif(!helpers)\n\t\t\treturn;\n\n\t\tconst temp = cache[name] = SheetAccessor(helpers);\n\n\t\ttemp.init();\n\t}\n\treturn cache[name];\n}\n\nfunction SheetAccessor(helpers){\n\treturn {\n\t\tinit:function(){\n\t\t\thelpers.init();\n\t\t},\n\t\tgetRangeCode(name){\n\t\t\treturn helpers.getRangeCode(name);\n\t\t},\n\t\tgetValue(r,c){\n\t\t\tvar val = helpers.getCell(r,c);\n\t\t\tvar test = val*1;\n\t\t\tif (!isNaN(test)) return test;\n\t\t\treturn val?val:\"\";\n\t\t},\n\t\tgetRangeValue(name){\n\t\t\tvar code = this.getRangeCode(name) || name;\n\t\t\tif (code.indexOf(\":\") == -1) return [];\n\t\t\tvar pos = range(code);\n\t\t\treturn this.getRange.apply(this, pos);\n\t\t},\n\t\tgetRange(r1,c1,r2,c2){\n\t\t\tconst set = helpers.getRange(r1,c1,r2,c2);\n\t\t\tfor (let i = set.length-1; i>=0; i--){\n\t\t\t\tlet val = set[i];\n\t\t\t\tlet test = val !== \"\" ? val * 1 : \"\";\n\t\t\t\tset[i] = isNaN(test) ? (val?val:\"\") : test;\n\t\t\t}\n\t\t\treturn set;\n\t\t}\n\t};\n}\n\nfunction activeAccessor(view){\n\treturn {\n\t\tinit:function(){\n\n\t\t},\n\t\tgetRangeCode(name){\n\t\t\treturn view.ranges.getCode(name);\n\t\t},\n\t\tgetRow:function(r){\n\t\t\treturn view.getRow(r);\n\t\t},\n\t\tgetCell:function(r,c){\n\t\t\treturn view.getRow(r)[c];\n\t\t},\n\t\tgetRange:function(r1,c1,r2,c2){\n\t\t\tvar set = [];\n\t\t\tfor (var i = r1; i <= r2; i++){\n\t\t\t\tvar item = view.getRow(i);\n\t\t\t\tfor (var j = c1; j <= c2; j++)\n\t\t\t\t\tset.push(item[j]);\n\t\t\t}\n\t\t\treturn set;\n\t\t}\n\t};\n}\n\nfunction passiveAccessor(view, name){\n\tconst sheet = getSheet(view, name);\n\tif(!sheet)\n\t\treturn;\n\n\tconst page = sheet.content;\n\tconst table = [];\n\tconst formulas = [];\n\n\tconst ranges = [];\n\n\treturn {\n\t\tinit:function(){\n\t\t\tif (page.ranges){\n\t\t\t\tfor (var i = 0; i < page.ranges.length; i++) {\n\t\t\t\t\tvar line = page.ranges[i];\n\t\t\t\t\tranges[line[0]] = line[1];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (page.data){\n\t\t\t\tfor (let i = 0; i < page.data.length; i++) {\n\t\t\t\t\t//expand data structure\n\t\t\t\t\tlet [row, column, value] = page.data[i];\n\t\t\t\t\tif (!table[row])\n\t\t\t\t\t\ttable[row] = [];\n\t\t\t\t\ttable[row][column] = value;\n\n\t\t\t\t\tif (value[0] === \"=\"){\n\t\t\t\t\t\t//for math cells, store the code\n\t\t\t\t\t\tlet math = view._mathSheetHelpers.parse(value, view._mathSheetCore, name);\n\t\t\t\t\t\ttable[row][column] = math.handler;\n\n\t\t\t\t\t\t//store list of cross-sheet formulas\n\t\t\t\t\t\tfor (var j=0; j<math.triggers.length; j++){\n\t\t\t\t\t\t\tif (math.triggers[j][5]){\n\t\t\t\t\t\t\t\tformulas.push(page.data[i]);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tgetRangeCode(name){\n\t\t\treturn ranges[name];\n\t\t},\n\t\tgetRow(i){\n\t\t\treturn table[i] || [];\n\t\t},\n\t\tgetCell(i, j){\n\t\t\tvar value = this.getRow(i)[j];\n\t\t\tif (typeof value === \"function\")\n\t\t\t\treturn view._mathSheetHelpers.execute(value, view._mathSheetCore);\n\n\t\t\treturn value;\n\t\t},\n\t\tgetRange:function(r1,c1,r2,c2){\n\t\t\tvar set = [];\n\t\t\tfor (var i = r1; i <= r2; i++)\n\t\t\t\tfor (var j = c1; j <= c2; j++)\n\t\t\t\t\tset.push(this.getCell(i,j));\n\t\t\treturn set;\n\t\t}\n\t};\n}","import {range} from \"../helpers/column_names\";\nimport {getAccessor} from \"./sheet\";\nimport {clearMathCache} from \"./cache\";\n\nfunction nullFilter(){ \n\tconst locale = webix.i18n.spreadsheet.labels;\n\treturn { id:\"$empty\", value:\"\", $value:\"<span class='webix_ssheet_empty'>\"+locale[\"dropdown-empty\"]+\"</span>\" };\n}\n\nexport function rangeValue(view, text, extra){\n\tlet values = [];\n\tif (typeof text == \"string\"){\n\t\tconst pos = range(text, view);\n\t\tif(pos){\n\t\t\tconst page = getAccessor(view, pos[4]);\n\t\t\tvalues = page ? page.getRange.apply(page, pos) : [];\n\t\t}\n\t}\n\telse\n\t\tvalues = webix.copy(text);\n\n\tif (extra){\n\t\tif (extra.unique){\n\t\t\tconst test = {};\n\t\t\tfor (let i=values.length-1; i>=0; i--){\n\t\t\t\tif (test[values[i]])\n\t\t\t\t\tvalues.splice(i, 1);\n\t\t\t\telse\n\t\t\t\t\ttest[values[i]] = true;\n\t\t\t}\n\t\t}\n\n\t\tif (extra.filter){\n\t\t\tfor (let i=0; i<values.length; i++)\n\t\t\t\tvalues[i] = String(values[i]);\n\t\t}\n\t\tif (extra.order) values.sort();\n\n\t\tconst empty = values.indexOf(\"\");\n\t\tif (empty > -1){\n\t\t\tvalues.splice(empty, 1);\n\t\t\tif (extra.filter)\n\t\t\t\tvalues.unshift( nullFilter() );\n\t\t}\n\n\t\tif (extra.empty)\n\t\t\tvalues.unshift({ id:\"$empty\", $empty:true, value:\"\" });\n\t}\n\treturn values;\n}\n\nexport class Ranges{\n\tconstructor(view){\n\t\tthis._master = view;\n\t\tthis._ranges = {};\n\t}\n\tclear(){\n\t\tthis._ranges = {};\n\t}\n\tadd(name, text){\n\t\tthis._master.callEvent(\"onAfterRangeSet\", [name, text]);\n\t\tthis._ranges[name] = text;\n\n\t\tclearMathCache(true);\n\t\tthis._master.callEvent(\"onMathRefresh\", []);\n\t}\n\tgetCode(name, sheet){\n\t\tif (sheet){\n\t\t\tconst accessor = getAccessor(this._master, sheet);\n\t\t\treturn accessor ? accessor.getRangeCode(name) : null;\n\t\t}\n\n\t\treturn this._ranges[name];\n\t}\n\tremove(name){\n\t\tdelete this._ranges[name];\n\n\t\tclearMathCache(true);\n\t\tthis._master.callEvent(\"onMathRefresh\", []);\n\t}\n\tgetRanges(){\n\t\tvar data = [];\n\t\tfor(var name in this._ranges)\n\t\t\tdata.push({ name, range:this._ranges[name] });\n\n\t\treturn data;\n\t}\n\tparse(data){\n\t\tif (!data) return;\n\n\t\tlet i = data.length;\n\t\twhile(i--){\n\t\t\tvar c = data[i];\n\t\t\tthis._ranges[c[0]] = c[1];\n\t\t}\n\t}\n\tserialize(){\n\t\tvar name, data = [];\n\t\tfor( name in this._ranges)\n\t\t\tdata.push([name,this._ranges[name]]);\n\t\treturn data;\n\t}\n}\n","import {Dialog} from \"./common\";\nimport {rangeValue} from \"../math/ranges\";\nimport {range} from \"../helpers/column_names\";\nimport {parseChart} from \"../math/writer\";\n\nexport const action = \"add-sparkline\";\n\nvar types = [\n\t{id:\"line\", value:\"Line\"},\n\t{id:\"spline\", value:\"Spline\"},\n\t{id:\"splineArea\", value:\"Spline Area\"},\n\t{id:\"area\", value:\"Area\"},\n\t{id:\"bar\", value:\"Bar\"},\n\t{id:\"pie\", value:\"Pie\"}\n];\n\nexport class DialogBox extends Dialog{\n\t$show(box, form){\n\t\tthis.cell = this.view.getSelectedId();\n\t\tif(!this.cell)\n\t\t\treturn false;\n\n\t\tvar els = form.elements;\n\t\tthis.view.$handleSelection = function(st, end, a, b){\n\t\t\tels.range.setValue(a+\":\"+b);\n\t\t\treturn false;\n\t\t};\n\n\t\tels.range.setValue(\"\");\n\n\t\t//sync state of dialog to data with  the selected cell\n\t\tlet value = this.view.getCellValue(this.cell.row, this.cell.column);\n\t\tlet data = parseChart(value);\n\t\tif (data){\n\t\t\tform.blockEvent();\n\t\t\tels.type.setValue(data.type);\n\t\t\tels.range.setValue(data.range);\n\t\t\tif (data.color){\n\t\t\t\tels.color_def.setValue(data.color);\n\t\t\t\tels.color_pos.setValue(data.color);\t\t\n\t\t\t}\n\t\t\tif (data.negativeColor)\n\t\t\t\tels.color_neg.setValue(data.negativeColor);\n\t\t\tform.unblockEvent();\n\t\t\trenderPreview(this);\n\t\t}\t\n\n\t\tels.range.focus();\n\t}\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t}\n\t$init(){\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\thead:webix.i18n.spreadsheet.labels[\"sparkline-title\"],\n\t\t\tmove: true,\n\t\t\tposition: \"center\",\n\t\t\tbody:{\n\t\t\t\tview:\"form\", id: \"form\", visibleBatch:1, on:{ onChange : ()=> renderPreview(this) },  elements:[\n\t\t\t\t\t{view: \"richselect\", name:\"type\", label:webix.i18n.spreadsheet.labels[\"sparkline-type\"], value:\"line\", labelPosition:\"left\", suggest:{\n\t\t\t\t\t\tview:  \"ssheet-form-suggest\",\n\t\t\t\t\t\tdata:types\n\t\t\t\t\t}, on:{\n\t\t\t\t\t\t\"onChange\": typesChangeHandler\n\t\t\t\t\t}},\n\t\t\t\t\t{ view:\"text\", label:webix.i18n.spreadsheet.labels[\"sparkline-range\"], name:\"range\"},\n\t\t\t\t\t{ view:\"ssheet-colorpicker\", label:webix.i18n.spreadsheet.labels[\"sparkline-color\"], name:\"color_def\", id:\"add_sparkline_color\", value:\"#6666FF\", batch:\"1\"},\n\t\t\t\t\t{ view:\"ssheet-colorpicker\", label:webix.i18n.spreadsheet.labels[\"sparkline-positive\"], name:\"color_pos\", value:\"#6666FF\", batch:\"2\"},\n\t\t\t\t\t{ view:\"ssheet-colorpicker\", label:webix.i18n.spreadsheet.labels[\"sparkline-negative\"], name:\"color_neg\", value:\"#FF6666\", batch:\"2\"},\n\t\t\t\t\t{ view:\"formlate\", name:\"preview\", borderless:true, css:\"webix_ssheet_preview\", height:50 }\n\t\t\t\t]\n\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => okClick(this),\n\t\t\t\tonHideClick: () => this.close(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n\tcheckRange(text){\n\t\tif(text && range(text, this.view))\n\t\t\treturn true;\n\t\tthis.view.alert({text:webix.i18n.spreadsheet.labels[\"error-range\"]});\n\t}\n}\n\nfunction renderPreview(dialog){\n\tvar form = dialog.$dialog.getBody();\n\tvar data = form.getValues();\n\n\tif (data.range && dialog.checkRange(data.range)){\n\t\tlet i,\n\t\t\tvalues = rangeValue(dialog.view, data.range),\n\t\t\tconfig = sparkConfig(form);\n\t\tfor(i =0 ; i < values.length; i++)\n\t\t\tvalues[i] = values[i]||0;\n\t\tform.elements.preview.setValue(webix.Sparklines.getTemplate(config)(values, { width:200, height: 40 }));\n\t}\n}\n\nfunction sparkConfig(form, config){\n\tvar data = form.getValues();\n\tconfig = config || { type: data.type  };\n\tif (data.type === \"bar\"){\n\t\tconfig.color = data.color_pos;\n\t\tconfig.negativeColor = data.color_neg;\n\t}\n\telse if(form.elements.color_def.isVisible())\n\t\tconfig.color = data.color_def;\n\n\treturn config;\n}\n\nfunction okClick(dialog){\n\tvar form = dialog.$dialog.getBody();\n\tvar config = sparkConfig(form, form.getValues());\n\tif (dialog.checkRange(config.range)){\n\t\tdialog.view.addSparkline(dialog.cell.row, dialog.cell.column, config);\n\t\tdialog.close();\n\t}\n}\n\n\n\n\nfunction typesChangeHandler(type){\n\tvar form = this.getFormView();\n\tswitch(type){\n\t\tcase \"pie\":\n\t\t\tform.showBatch(3);\n\t\t\tbreak;\n\t\tcase \"bar\":\n\t\t\tform.showBatch(2);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tform.showBatch(1);\n\t}\n}","import {Dialog} from \"./common\";\nimport {isRange, toSheetRange} from \"../helpers/column_names\";\n\nexport const action = \"add-range\";\n\nexport class DialogBox extends Dialog{\n\t$show(box){\n\t\tvar table = box.$$(\"table\");\n\t\tvar form = box.$$(\"form\");\n\t\tvar sheet = \"\";// this.view.getActiveSheet(); ranges are per-sheet by default\n\n\t\tform.clear();\n\t\tform.clearValidation();\n\t\tform.elements.name.focus();\n\t\tform.elements.range.setValue(this.view.getSelectedRange());\n\n\t\ttable.clearAll();\n\t\ttable.parse( this.view.ranges.getRanges() );\n\n\t\tthis.view.$handleSelection = function(st, end, a, b){\n\t\t\tform.elements.range.setValue(toSheetRange(a,b,sheet));\n\t\t\treturn false;\n\t\t};\n\t}\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t}\n\tsaveClick(){\n\t\tconst form = this.$dialog.$$(\"form\");\n\t\tconst data = form.getValues();\n\n\t\tconst sheets = data.range.indexOf(\"!\");\n\t\tdata.range = data.range.substr(0, sheets+1)+data.range.substr(sheets+1).toUpperCase();\n\t\tdata.name = data.name.toUpperCase();\n\n\t\tform.setValues(data);\n\n\t\tif (form.validate()){\n\t\t\tlet table = this.$dialog.$$(\"table\");\n\n\t\t\tif (data.id && table.exists(data.id))\n\t\t\t\ttable.updateItem(data.id, data);\n\t\t\telse\n\t\t\t\ttable.add(data);\n\n\t\t\tthis.view.ranges.add(data.name, data.range);\n\t\t\tform.clear();\n\t\t}\n\t}\n\tremoveRange(id){\n\t\tthis.view.confirm({\n\t\t\ttext: webix.i18n.spreadsheet.labels[\"range-remove-confirm\"]\n\t\t}).then(()=>{\n\t\t\tlet table = this.$dialog.$$(\"table\");\n\t\t\tthis.view.ranges.remove(table.getItem(id).name);\n\t\t\ttable.remove(id);\n\t\t});\n\t}\n\teditRange(id){\n\t\tvar form = this.$dialog.$$(\"form\");\n\t\tform.clearValidation();\n\t\tform.setValues(this.$dialog.$$(\"table\").getItem(id));\n\t}\n\t$init(){\n\t\tvar theform = {\n\t\t\ttype: \"clean\",\n\t\t\tcols:[\n\t\t\t\t{ view: \"ssheet-dialog-table\", id: \"table\", borderless:true, columns:[\n\t\t\t\t\t{ id:\"name\", header:webix.i18n.spreadsheet.labels[\"range-name\"], width: 120 },\n\t\t\t\t\t{ id:\"range\", header:webix.i18n.spreadsheet.labels[\"range-cells\"], width: 120 },\n\t\t\t\t\t{ template:\"<div class='webix_icon wxi-pencil'></div>\", width:40 },\n\t\t\t\t\t{ template:\"<div class='webix_icon wxi-trash'></div>\", width:40 }\n\t\t\t\t],\n\t\t\t\tautowidth:true, height: 150,\n\t\t\t\tonClick:{\n\t\t\t\t\t\"wxi-trash\":(ev, id) => this.removeRange(id),\n\t\t\t\t\t\"wxi-pencil\":(ev, id) => this.editRange(id)\n\t\t\t\t}},\n\t\t\t\t{ width: 250, view: \"form\", id:\"form\",\n\t\t\t\t\trules:{\n\t\t\t\t\t\tname:(value) => { \n\t\t\t\t\t\t\tlet correct = /^[A-Za-z]+$/.test(value);\n\t\t\t\t\t\t\tlet table = this.$dialog.$$(\"table\");\n\t\t\t\t\t\t\tlet data = this.$dialog.$$(\"form\").getValues();\n\n\t\t\t\t\t\t\tlet unique = true;\n\t\t\t\t\t\t\ttable.eachRow(function(id){\n\t\t\t\t\t\t\t\tlet obj = this.getItem(id);\n\t\t\t\t\t\t\t\tif (obj.name == value && obj.id != data.id)\n\t\t\t\t\t\t\t\t\tunique = false; \n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\treturn correct && unique; \n\t\t\t\t\t\t},\n\t\t\t\t\t\trange:isRange\n\t\t\t\t\t},\n\t\t\t\t\telementsConfig:{\n\t\t\t\t\t\tlabelWidth: 70\n\t\t\t\t\t},\n\t\t\t\t\telements:[\n\t\t\t\t\t\t{ view: \"text\", name:\"name\", gravity:1, label: webix.i18n.spreadsheet.labels[\"range-name\"]},\n\t\t\t\t\t\t{ view: \"text\", name:\"range\", gravity:1, label: webix.i18n.spreadsheet.labels[\"range-cells\"]},\n\t\t\t\t\t\t{ cols:[\n\t\t\t\t\t\t\t{},\n\t\t\t\t\t\t\t{ view:\"button\", value:\"Save\", click: () => this.saveClick() }\n\t\t\t\t\t\t]}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t]\n\t\t};\n\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\tmove:true,\n\t\t\thead: webix.i18n.spreadsheet.labels[\"range-title\"],\n\t\t\tbuttons: false,\n\t\t\tautoheight: true,\n\t\t\twidth: 610,\n\t\t\tposition: \"center\",\n\t\t\tbody: theform,\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => this.close(),\n\t\t\t\tonHideClick: () => this.close(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n}\n\n","import {Dialog} from \"./common\";\nimport {range} from \"../helpers/column_names\";\nimport group from \"../operations/undo_group\";\n\nexport const action = \"add-dropdown\";\n\nexport class DialogBox extends Dialog{\n\t$show(){\n\t\tlet form = this.$dialog.$$(\"form\");\n\t\tthis.cell = this.view.getSelectedId(true);\n\t\tif (!this.cell.length)\n\t\t\treturn false;\n\n\t\tform.clear();\n\n\t\t//restore previosly selected range\n\t\tlet value = this.view.getCellEditor(this.cell[0].row, this.cell[0].column);\n\t\tif (value && value.options)\n\t\t\tform.elements.range.setValue(value.options);\n\n\t\tthis.view.$handleSelection = function(st, end, a, b){\n\t\t\tform.elements.range.setValue(a+\":\"+b);\n\t\t\treturn false;\n\t\t};\n\n\t\tform.elements.range.focus();\n\t}\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t}\n\t$init(){\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\tposition:\"center\",\n\t\t\thead:webix.i18n.spreadsheet.labels[\"dropdown-title\"],\n\t\t\tmove: true,\n\t\t\tbody:{\n\t\t\t\tview:\"form\", id:\"form\", rows:[\n\t\t\t\t\t{ view:\"text\", label:webix.i18n.spreadsheet.labels[\"dropdown-range\"], name:\"range\" }\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => this.okClick(),\n\t\t\t\tonHideClick: () => this.close(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n\tokClick(){\n\t\tvar values = this.$dialog.$$(\"form\").elements.range.getValue();\n\n\t\tif (values){\n\t\t\tif(!range(values, this.view))\n\t\t\t\tthis.view.alert({text:webix.i18n.spreadsheet.labels[\"error-range\"]});\n\t\t\telse{\n\t\t\t\tgroup.set(function(){\n\t\t\t\t\tfor (var i = 0; i < this.cell.length; i++)\n\t\t\t\t\t\tthis.view.setCellEditor(this.cell[i].row, this.cell[i].column, { editor:\"richselect\", options:values});\n\t\t\t\t}, this);\n\t\t\t\tthis.close();\n\t\t\t}\n\t\t}\n\t\telse\n\t\t\tthis.close();\n\t}\n}","import {Dialog} from \"./common\";\n\nexport const action = \"start-filter\";\n\nexport class DialogBox extends Dialog{\n\topen(action){\n\t\tthis.cell = action.cell;\n\t\tthis.$mode = action.mode;\n\t\tthis.$filter = action.filter;\n\n\t\t// cell not provided\n\t\tif (!this.cell || \n\t\t\t// cell is locked\n\t\t\t(this.view.isCellLocked(this.cell.row, this.cell.column))){\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!this.$dialog){\n\t\t\tthis.$dialog = webix.ui(this.$init());\n\t\t\tthis.view._destroy_with_me.push(this.$dialog);\n\t\t\tthis.$dialog.attachEvent(\"onHide\", () => this.$hide());\n\n\t\t\tconst table = this.view.$$(\"cells\");\n\t\t\ttable.attachEvent(\"onScrollY\", () => this.syncScroll());\n\t\t\ttable.attachEvent(\"onScrollX\", () => this.syncScroll());\n\t\t}\n\n\t\tif (this.$show(this.$filter.value, action.options) === false)\n\t\t\treturn this.close();\n\t\tthis.$dialog.show( this._getTargetNode() );\n\t}\n\t_getTargetNode(){\n\t\tconst table = this.view.$$(\"cells\");\n\t\tconst span = table.getSpan(this.cell.row, this.cell.column);\n\t\treturn span ? table.getSpanNode(this.cell) : table.getItemNode(this.cell);\n\t}\n\t$show(value, options){\n\t\tconst list = this.getList();\n\t\tconst filter = this.getFilter();\n\n\t\tif (filter.config.mode !== this.$mode){\n\t\t\tfilter.define(\"conditions\", this.getConditions(this.$mode));\n\t\t\tfilter.define(\"mode\", this.$mode);\n\t\t}\n\n\t\t// if the filter mode for the current column has been changed - reset the value\n\t\tif (value && value.$mode !== this.$mode)\n\t\t\tvalue = \"\";\n\n\t\tlist.clearAll();\n\t\tlist.data.importData(options);\n\n\t\tfilter.setValue( webix.copy(value||{}) );\n\t}\n\t$init(){\n\t\tconst locale = webix.i18n.spreadsheet.labels;\n\t\treturn {\n\t\t\tview:\"popup\",\n\t\t\tcss:\"ssheet_filter\",\n\t\t\tpadding:7,\n\t\t\trelative:\"right\",\n\t\t\tbody:{\n\t\t\t\tmargin:4,\n\t\t\t\trows:[\n\t\t\t\t\t{\n\t\t\t\t\t\tview:\"filter\",\n\t\t\t\t\t\tfield:\"value\",\n\t\t\t\t\t\tmode:\"text\",\n\t\t\t\t\t\tconditions:this.getConditions(\"text\"),\n\t\t\t\t\t\ttemplate:function(obj){\n\t\t\t\t\t\t\treturn obj.$value || obj.value;\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{ cols:[\n\t\t\t\t\t\t{ },\n\t\t\t\t\t\t{ view:\"button\", label:locale[\"cancel\"], autowidth:true, css:\"webix_transparent\", on:{\n\t\t\t\t\t\t\t\"onItemClick\": () => this.close()\n\t\t\t\t\t\t}},\n\t\t\t\t\t\t{ view:\"button\", label:locale[\"apply\"], autowidth:true, css:\"webix_secondary\", on:{\n\t\t\t\t\t\t\t\"onItemClick\": () => this.applyFilter()\n\t\t\t\t\t\t}},\n\t\t\t\t\t]}\n\t\t\t\t]\n\t\t\t}\n\t\t};\n\t}\n\tapplyFilter(){\n\t\tconst filter = this.getFilter();\n\t\tconst value = this.$filter.value = filter.getValue();\n\t\tvalue.$mode = filter.config.mode;\n\t\tthis.$filter.handler = filter.getFilterFunction();\n\n\t\tthis.view.filterSpreadSheet();\n\n\t\tconst active = !!(value.includes || (value.condition && value.condition.filter));\n\t\tthis.setCellStyle(this.cell.row, this.cell.column, \"ss_filter_active\", active);\n\n\t\tthis.close();\n\t}\n\tsetCellStyle(row, column, css, add){\n\t\tconst table = this.view.$$(\"cells\");\n\t\tconst span = this.getSpan(table, row, column);\n\n\t\tif (span){\n\t\t\tif (add){\n\t\t\t\tif (span[3].indexOf(css) == -1)\n\t\t\t\t\tspan[3] += \" \" + css;\n\t\t\t} else {\n\t\t\t\tspan[3] = span[3].replace(\" \" + css, \"\");\n\t\t\t}\n\t\t}\n\t\ttable[add?\"addCellCss\":\"removeCellCss\"](row, column, css);\n\t}\n\tgetSpan(table, row, column){\n\t\tlet item = table.getSpan()[row];\n\t\tif (item)\n\t\t\treturn item[column];\n\t}\n\tgetList(){\n\t\treturn this.getFilter().getChildViews()[2];\n\t}\n\tgetFilter(){\n\t\treturn this.$dialog.getBody().getChildViews()[0];\n\t}\n\tsyncScroll(){\n\t\tif (this.$dialog.isVisible()){\n\t\t\tconst node = this._getTargetNode();\n\t\t\tconst table = this.view.$$(\"cells\");\n\n\t\t\tlet isHidden = false;\n\t\t\tif (node){\n\t\t\t\tconst nodeOffset = webix.html.offset( node );\n\t\t\t\tconst tableOffset = webix.html.offset( table.$view.getElementsByClassName(\"webix_ss_body\")[0] );\n\t\t\t\tconst ydiff = nodeOffset.y - tableOffset.y;\n\t\t\t\tconst xdiff = nodeOffset.x - tableOffset.x + nodeOffset.width;\n\n\t\t\t\tisHidden = (ydiff < 0 || ydiff+nodeOffset.height > tableOffset.height || \n\t\t\t\t\txdiff < 0 || xdiff-nodeOffset.width > tableOffset.width - webix.env.scrollSize);\n\t\t\t}\n\t\t\tif (!node || isHidden)\n\t\t\t\tthis.$dialog.show({x:-9999, y:-9999});\n\t\t\telse \n\t\t\t\tthis.$dialog.show(node);\n\t\t}\n\t}\n\tgetConditions(name){\n\t\tconst locale = webix.i18n.filter;\n\t\tconst conditions = {\n\t\t\tnumber:[\n\t\t\t\t{ id:\"greater\", batch:\"text\", handler:function(a,b){\n\t\t\t\t\treturn a !== \"\" && (a*1 > b*1);\n\t\t\t\t}},\n\t\t\t\t{ id:\"less\", batch:\"text\", handler:function(a,b){\n\t\t\t\t\treturn a !== \"\" && (a*1 < b*1);\n\t\t\t\t}},\n\t\t\t\t{ id:\"greaterOrEqual\", batch:\"text\", handler:function(a,b){\n\t\t\t\t\treturn a !== \"\" && (a*1 >= b*1);\n\t\t\t\t}},\n\t\t\t\t{ id:\"lessOrEqual\", batch:\"text\", handler:function(a,b){\n\t\t\t\t\treturn a !== \"\" && (a*1 <= b*1);\n\t\t\t\t}},\n\t\t\t\t\"equal\", \"notEqual\", \"contains\", \"notContains\"\n\t\t\t],\n\t\t\ttext: [\"contains\", \"notContains\", \"equal\", \"notEqual\", \"beginsWith\", \"notBeginsWith\", \"endsWith\", \"notEndsWith\"]\n\t\t}[name];\n\n\t\tfor (let i=0; i<conditions.length; i++)\n\t\t\tif (conditions[i].id)\n\t\t\t\tconditions[i].value = locale[conditions[i].id];\n\n\t\treturn conditions;\n\t}\n}","import {Dialog} from \"./common\";\nimport * as fmt from \"../operations/formats\";\nimport group from \"../operations/undo_group\";\n\nexport const action = \"custom\";\n\nexport class DialogBox extends Dialog{\n\t$show(){\n\t\tthis.form = this.$dialog.$$(\"form\");\n\t\tthis.list = this.$dialog.$$(\"list\");\n\t\tthis.preview = this.$dialog.$$(\"preview\");\n\n\t\tthis.cell = this.view.getSelectedId(true);\n\t\tif (!this.cell.length)\n\t\t\treturn false;\n\n\t\tthis.fillForm(this.view);\n\n\t\tthis.view.$handleSelection = function(){\n\t\t\treturn false;\n\t\t};\n\t}\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t}\n\t$init(){\n\t\tconst i18n = webix.i18n.spreadsheet;\n\t\tconst labelsLocale = i18n.labels;\n\t\tconst formatsLocale = i18n.formats;\n\n\t\tconst docsLink = \"https://webix-guides.gitbook.io/spreadsheet-user-guide/formatting_numbers#custom-number-format\";\n\t\tconst delimiters = fmt.getDelimiters(\"int\");\n\n\t\tconst commonConfig = [\n\t\t\t{\n\t\t\t\tname:\"zeros\",\n\t\t\t\tview:\"counter\",\n\t\t\t\tcss:\"webix_ssheet_counter\",\n\t\t\t\tlabel:labelsLocale[\"decimal-places\"],\n\t\t\t\tvalue:0,\n\t\t\t\tbatch:\"common\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"separator\",\n\t\t\t\tview:\"checkbox\",\n\t\t\t\tlabel:labelsLocale[\"separator\"],\n\t\t\t\tbatch:\"common\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tview:\"formlist\",\n\t\t\t\tlabel:labelsLocale[\"negative\"],\n\t\t\t\tname:\"negative\",\n\t\t\t\tbatch:\"common\",\n\t\t\t\tcss:\"webix_ssheet_format_negative\",\n\t\t\t\ttemplate: obj => {\n\t\t\t\t\tif(this.list){\n\t\t\t\t\t\tlet format = this.getFormat(obj.id);\n\t\t\t\t\t\tformat = fmt.format2code(format.fmt, format.delimiters);\n\t\t\t\t\t\tconst style = {css:\"\"};\n\t\t\t\t\t\tconst value = format(-1234.56789, style);\n\n\t\t\t\t\t\treturn \"<span class='\"+style.css+\"'>\"+value+\"</span>\";\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tdata:[{id:1}, {id:2}, {id:3}]\n\t\t\t}\n\t\t];\n\n\t\tconst customConfig = [\n\t\t\t{\n\t\t\t\tview:\"text\",\n\t\t\t\tlabel: labelsLocale[\"format-pattern\"],\n\t\t\t\tname:\"format\",\n\t\t\t\tlabelPosition:\"top\",\n\t\t\t\tbatch:\"custom\",\n\t\t\t\tplaceholder:\"[>100]0\"+delimiters.groupSign+\"000\"+delimiters.decimalSign+\"00;[>0]None\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: \"docs\",\n\t\t\t\ttemplate: \"<a href='\"+docsLink+\"' target='_blank' class = 'docs'>\"+labelsLocale[\"format-docs\"]+\"</a>\",\n\t\t\t\tborderless:true,\n\t\t\t\tbatch:\"custom\"\n\t\t\t}\n\t\t];\n\n\t\tconst dateConfig = [\n\t\t\t{\n\t\t\t\tname:\"date\",\n\t\t\t\tbatch:\"date\",\n\t\t\t\tview:\"formlist\",\n\t\t\t\tlabelWidth: 90,\n\t\t\t\theight: 160,\n\t\t\t\tlabel:labelsLocale[\"date-format\"],\n\t\t\t\tcss:\"webix_ssheet_format_date\",\n\t\t\t\ttemplate: obj => fmt.format2code(obj.value, delimiters)(45000),\n\t\t\t\tdata:[\n\t\t\t\t\tformatsLocale.dateFormat,\n\t\t\t\t\tformatsLocale.timeFormat,\n\t\t\t\t\tformatsLocale.fullDateFormat,\n\t\t\t\t\tformatsLocale.longDateFormat\n\t\t\t\t]\n\t\t\t}\n\t\t];\n\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\tposition:\"center\",\n\t\t\twidth:460,\n\t\t\thead: labelsLocale[\"format-title\"],\n\t\t\tmove: true,\n\t\t\tbody:{\n\t\t\t\tcols:[\n\t\t\t\t\t{\n\t\t\t\t\t\tview:\"list\",\n\t\t\t\t\t\tid:\"list\",\n\t\t\t\t\t\tcss:\"webix_ssheet_format_type\",\n\t\t\t\t\t\twidth:120,\n\t\t\t\t\t\tscroll:false,\n\t\t\t\t\t\tdata:this.getFormats(),\n\t\t\t\t\t\tselect:true,\n\t\t\t\t\t\ton:{\n\t\t\t\t\t\t\tonSelectChange: (id)=>{\n\t\t\t\t\t\t\t\tthis.updateForm();\n\t\t\t\t\t\t\t\tswitch(id[0]){\n\t\t\t\t\t\t\t\t\tcase \"custom\":\n\t\t\t\t\t\t\t\t\tcase \"date\":\n\t\t\t\t\t\t\t\t\t\tthis.form.showBatch(id[0]);\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t\t\tthis.form.showBatch(\"common\");\n\t\t\t\t\t\t\t\t\t\tthis.form.elements.separator.show();\n\t\t\t\t\t\t\t\t\t\tif(id[0] == \"percent\")\n\t\t\t\t\t\t\t\t\t\t\tthis.form.elements.separator.hide();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tview:\"form\",\n\t\t\t\t\t\tid:\"form\",\n\t\t\t\t\t\tmargin:15,\n\t\t\t\t\t\theight:270,\n\t\t\t\t\t\tpaddingY:0,\n\t\t\t\t\t\tpaddingX:20,\n\t\t\t\t\t\telements:[\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tid: \"preview\",\n\t\t\t\t\t\t\t\ttemplate: function(obj){\n\t\t\t\t\t\t\t\t\tif(obj.value == i18n.table[\"format-error\"])\n\t\t\t\t\t\t\t\t\t\treturn obj.value;\n\t\t\t\t\t\t\t\t\treturn \"<span class ='\"+obj.css+\"'>\"+obj.value+\"</span>\";\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tcss: \"webix_ssheet_format_preview\",\n\t\t\t\t\t\t\t\tautoheight: true,\n\t\t\t\t\t\t\t\tborderless:true\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t].concat(commonConfig, customConfig, dateConfig),\n\t\t\t\t\t\telementsConfig: {\n\t\t\t\t\t\t\tlabelWidth: 155\n\t\t\t\t\t\t},\n\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\tonChange: () => this.updateForm()\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => this.okClick(),\n\t\t\t\tonHideClick: () => this.close(),\n\t\t\t\tonCancelClick: () => this.closeWin()\n\t\t\t}\n\t\t};\n\t}\n\tokClick(){\n\t\tlet type = this.list.getSelectedId();\n\t\tlet values = (type == \"custom\")?{format:this.form.getValues().format}:this.form.getValues();\n\t\tvalues.type = type;\n\n\t\tgroup.set(()=>{\n\t\t\tfor (let i = 0; i < this.cell.length; i++)\n\t\t\t\tfmt.addFormat(this.view, this.cell[i].row, this.cell[i].column, values.format, values);\n\t\t});\n\n\t\tthis.view.$$(\"cells\").refresh();\n\t\tthis.closeWin();\n\t}\n\tcloseWin(){\n\t\tconst style = this.view.getStyle(this.cell[0].row, this.cell[0].column);\n\t\tconst name = style && style.props.format ? style.props.format : \"common\";\n\n\t\t//default format\n\t\tif(!fmt.isCustom(name))\n\t\t\tthis.view.$$(\"bar\").setValues({format:name}, true);\n\t\tthis.close();\n\t}\n\tgetFormat(negative){\n\t\tconst type = this.list.getSelectedId();\n\t\tlet values = this.form.getValues();\n\n\t\tvalues.negative = negative || values.negative;\n\t\tif(type != \"custom\"){\n\t\t\tif(type != \"date\")\n\t\t\t\tvalues.date = \"\";\n\n\t\t\tvalues = fmt.formToValues(type, values);\n\t\t\treturn {\n\t\t\t\tfmt: fmt.serializeFormat(values),\n\t\t\t\tdelimiters:fmt.getDelimiters(type)\n\t\t\t};\n\t\t}\n\t\telse\n\t\t\treturn {\n\t\t\t\tfmt: values.format,\n\t\t\t\tdelimiters: fmt.getDelimiters(type)\n\t\t\t};\n\t}\n\tfillForm(view){\n\t\tconst locale = webix.i18n.spreadsheet;\n\t\tconst style = view.getStyle(this.cell[0].row, this.cell[0].column);\n\t\tlet values = { zeros:0, separator: 0, negative: 1, date: locale.formats.dateFormat, format: \"\"};\n\t\tlet type;\n\n\t\tlet name = style && style.props.format ? style.props.format : \"\";\n\n\t\tvalues.format = fmt.getFormatSource(name || \"price\");\n\n\t\tif(!name)\n\t\t\ttype = name = \"price\";\n\t\telse if(name == \"string\")\n\t\t\ttype = name = \"custom\";\n\t\telse\n\t\t\ttype = fmt.formatHelpers[name].values.type;\n\n\t\tif(type != \"custom\")\n\t\t\twebix.extend(values, fmt.formatHelpers[name].values, true);\n\n\t\tconst item = this.view.$$(\"cells\").getItem(this.cell[0].row);\n\t\tconst col = this.cell[0].column;\n\n\t\tthis.value = webix.isUndefined(item[col]) ? \"\" : item[col];\n\n\t\tthis.form.setValues(values);\n\t\tthis.list.select(type);\n\t\tthis.updateForm();\n\t}\n\tupdateForm(){\n\t\tconst form = this.form.elements;\n\t\tconst format = this.getFormat();\n\t\tlet value = this.value;\n\n\t\tconst isText = value === \"\" || isNaN(value);\n\n\t\tif(fmt.checkFormat(format, \"date\") && (isText || fmt.isDateInvalid(value)))\n\t\t\tvalue = 45000;\n\t\telse if(isText && !fmt.checkFormat(format, \"string\"))\n\t\t\tvalue = 1234.56789;\n\n\t\tlet style = {css:\"\"};\n\t\tvalue = fmt.format2code(format.fmt, format.delimiters)(value, style);\n\n\t\t//preview values\n\t\tthis.preview.parse({value:value, css:style.css});\n\t\tform.negative.refresh();\n\t\tform.date.refresh();\n\n\t\t//set new format string\n\t\tform.format.setValue(format.fmt);\n\t}\n\tgetFormats(){\n\t\tconst locale = webix.i18n.spreadsheet.labels;\n\t\treturn [\n\t\t\t{id: \"price\", value: locale.currency},\n\t\t\t{id: \"int\", value: locale.number},\n\t\t\t{id: \"percent\", value: locale.percent},\n\t\t\t{id: \"date\", value: locale.date},\n\t\t\t{id: \"custom\", value: locale[\"custom-format\"]}\n\t\t];\n\t}\n}","import {Dialog} from \"./common\";\nexport const action = \"conditional-format\";\n\nconst condition = [\n\t{id: \">\",value: \">\" },\n\t{id: \"<\",value: \"<\"},\n\t{id: \"=\",value: \"=\"},\n\t{id: \"!=\",value: webix.i18n.spreadsheet.labels[\"conditional-not-equal\"]},\n\t{id: \"<>\",value: webix.i18n.spreadsheet.labels[\"conditional-between\"]}\n];\n\nfunction getConditionStyle(data){\n\treturn data.map(item => {\n\t\titem.id = item.css;\n\t\treturn item;\n\t});\n}\n\nexport class DialogBox extends Dialog{\n\t_getCondition() {\n\t\tlet view = this.view;\n\t\tlet forms = this.$dialog.getBody().getChildViews()[0].getChildViews()[0].getChildViews();\n\t\tlet data = [];\n\n\t\tforms.forEach(form => {\n\t\t\tif (!form.getValues) return;\n\t\t\tlet values = form.getValues();\n\t\t\tlet item = [];\n\t\t\titem.push(values.condition);\n\n\t\t\tif(values.condition !== \"<>\"){\n\t\t\t\titem.push(this._safeInt(values.value, 10));\n\t\t\t} else {\n\t\t\t\titem.push([this._safeInt(values.value, 10),this._safeInt(values.value2, 10)]);\n\t\t\t}\n\t\t\titem.push(values.style);\n\t\t\tfor(var i=0; i < item.length; i++){\n\t\t\t\tif(item[i] === \"\")\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t\tdata.push(item);\n\t\t});\n\n\t\tview.callEvent(\"onConditionSet\", [data]);\n\t}\n\t_safeInt(a){\n\t\tvar num = parseFloat(a);\n\t\tif (num == a) return num;\n\t\treturn a;\n\t}\n\t_setCondition() {\n\t\tvar view = this.view,\n\t\t\tselect = view.getSelectedId(true),\n\t\t\tcell = select[0];\n\n\t\tif(!select.length) return false;\n\t\tvar collection = view.conditions.get(cell.row,cell.column);\n\n\t\tif(collection){\n\t\t\tlet forms = this.$dialog.getBody().getChildViews()[0].getChildViews()[0].getChildViews();\n\t\t\tcollection.forEach((item, i) => {\n\t\t\t\tvar values = {};\n\t\t\t\tvalues.condition = item[0];\n\t\t\t\tif(webix.isArray(item[1])){\n\t\t\t\t\tvalues.value = item[1][0].toString();\n\t\t\t\t\tvalues.value2 = item[1][1].toString();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t\tvalues.value = item[1].toString();\n\t\t\t\tvalues.style = item[2];\n\t\t\t\tforms[i+1].setValues(values);\n\t\t\t});\n\t\t}\n\t}\n\n\tapply(){\n\t\tthis._getCondition();\n\t\tthis.close();\n\t}\n\n\t_clean() {\n\t\tlet forms = this.$dialog.getBody().getChildViews()[0].getChildViews()[0].getChildViews();\n\t\tforms.forEach(form => {\n\t\t\tif (form.setValues) form.setValues({condition: \"\", value: \"\", value2: \"\", style: \"\"});\n\t\t});\n\t}\n\n\t$show(){\n\t\tif(!this.view.getSelectedId())\n\t\t\treturn false;\n\n\t\tthis.view.$handleSelection = (st, end, a, b)=>{\n\t\t\tif (this.activeValue && a == b){\n\t\t\t\tthis.activeValue.setValue(\"=\"+a);\n\t\t\t}\n\t\t\treturn false;\n\t\t};\n\t\tthis._setCondition();\n\t}\n\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t\tthis._clean();\n\t}\n\n\tgetRows(data, count){\n\t\tlet headers = {\n\t\t\theight: 36,\n\t\t\tcols: [\n\t\t\t\t{ view:\"label\", label: webix.i18n.spreadsheet.labels.display },\n\t\t\t\t{ view:\"label\", label: webix.i18n.spreadsheet.labels.condition },\n\t\t\t\t{ view:\"label\", label: webix.i18n.spreadsheet.labels.value },\n\t\t\t\t{ width: 25 }\n\t\t\t]\n\t\t};\n\t\tlet arr = [headers];\n\t\t\n\t\tlet item = {\n\t\t\tview: \"form\",\n\t\t\tpadding: 0,\n\t\t\tborderless: true,\n\n\t\t\telements: [{\n\t\t\t\tmargin: 10,\n\t\t\t\tcols: [\n\t\t\t\t\t{\n\t\t\t\t\t\tview:\"richselect\",\n\t\t\t\t\t\tname: \"style\",\n\t\t\t\t\t\twidth:120,\n\t\t\t\t\t\tplaceholder: webix.i18n.spreadsheet.labels[\"conditional-style\"],\n\t\t\t\t\t\tcss: \"webix_ssheet_cformat_select\",\n\t\t\t\t\t\tsuggest: {\n\t\t\t\t\t\t\tpadding:0,\n\t\t\t\t\t\t\tborderless: true,\n\t\t\t\t\t\t\tcss: \"webix_ssheet_cformat_list\",\n\t\t\t\t\t\t\tbody: {\n\t\t\t\t\t\t\t\ttemplate(obj) {\n\t\t\t\t\t\t\t\t\tvar css = \"webix_ssheet_cformat \"+obj.css;\n\t\t\t\t\t\t\t\t\treturn `<div class=\"${css}\">${obj.name}</div>`;\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tdata: data\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tview:\"richselect\",\n\t\t\t\t\t\twidth: 105,\n\t\t\t\t\t\tname: \"condition\",\n\t\t\t\t\t\tplaceholder: webix.i18n.spreadsheet.labels[\"conditional-operator\"],\n\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\tonChange: function(newv){\n\t\t\t\t\t\t\t\tif(newv === \"<>\"){\n\t\t\t\t\t\t\t\t\tthis.getFormView().elements.value2.show();\n\t\t\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\t\t\tthis.getFormView().elements.value2.hide();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tsuggest:{\n\t\t\t\t\t\t\tview: \"ssheet-form-suggest\",\n\t\t\t\t\t\t\tbody:{\n\t\t\t\t\t\t\t\tdata: condition\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tcols: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tview: \"text\",\n\t\t\t\t\t\t\t\tplaceholder: webix.i18n.spreadsheet.labels[\"conditional-number\"],\n\t\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\t\tonFocus: (current_view)=>{\n\t\t\t\t\t\t\t\t\t\tthis.activeValue = current_view;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tname: \"value\"\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tview: \"text\",\n\t\t\t\t\t\t\t\tname: \"value2\",\n\t\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\t\tonFocus: (current_view)=>{\n\t\t\t\t\t\t\t\t\t\tthis.activeValue = current_view;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\thidden: true\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]\n\t\t\t\t\t},\n\t\t\t\t\t{ view:\"icon\", css:\"webix_ssheet_cformat_clear\", icon:\"wxi-trash\", click:clearRow }\n\t\t\t\t]}\n\t\t\t]};\n\n\t\twhile(count--){\n\t\t\tarr.push(item);\n\t\t}\n\t\treturn arr;\n\t}\n\n\t$init(){\n\t\t//[IMPROVE] can be optimized by using datalayout instead of nested forms\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\thead: webix.i18n.spreadsheet.labels[\"conditional-format\"],\n\t\t\tposition:\"center\",\n\t\t\twidth: 500,\n\t\t\tmove: true,\n\t\t\tbuttons:false,\n\t\t\tbody:{\n\t\t\t\tview: \"form\",\n\t\t\t\tborderless: true,\n\t\t\t\trows: [\n\t\t\t\t\t{rows: this.getRows(getConditionStyle(this.view.config.conditionStyle), 3)},\n\t\t\t\t\t{\n\t\t\t\t\t\tcols:[\n\t\t\t\t\t\t\t{gravity:2},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tview: \"button\",\n\t\t\t\t\t\t\t\tvalue: webix.i18n.spreadsheet.labels.apply,\n\t\t\t\t\t\t\t\tclick: () => this.apply()\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonHideClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n}\n\nfunction clearRow(){\n\t//this - clear icon\n\tvar form = this.getFormView();\n\tform.clear();\n}","import {Dialog} from \"./common\";\n\nexport const action = \"excel-export\";\n\nexport class DialogBox extends Dialog{\n\t$show(box, form){\n\t\tthis.view.$handleSelection = function(){\n\t\t\treturn false;\n\t\t};\n\n\t\tform.elements.sheets.setValue(this.getSheets());\n\t\tform.elements.filename.setValue(\"Data\");\n\t\tform.elements.filename.getInputNode().select();\n\t}\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t}\n\t$init(){\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\thead: webix.i18n.spreadsheet.labels[\"export-title\"],\n\t\t\tmove: true,\n\t\t\tposition: \"center\",\n\t\t\tbody:{\n\t\t\t\tview:\"form\",\n\t\t\t\telements:[\n\t\t\t\t\t{ view:\"text\", name:\"filename\",  placeholder:webix.i18n.spreadsheet.labels[\"export-name\"]},\n\t\t\t\t\t{ view:\"multicheckbox\", name:\"sheets\"}\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => okClick(this),\n\t\t\t\tonHideClick: () => this.close(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n\tgetSheets(){\n\t\tconst view = this.view;\n\t\tconst sheets = view._sheets;\n\t\tlet value = [];\n\n\t\tfor(let i = 0; i < sheets.length; i++)\n\t\t\tvalue.push({\n\t\t\t\tname: sheets[i].name,\n\t\t\t\tactive: view._activeSheet === sheets[i].name ? 1 : 0\n\t\t\t});\n\n\t\treturn value;\n\t}\n}\n\nfunction okClick(dialog){\n\tconst values = dialog.$dialog.getBody().getValues();\n\twebix.toExcel(dialog.view, values);\n\tdialog.close();\n}\n","import {Dialog} from \"./common\";\n\nexport const action = \"add-link\";\n\nexport class DialogBox extends Dialog{\n\t$show(box, form){\n\t\tvar cell = this.view.getSelectedId();\n\t\tif(!cell)\n\t\t\treturn false;\n\t\tif (!this.restoreValue(form))\n\t\t\tform.clear();\n\t\tform.elements.name.focus();\n\t}\n\trestoreValue(form){\n\t\tvar cell = this.view.getSelectedId();\n\t\tif (cell){\n\t\t\tvar item = this.view.getRow(cell.row);\n\t\t\tvar value = item[\"$\"+cell.column] || item[cell.column];\n\t\t\tif (value && value.indexOf(\"=LINK\") === 0){\n\t\t\t\tvar parts = value.split(\"\\\"\");\n\t\t\t\tform.setValues({\n\t\t\t\t\tname: (parts[3] || \"\"),\n\t\t\t\t\turl: (parts[1] || \"\")\n\t\t\t\t});\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\t$init(){\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\thead: webix.i18n.spreadsheet.labels[\"link-title\"],\n\t\t\tmove: true,\n\t\t\tposition: \"center\",\n\t\t\tbody:{\n\t\t\t\tview:\"form\",\n\t\t\t\telements:[\n\t\t\t\t\t{ view:\"text\", name:\"name\",  placeholder:webix.i18n.spreadsheet.labels[\"link-name\"]},\n\t\t\t\t\t{ view:\"text\", name:\"url\",  placeholder:webix.i18n.spreadsheet.labels[\"link-url\"]}\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => okClick(this),\n\t\t\t\tonHideClick: () => this.close(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n}\n\nfunction okClick(dialog){\n\tvar cell = dialog.view.getSelectedId();\n\tvar data = dialog.$dialog.getBody().getValues();\n\n\tvar text = \"\";\n\tif (data.url){\n\t\tdata.name = data.name || data.url;\n\t\tif (!/^https?:\\/\\//i.test(data.url))\n\t\t\tdata.url = \"http://\" + data.url;\n\t\ttext = `=LINK(\"${data.url}\",\"${data.name}\")`;\n\t}\n\n\tdialog.view.setCellValue(cell.row, cell.column, text);\n\tdialog.view.refresh();\n\tdialog.close();\n}\n","import {Dialog} from \"./common\";\n\nexport const action = \"print\";\n\nexport class DialogBox extends Dialog{\n\t$show(box, form){\n\t\tform.setValues({\n\t\t\tdata:\"current\",\n\t\t\tpaper:\"A4\",\n\t\t\tfit:\"page\",\n\t\t\tmode:\"landscape\",\n\t\t\tsheetnames:1,\n\t\t\tmargin:0\n\t\t});\n\t}\n\t$init(){\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\thead: webix.i18n.spreadsheet.labels[\"print-title\"],\n\t\t\tmove: true,\n\t\t\tmodal:true,\n\t\t\twidth:530, height:520,\n\t\t\tposition: \"center\",\n\t\t\tbuttons:false,\n\t\t\tbody:{\n\t\t\t\tview:\"form\",\n\t\t\t\telements:[\n\t\t\t\t\t{ type:\"section\", template: webix.i18n.spreadsheet.labels[\"print-settings\"]},\n\t\t\t\t\t{ cols:[\n\t\t\t\t\t\t{ view:\"radio\", name:\"data\",vertical:true, options:[\n\t\t\t\t\t\t\t{ id:\"current\", value:webix.i18n.spreadsheet.labels[\"current-sheet\"]},\n\t\t\t\t\t\t\t{ id:\"all\", value:webix.i18n.spreadsheet.labels[\"all-sheets\"]},\n\t\t\t\t\t\t\t{ id:\"selection\", value:webix.i18n.spreadsheet.labels[\"selection\"]}\n\t\t\t\t\t\t], on:{\n\t\t\t\t\t\t\tonChange:function(newv){\n\t\t\t\t\t\t\t\tif(newv == \"all\"){\n\t\t\t\t\t\t\t\t\tvar form = this.getFormView();\n\t\t\t\t\t\t\t\t\tform.elements.sheetnames.setValue(1);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}},\n\t\t\t\t\t\t{ rows:[\n\t\t\t\t\t\t\t{view:\"checkbox\", name:\"sheetnames\", labelRight:webix.i18n.spreadsheet.labels[\"sheet-names\"]},\n\t\t\t\t\t\t\t{view:\"checkbox\", name:\"borderless\", labelRight:webix.i18n.spreadsheet.labels[\"borderless\"]},\n\t\t\t\t\t\t\t{view:\"checkbox\", name:\"skiprows\", labelRight:webix.i18n.spreadsheet.labels[\"skip-rows\"]},\n\t\t\t\t\t\t\t{view:\"checkbox\", name:\"margin\", labelRight:webix.i18n.spreadsheet.labels[\"margin\"]}\n\t\t\t\t\t\t]}\n\t\t\t\t\t]},\n\t\t\t\t\t{ type:\"section\", template: webix.i18n.spreadsheet.labels[\"print-paper\"]},\n\t\t\t\t\t{ view:\"radio\", name:\"paper\", options:[\n\t\t\t\t\t\t{ id:\"letter\", value:webix.i18n.spreadsheet.labels[\"page-letter\"]},\n\t\t\t\t\t\t{ id:\"A4\", value:webix.i18n.spreadsheet.labels[\"page-a4\"]},\n\t\t\t\t\t\t{ id:\"A3\", value:webix.i18n.spreadsheet.labels[\"page-a3\"]}\n\t\t\t\t\t]},\n\t\t\t\t\t{ type:\"section\", template: webix.i18n.spreadsheet.labels[\"print-layout\"]},\n\t\t\t\t\t{ cols:[\n\t\t\t\t\t\t{view:\"radio\", name:\"fit\", options:[\n\t\t\t\t\t\t\t{ id:\"page\", value:webix.i18n.spreadsheet.labels[\"page-width\"]},\n\t\t\t\t\t\t\t{ id:\"data\", value:webix.i18n.spreadsheet.labels[\"page-actual\"]}\n\t\t\t\t\t\t]},\n\t\t\t\t\t\t{ width:25},\n\t\t\t\t\t\t{ view:\"radio\", width:220, name:\"mode\", options:[\n\t\t\t\t\t\t\t{ id:\"portrait\", value:webix.i18n.spreadsheet.labels[\"page-portrait\"]},\n\t\t\t\t\t\t\t{ id:\"landscape\", value:webix.i18n.spreadsheet.labels[\"page-landscape\"]}\n\t\t\t\t\t\t]}\n\t\t\t\t\t]},\n\t\t\t\t\t{\n\t\t\t\t\t\tcols:[\n\t\t\t\t\t\t\t{ },\n\t\t\t\t\t\t\t{ view: \"button\", css:\"ssheet_cancel_button\", value: webix.i18n.spreadsheet.labels.cancel, autowidth:true,\n\t\t\t\t\t\t\t\tclick: () => this.close()\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{ view: \"button\", value: webix.i18n.spreadsheet.labels.print, autowidth:true,\n\t\t\t\t\t\t\t\tclick: () => this.apply(this)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonHideClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n\tapply(dialog){\n\t\tvar data = dialog.$dialog.getBody().getValues();\n\t\tdata.margin = data.margin?0:{};\n\t\tthis.close();\n\t\twebix.print(dialog.view, data);\n\t\t\n\t}\n}\n","import {Dialog} from \"./common\";\n\nexport const action = \"add-comment\";\n\nexport class DialogBox extends Dialog{\n\topen(action){\n\t\t//we get cell only on hover commented cell\n\t\tthis.cell = action.cell ? action.cell : this.view.getSelectedId();\n\n\t\t// cell not provided\n\t\tif (!this.cell || \n\t\t\t// cell is locked and in the edit mode\n\t\t\t(this.view.isCellLocked(this.cell.row, this.cell.column) && !action.viewonly) ||\n\t\t\t// action blocked by user's code\n\t\t\t!(this.view.callEvent(\"onBeforeCommentShow\", [this.cell.row, this.cell.column, !action.viewonly]))){\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.view.comments._activeComment = {editStatus: !action.viewonly, cell: this.cell};\n\n\t\tif(!this.$dialog){\n\t\t\tthis.$dialog = webix.ui(this.$init());\n\t\t\tthis.view._destroy_with_me.push(this.$dialog);\n\t\t\tthis.view.comments.commentsView = this.$dialog;\n\t\t\tthis.$dialog.attachEvent(\"onHide\", ()=>this.$hide());\n\t\t\tthis.view.attachEvent(\"onCommentHide\", ()=>this.$dialog.hide());\n\t\t}\n\n\t\tvar form = this.$dialog.getBody();\n\n\t\tvar span = this.view.$$(\"cells\").getSpan(this.cell.row, this.cell.column);\n\t\tvar item = span ? {row: this.cell.row, column:(span[1]*1+span[2]-1)} : this.cell;\n\n\t\twebix.delay(()=>{\n\t\t\tthis.$dialog.show(this.view.$$(\"cells\").getItemNode(item));\n\t\t\tthis._setComment();\n\t\t});\n\t\tif (this.$show(this.$dialog, form) === false)\n\t\t\tthis.close();\n\t}\n\t$show(){\n\t\tthis.textarea = this.$dialog.queryView({view:\"textarea\"});\n\t\tthis.template = this.$dialog.queryView({view:\"template\"});\n\t}\n\t$init(){\n\t\treturn {\n\t\t\tview: \"popup\",\n\t\t\tcss:\"ssheet_comments\",\n\t\t\tminWidth:250,\n\t\t\tminHeight:150,\n\t\t\trelative:\"right\",\n\t\t\tresize:true,\n\t\t\ton:{\n\t\t\t\tonViewResize:()=>{\n\t\t\t\t\tthis.$dialog.hide();\n\t\t\t\t\tthis.$dialog.show();\n\t\t\t\t}\n\t\t\t},\n\t\t\tbody:{\n\t\t\t\tanimate:false,\n\t\t\t\tcells:[\n\t\t\t\t\t{\n\t\t\t\t\t\tview: \"template\",\n\t\t\t\t\t\tcss:\"ssheet_comment_view\",\n\t\t\t\t\t\tborderless: true,\n\t\t\t\t\t\tscroll:\"auto\",\n\t\t\t\t\t\tonClick:{\n\t\t\t\t\t\t\t\"ssheet_comment_view\":() => {\n\t\t\t\t\t\t\t\tif(!(this.view.config.readonly || this.view.isCellLocked(this.cell.row, this.cell.column)))\n\t\t\t\t\t\t\t\t\tthis.showInput(this.view.comments.get(this.cell.row, this.cell.column));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tview: \"textarea\",\n\t\t\t\t\t\ton:{\n\t\t\t\t\t\t\tonChange:()=>{\n\t\t\t\t\t\t\t\tthis.addComment();\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tonFocus:()=>{\n\t\t\t\t\t\t\t\tthis.view.$$(\"cells\").select(this.cell.row, this.cell.column);\n\t\t\t\t\t\t\t\tthis.view.comments._activeComment = {editStatus: true, cell: this.cell};\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tonBlur:()=>{\n\t\t\t\t\t\t\t\tthis.showTemplate(this.textarea.getValue());\n\t\t\t\t\t\t\t\tthis.changeTextarea();\n\t\t\t\t\t\t\t\tthis.view.comments._activeComment = {};\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t}\n\t\t};\n\t}\n\t_setComment(){\n\t\tconst comment = this.view.comments.get(this.cell.row, this.cell.column);\n\t\tif(this.view.comments._activeComment.editStatus)\n\t\t\tthis.showInput(comment);\n\t\telse\n\t\t\tthis.showTemplate(comment);\n\t}\n\tshowTemplate(text){\n\t\tthis.template.show();\n\t\tthis.template.setHTML(text);\n\t}\n\tshowInput(text){\n\t\tthis.changeTextarea(text);\n\t\tthis.textarea.show();\n\t\tthis.textarea.focus();\n\t}\n\taddComment(){\n\t\tthis.view.comments.add(this.cell.row, this.cell.column, this.textarea.getValue());\n\t\tthis.$dialog.hide();\n\t}\n\tchangeTextarea(text){\n\t\tthis.textarea.blockEvent();\n\t\tthis.textarea.setValue(text||\"\");\n\t\tthis.textarea.unblockEvent();\n\t}\n}","import {Dialog} from \"./common\";\nexport const action = \"resize\";\n\nexport class DialogBox extends Dialog{\n\topen(action){\n\t\tthis.type = action.group;\n\t\tthis.header = action.value;\n\t\tDialog.prototype.open.apply(this, arguments);\n\t}\n\t$show(){\n\t\tconst sel = this.view.getSelectedId();\n\t\tif(!sel)\n\t\t\treturn false;\n\t\tthis.view.$handleSelection = ()=>{\n\t\t\treturn false;\n\t\t};\n\t\tthis.size = this.$dialog.getBody().elements[\"size\"];\n\t\tthis.$dialog.getHead().getChildViews()[0].setHTML(this.header);\n\t\tconst grid = this.view.$$(\"cells\");\n\n\t\tlet value;\n\t\tif(this.type == \"row\")\n\t\t\tvalue = grid.getItem(sel.row).$height || grid.config.rowHeight;\n\t\telse\n\t\t\tvalue = grid.getColumnConfig(sel.column).width || grid.config.columnWidth;\n\n\t\tthis.size.define({ value: value, label: webix.i18n.spreadsheet.labels[this.type == \"row\" ? \"height\" : \"width\"]});\n\t\tthis.size.refresh();\n\t\tthis.size.focus();\n\t}\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t}\n\tokClick(){\n\t\tconst size = this.size.getValue()*1;\n\t\tif(this.type == \"row\")\n\t\t\tthis.view.setRowHeight(null, size);\n\t\telse\n\t\t\tthis.view.setColumnWidth(null, size);\n\t\tthis.close();\n\t}\n\t$init(){\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\tposition:\"center\",\n\t\t\twidth: 300,\n\t\t\tmove: true,\n\t\t\tbody:{\n\t\t\t\tname: \"size\",\n\t\t\t\tview: \"text\"\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => this.okClick(),\n\t\t\t\tonHideClick: () => this.close(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n}","import * as aiw from \"./image\";\nimport * as asw from \"./sparkline\";\nimport * as rgs from \"./ranges\";\nimport * as dpd from \"./dropdown\";\nimport * as flt from \"./filter\";\nimport * as fmt from \"./format\";\nimport * as cnd from \"./conditional\";\nimport * as exp from \"./export\";\nimport * as lnk from \"./link\";\nimport * as pnt from \"./print\";\nimport * as cmt from \"./comments\";\nimport * as siz from \"./sizing\";\n\nconst bases = [ aiw, asw, rgs, dpd, flt, fmt, cnd, exp, lnk, pnt, cmt, siz ];\n\nexport function init(view){\n\tconst dialogs = {};\n\tconst viewBases = view.config.readonly ? [cmt] : bases;\n\n\tfor (let i = 0; i < viewBases.length; i++)\n\t\tdialogs[viewBases[i].action] = new viewBases[i].DialogBox(view);\n\n\tview.attachEvent(\"onCommand\", function(action){\n\t\tconst box = dialogs[action.id];\n\t\tif (box) box.open(action);\n\t});\n}","import group from \"./undo_group\";\n\nexport const lockCss = \"webix_lock\";\n\nexport function init(view){\n\tview._locks = {};\n\tview.attachEvent(\"onReset\", () => reset(view));\n\tview.attachEvent(\"onUndo\", (type, row, column, mode) => {\n\t\tif (type === \"lock\") lockCell(view, row, column, !!mode, true);\n\t});\n\n\tview.attachEvent(\"onCommand\", (cm) => {\n\t\tif (cm.id === \"lock-cell\")\n\t\t\tlock(view);\n\t});\n\n\tview.attachEvent(\"onAction\", (action, p)=> {\n\t\tif(action == \"before-grid-change\")\n\t\t\tupdatePosition(p.name,p.inc,p.data, p.start);\n\t});\n}\n\nfunction reset(view){\n\tview._locks = {};\n}\n\nexport function lockCell(view, row, column, mode, silent){\n\tvar table = view.$$(\"cells\");\n\tif (typeof row === \"object\" && typeof column === \"object\"){\n\t\tgroup.set(function() {\n\t\t\t_mapCellsCalls(row, column, function(row, column){\n\t\t\t\tlockCell(view, row, column, mode, true);\n\t\t\t});\n\t\t});\n\t} else {\n\t\tmode = ((mode === false) ? false : true);\n\t\tvar objrow = view._locks[row] = view._locks[row] || {};\n\t\tobjrow[column] = mode;\n\t\tif (mode)\n\t\t\ttable.addCellCss(row, column, lockCss, true);\n\t\telse\n\t\t\ttable.removeCellCss(row, column, lockCss, true);\n\n\t\tview.callEvent(\"onAction\", [\"lock\", { row, column, value: !mode, newValue: mode }]);\n\t}\n\n\tif (!silent)\n\t\ttable.refresh();\n}\n\nfunction _mapCellsCalls(start, end, handler,master){\n\tfor (let x = start.row; x<=end.row; x++)\n\t\tfor (let y = start.column; y<=end.column; y++)\n\t\t\thandler.call(master||this, x, y);\n}\n\nexport function isCellLocked(view, row, column){\n\treturn view._locks[row]?view._locks[row][column]:false;\n}\n\nexport function serialize(view,data){\n\tvar row, column,\n\t\tlocked = [];\n\tfor(row in view._locks){\n\t\tfor(column in view._locks[row])\n\t\t\tif(view._locks[row][column])\n\t\t\t\tlocked.push([row,column]);\n\t}\n\tdata.locked = locked;\n}\n\nexport function load(view,data){\n\tvar i,\n\t\tlocked = data.locked;\n\n\tif(locked)\n\t\tfor(i = 0; i < locked.length; i++)\n\t\t\tlockCell(view, locked[i][0],locked[i][1],true, true);\n}\n\nfunction lock(view){\n\tvar block = view.$$(\"cells\").getSelectArea();\n\tif (block){\n\t\tvar mode = view.isCellLocked(block.start.row, block.start.column);\n\t\tview.lockCell(block.start, block.end, !mode);\n\t}\n}\n\nfunction updatePosition(name, inc, data, start){\n\tlet locked = data.locked,\n\t\ti = locked.length;\n\n\tif(inc){\n\t\twhile(i--){\n\t\t\tlet [row,column] = locked[i];\n\t\t\tif(row && name == \"row\" && row>= start.row || column && name == \"column\" && column >= start.column){\n\t\t\t\tif (name == \"row\"){\n\t\t\t\t\tif (row < start.row - inc)\t//delete lock mark if row was deleted\n\t\t\t\t\t\tlocked.splice(i,1);\n\t\t\t\t\telse\t\t\t\t\t\t//update mark position if upper row was deleted\n\t\t\t\t\t\tlocked[i][0] = row*1 + inc;\n\t\t\t\t} else if (name == \"column\"){\n\t\t\t\t\tif (column < start.column - inc){\n\t\t\t\t\t\tlocked.splice(i, 1);\n\t\t\t\t\t} else \n\t\t\t\t\t\tlocked[i][1] = column*1 + inc;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}","import {isCellLocked} from \"./lock_cell\";\nimport group from \"./undo_group\";\n\n\nvar ignoreUndoReset = false;\n\nexport function init(view){\n\treset(view);\n\tundoHandlers(view);\n\tview.attachEvent(\"onHardReset\", () => reset(view));\n\tview.attachEvent(\"onAfterSheetShow\", () => reset(view));\n\t// styles\n\tview.attachEvent(\"onBeforeStyleChange\", (row, column, nstyle, ostyle) =>{\n\t\tif (isCellLocked(view, row, column)) return false;\n\t\taddToHistory(view, {action: \"style\", row:row, column: column, value: ostyle, newValue: nstyle, group: group.value});\n\t});\n\t// editing\n\tview.attachEvent(\"onBeforeValueChange\", (row, column, nvalue, ovalue) => {\n\t\tif (isCellLocked(view, row, column)) return false;\n\t\taddToHistory(view, {action: \"value\", row:row, column: column, value: ovalue, newValue: nvalue, group: group.value});\n\t});\n\t// merge cells\n\tview.attachEvent(\"onBeforeSpan\", (row, column, value) => {\n\t\tif (isCellLocked(view, row, column)) return false;\n\t\taddToHistory(view, {action: \"span\", row:row, column: column, value: value, newValue:value, group: group.value});\n\t});\n\t// split cells\n\tview.attachEvent(\"onBeforeSplit\", (row, column, value) => {\n\t\tif (isCellLocked(view, row, column)) return false;\n\t\taddToHistory(view, {action: \"split\", row:row, column: column, value: value, newValue:value, group: group.value});\n\t});\n\t// Any abstract undo actions\n\tview.attachEvent(\"onAction\", (action, obj) =>\n\t\taddToHistory(\n\t\t\tview,\n\t\t\t{\n\t\t\t\taction: action,\n\t\t\t\trow: obj.row || null,\n\t\t\t\tcolumn: obj.column || null,\n\t\t\t\tvalue: obj.value || null,\n\t\t\t\tnewValue: obj.newValue || null,\n\t\t\t\tgroup: group.value\n\t\t\t}\n\t\t)\n\t);\n\n\t// column resize\n\tview.$$(\"cells\").attachEvent(\"onColumnResize\", (column, nvalue, ovalue) =>\n\t\taddToHistory(view, {action: \"c-resize\", row:0, column:column, value: ovalue, newValue: nvalue, group: group.value})\n\t);\n\t// column hide\n\tview.attachEvent(\"onColumnOperation\", (action, start, end) => {\n\t\tif (action.id !== \"add\" && action.id !== \"del\")\n\t\t\taddToHistory(view, { action:action, row:0, column:{ start, end } });\n\t});\n\t// row hide\n\tview.attachEvent(\"onRowOperation\", (action, start, end) => {\n\t\tif (action.id !== \"add\" && action.id !== \"del\")\n\t\t\taddToHistory(view, { action:action, row:{ start, end }, column:0 });\n\t});\n\t// row resize\n\tview.$$(\"cells\").attachEvent(\"onRowResize\", (row,  nvalue, ovalue) =>\n\t\taddToHistory(view, {action: \"r-resize\", row: row, column:0, value: ovalue, newValue: nvalue, group: group.value})\n\t);\n\n\t// condition formats\n\tview.attachEvent(\"onBeforeConditionSet\", (row, column, value, nvalue) => {\n\t\tif (isCellLocked(view, row, column)) return false;\n\n\t\tvalue = value ? webix.copy(value) : null;\n\t\taddToHistory(view, {action: \"condition\", row: row, column: column, value: value, newValue: nvalue, group: group.value});\n\t});\n\tview.$skipHistory = 0;\n}\n\nexport function undo(view){\n\trestoreHistory(view,-1);\n}\n\nexport function redo(view){\n\trestoreHistory(view,1);\n}\n\nexport function reset(view){\n\tif(!ignoreUndoReset){\n\t\tview._ssUndoHistory = [];\n\t\tview._ssUndoCursor = -1;\n\t}\n}\n\nfunction addToHistory(view, data){\n\tif(!view.$skipHistory){\n\t\t// remove futher history\n\t\tview._ssUndoHistory.splice(view._ssUndoCursor+1);\n\t\t// add to an array and increase cursor\n\t\tview._ssUndoHistory.push(data);\n\t\tview._ssUndoCursor++;\n\t}\n}\n\nexport function ignoreUndo(func, view){\n\tview.$skipHistory++;\n\ttry{\n\t\tfunc.call(view);\n\t}\n\tfinally {\n\t\tview.$skipHistory--;\n\t}\n}\n\nexport function ignoreReset(func){\n\tignoreUndoReset = true;\n\tfunc();\n\tignoreUndoReset = false;\n}\n\nfunction restoreHistory(view, step){\n\tvar data = view._ssUndoHistory[step>0?(view._ssUndoCursor+step):view._ssUndoCursor];\n\tif(data){\n\t\tvar value = step > 0 ? data.newValue : data.value;\n\t\tvar direction = step>0;\n\t\tvar params = [data.action, data.row, data.column, value, direction];\n\n\t\tview._ssUndoCursor += step;\n\n\t\t// group support\n\t\tvar group = data.group;\n\t\tvar prevData = view._ssUndoHistory[step>0?(view._ssUndoCursor+step):view._ssUndoCursor];\n\n\t\tignoreUndo(function(){\n\t\t\tview.callEvent(\"onUndo\", params);\n\t\t\tif(!group || !(prevData && group == prevData.group))\n\t\t\t\tview.refresh();\n\t\t},view);\n\n\t\tif(prevData && group && group == prevData.group){\n\t\t\trestoreHistory(view, step);\n\t\t}\n\t}\n}\n\nfunction undoHandlers(view){\n\tview.attachEvent(\"onUndo\", function(type, row, column, value) {\n\t\tswitch (type) {\n\t\t\tcase \"freeze-row\":\n\t\t\t\tview.freezeRows(value);\n\t\t\t\tbreak;\n\t\t\tcase \"freeze-column\":\n\t\t\t\tview.freezeColumns(value);\n\t\t\t\tbreak;\n\t\t}\n\t});\n}","import {lockCss} from \"./lock_cell\";\nimport {find, findIndex} from \"../helpers/array\";\nimport {save} from \"./save\";\n\nexport function init(view){\n\tview.attachEvent(\"onStyleChange\", (row, column, style) => {\n\t\tvar span = getSpan(view, row, column);\n\t\tif (span){\n\t\t\tvar extraCss = getExtraCss(view, row, column);\n\t\t\tspan[3] = (style ? style.id : \"\") + (extraCss ? (\" \" + extraCss) : \"\");\n\t\t}\n\t});\n\n\tview.attachEvent(\"onDataParse\", (data) => {\n\t\tif (data.spans)\n\t\t\tfor (var i = 0; i < data.spans.length; i++) {\n\t\t\t\tvar span = data.spans[i];\n\t\t\t\taddSpan( view,\n\t\t\t\t\t{ row: span[0], column: span[1] },\n\t\t\t\t\tspan[2]*1,\n\t\t\t\t\tspan[3]*1,\n\t\t\t\t\ttrue \n\t\t\t\t);\n\t\t\t}\n\t});\n\n\tview.attachEvent(\"onDataSerialize\", (data) => {\n\t\tvar spans = [];\n\t\tvar pull = view.$$(\"cells\").getSpan();\n\t\tif (pull){\n\t\t\tfor (var rid in pull){\n\t\t\t\tvar row = pull[rid];\n\t\t\t\tfor (var cid in row){\n\t\t\t\t\tvar span = row[cid];\n\t\t\t\t\tspans.push([rid*1, cid*1, span[0], span[1]]);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tdata.spans = spans;\n\t\t}\n\t});\n\t\n\tview.attachEvent(\"onUndo\", (type, row, column, value, isUndo) => {\n\t\tif(type == \"span\" || type == \"split\"){\n\t\t\tif (type == \"span\") \n\t\t\t\tisUndo = !isUndo;\n\t\t\tundoSpan(view, row, column, value, isUndo);\n\t\t}\n\t});\n\n\tview.attachEvent(\"onAction\", (name, options) => {\n\t\tif(name == \"lock\")\n\t\t\tsetSpanCss(view, options.row, options.column, lockCss, options.newValue);\n\t\telse if(name == \"before-grid-change\")\n\t\t\tupdatePosition(options.name,options.inc,options.data, options.start);\n\t\telse if(name == \"check-borders\")\n\t\t\treturn checkSpanBorders(view, options.row, options.column, options.area, options.mode);\n\t});\n}\n\nfunction getSpan(view, row, column){\n\tvar item = view.$$(\"cells\").getSpan()[row];\n\tif (item)\n\t\treturn item[column];\n}\n\nexport function addSpan(view, cell, x, y, silent){\n\tif (x<2 && y<2) return;\n\n\tif(silent || view.callEvent(\"onBeforeSpan\", [cell.row, cell.column, [x, y]])){\n\t\tvar row = view.getRow(cell.row);\n\t\tvar css = row.$cellCss ? (row.$cellCss[cell.column] || \"\") : \"\";\n\t\tvar extraCss = getExtraCss(view, cell.row, cell.column);\n\t\tif (extraCss)\n\t\t\tcss += \" \" + extraCss;\n\n\t\tsetSpanValue(view, cell, x, y);\n\t\tview.$$(\"cells\").addSpan(cell.row, cell.column, x, y, null, css);\n\t\tif (!silent){\n\t\t\tview.callEvent(\"onAfterSpan\", [cell.row, cell.column, [x, y]]);\n\t\t\tsave(view, \"spans\", {\n\t\t\t\trow:cell.row, column: cell.column,\n\t\t\t\tx:x, y:y\n\t\t\t});\n\t\t}\n\t}\n}\n\nexport function removeSpan(view, cell){\n\tvar span = view.$$(\"cells\").getSpan(cell.row, cell.column);\n\tif(span && view.callEvent(\"onBeforeSplit\", [ cell.row, cell.column, [span[2], span[3]] ])){\n\t\tview.$$(\"cells\").removeSpan(cell.row, cell.column);\n\t\tview.callEvent(\"onAfterSplit\", [ cell.row, cell.column, [span[2], span[3]] ]);\n\t\tsave(view, \"spans\", {\n\t\t\trow:cell.row, column: cell.column,\n\t\t\tx:0, y:0\n\t\t});\n\t}\n}\n\nexport function getRange(sel){\n\tvar lx, ly, rx, ry;\n\trx = ry = 0;\n\tlx = ly = Infinity;\n\n\tfor (var i=0; i<sel.length; i++){\n\t\tvar cx = sel[i].column*1;\n\t\tvar cy = sel[i].row*1;\n\n\t\tlx = Math.min(cx, lx);\n\t\trx = Math.max(cx, rx);\n\t\tly = Math.min(cy, ly);\n\t\try = Math.max(cy, ry);\n\t}\n\n\treturn {\n\t\tcell:{ row:ly, column:lx },\n\t\tx: rx-lx+1,\n\t\ty: ry-ly+1\n\t};\n}\n\nexport function setSpanCss(view, row, column, css, add){\n\tconst span = getSpan(view, row, column);\n\tif (span){\n\t\tif (add){\n\t\t\tif (span[3].indexOf(css) == -1)\n\t\t\t\tspan[3] += \" \" + css;\n\t\t} else {\n\t\t\tspan[3] = span[3].replace(\" \" + css, \"\");\n\t\t}\n\t}\n}\n\nfunction getExtraCss(view, row, column){\n\treturn view.getCellEditor(row, column) ? \"ss_editor\"\n\t\t: (view.getCellFilter(row, column) ? \"ss_filter\" : \"\");\n}\n\nfunction undoSpan(view,row, column,value,isUndo){\n\tif(isUndo){\n\t\tremoveSpan(view,{row: row, column: column});\n\t}\n\telse{\n\t\taddSpan(view, {row: row, column: column}, value[0], value[1]);\n\t}\n}\n\nfunction updatePosition(name, inc, data, start){\n\tlet spans = data.spans;\n\tif(inc){\n\t\tfor(let i = spans.length-1;i >=0;i--){\n\t\t\tlet [row,column] = spans[i];\n\n\t\t\tif(inc < 0){//deleting\n\t\t\t\tif(name == \"row\" && row <= start.row-inc-1)\n\t\t\t\t\tinc = start.row - spans[i][0];\n\t\t\t\telse if (name == \"column\" && column <= start.column-inc-1)\n\t\t\t\t\tinc = start.column - spans[i][1];\n\t\t\t}\n\n\t\t\tif(name == \"row\" && row>= start.row || name == \"column\" && column >= start.column){\n\t\t\t\tspans[i][0] =  name == \"row\"?row*1 + inc:row;\n\t\t\t\tspans[i][1] = name == \"column\"?column*1 + inc:column;\n\t\t\t}\n\t\t}\n\t}\n}\n\nvar borderChecks = {\n\t\"border-right\":\t\tfunction(row, column, span, area){\n\t\treturn area.end.column == column+span[0]-1;\n\t},\n\t\"border-bottom\":\tfunction(row, column, span, area){\n\t\treturn area.end.row == row+span[1]-1;\n\t}\n};\n\nfunction checkSpanBorders(view, row, column, area, mode){\n\tvar span = getSpan(view, row, column);\n\treturn span&&borderChecks[mode]?borderChecks[mode](row, column, span, area):false;\n}\n\n// clear merged cells except the first one\nfunction setSpanValue(view, cell, x, y){\n\tvar i,j,value,\n\t\trow = cell.row*1,\n\t\tcolumn = cell.column*1,\n\t\tisEmpty = !view.getCellValue(row,column);\n\tfor(i = row; i < row+y; i++){\n\t\tfor(j = column; j < column+x; j++) {\n\t\t\tvalue = view.getCellValue(i,j);\n\t\t\tif(value!==\"\" && (j != column || i != row)){\n\t\t\t\tif(isEmpty){\n\t\t\t\t\tisEmpty = false;\n\t\t\t\t\tview.setCellValue(row,column,value);\n\t\t\t\t}\n\t\t\t\tview.setCellValue(i,j,\"\");\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport function adjustSpan (span, action, start, end, data){\n\tvar length = action.group == \"row\" ? span[3] : span[2];\n\tvar checkSpan = action.group == \"row\" ? [span[0]*1, span[0]*1+span[3]-1] : [span[1]*1, span[1]*1+span[2]-1];\n\tvar selection = action.group == \"row\" ? [start.row, end.row] : [start.column, end.column];\n\n\t//if we add, the number of selected rows/cols is added to span, so we need original selection length\n\tvar inc = selection[1] - selection[0] + 1;\n\n\tselection[0] = Math.max(selection[0], checkSpan[0]);\n\tselection[1] = Math.min(selection[1], checkSpan[1]);\n\n\tvar isFirstCell = selection[0] == checkSpan[0];\n\n\tif(selection[0] <= selection[1]){ //selection is in span\n\t\tif(action.id == \"del\") //if we delete, only rows/cols included into span\n\t\t\tinc = (selection[1] - selection[0]+ 1) * -1;\n\t\t//delete smth which starts as span and less than it's length\n\t\tif(action.id == \"del\" && isFirstCell && length > -1*inc){\n\t\t\tvar value = find(data, function(value) {\n\t\t\t\treturn (value[0] == span[0] && value[1] == span[1]);\n\t\t\t});\n\n\t\t\tvalue[0] = action.group == \"row\" ? value[0] - inc : value[0];\n\t\t\tvalue[1] = action.group == \"column\" ? value[1] - inc : value[1];\n\n\t\t\tvar oldValue = findIndex(data, function(oldValue) {\n\t\t\t\treturn oldValue[0] == value[0] && oldValue[1] == value[1] && (oldValue[2] != value[2] || oldValue[3] != value[3]); \n\t\t\t});\n\n\t\t\tif(oldValue > -1) //remove another data at the same place\n\t\t\t\tdata.splice(oldValue,1);\n\t\t}\n\n\t\tif(!(isFirstCell && action.id == \"add\")){\n\t\t\tspan[2] = action.group == \"column\" ? span[2]+inc : span[2];\n\t\t\tspan[3] = action.group == \"row\" ? span[3]+inc : span[3];\n\t\t}\n\t}\n\treturn span;\n}\n\nexport function pasteSpan(view, extra, row, col, cutted, translate){\n\t//existing span\n\tvar s = view._table.getSpan(row, col);\n\tif(extra && extra.span){\n\t\tvar span = extra.span;\n\t\t//if we are on start position for the future span\n\t\tif(row == span[0]*1+translate.row && col == span[1]*1+translate.column){\n\t\t\t//delete spans in future paste zone \n\t\t\tview._table.mapCells(row, col, span[3], span[2], (value, rid, cid) => {\n\t\t\t\ts = view._table.getSpan(rid,cid);\n\t\t\t\tif(s) removeSpan(view, {row:s[0], column:s[1]});\n\t\t\t}, true);\n\t\t\taddSpan(view, {row:row, column:col}, span[2], span[3]);\n\t\t\tif(cutted === 1)\n\t\t\t\tremoveSpan(view, {row:extra.row, column:extra.col});\n\t\t}\n\t}\n\telse if(s)\n\t\tremoveSpan(view, {row:s[0], column:s[1]});\n}","import {updateMath}  from \"../math/updater\";\nimport {clearMathCache} from \"../math/cache\";\nimport {ignoreReset, ignoreUndo}  from \"../operations/undo\";\nimport group  from \"../operations/undo_group\";\nimport {adjustSpan}  from \"../operations/spans\";\n\nexport function init(view){\n\tview.attachEvent(\"onCommand\", (action, start, end) => {\n\t\tif (action.id == \"add\" || action.id == \"del\"){\n\t\t\tvar area = view._table.getSelectArea();\n\t\t\tif(area && !(start && end)){\n\t\t\t\tstart = area.start;\n\t\t\t\tend = area.end;\n\t\t\t}\n\n\t\t\tif (start && end){\n\t\t\t\tgroup.set(function(){\n\t\t\t\t\tprocess(action, start, end, view);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t});\n\n\tview.attachEvent(\"onUndo\", (action, row, column, value) => {\n\t\tif(action == \"grid-change\"){\n\t\t\tclearMathCache(true);\n\t\t\tloadChangedData(view,value);\n\t\t}\n\t});\n}\n\nexport function process(action, start, end, view, e, r) {\n\tvar data, i, newData, oldData, values,\n\t\tcount=0, origin=0;\n\n\tvar select = view._table.getSelectArea();\n\tvar state = view._table.getScrollState();\n\n\tnewData = view.serialize({\n\t\tmath: true\n\t});\n\n\toldData = webix.copy(newData);\n\n\tvar spans = newData.spans;\n\tfor (var s in spans){\n\t\tvar span = spans[s];\n\t\tspan = adjustSpan(span, action, start, end, newData.data);\n\t\tif(span[2] <= 0 || span[3] <= 0){\n\t\t\tspans.splice(s, 1);\n\t\t}\n\t}\n\n\tvalues = getUpdateValues(action, start, end);\n\n\tview.$handleSelection = null;\t\n\n\tif(!e)\n\t\tignoreUndo(function(){\n\t\t\tview.callEvent(\"onAction\", [\"before-grid-change\", {\n\t\t\t\tname: values.name,\n\t\t\t\tinc: values.inc,\n\t\t\t\tdata:newData,\n\t\t\t\tstart: start\n\t\t\t}]);\n\t\t},view);\n\n\tdata = newData.data;\n\n\tif (action.group == \"column\") {\n\t\tcount = end.column - start.column + 1;\n\t\torigin = start.column;\n\n\t\tif (action.id == \"add\")\n\t\t\t_addColumn(action, start, end, view, e, r, data);\n\t\telse if (action.id == \"del\"){\n\t\t\t_delColumn(action, start, end, view, e, r, data);\n\t\t\tcount = -count;\n\t\t}\n\t} else if (action.group == \"row\") {\n\t\tcount = end.row - start.row + 1;\n\t\torigin = start.row;\n\n\t\tif (action.id == \"add\")\n\t\t\t_addRow(action, start, end, view, e, r, data);\n\t\telse if (action.id == \"del\"){\n\t\t\t_delRow(action, start, end, view, e, r, data);\n\t\t\tcount = -count;\n\t\t}\n\t}\n\n\t//update formulas\n\tvar update = { id:action.group, start:origin, count:count };\n\ti = data.length;\n\twhile (i--) {\n\t\tif (data[i][2] && typeof data[i][2] === \"string\" && data[i][2].substr(0, 1) == \"=\")\n\t\t\tdata[i][2] = updateMath(data[i][2], update);\n\t}\n\n\tview.callEvent(\"onAction\", [\"grid-change\",{value: oldData, newValue: newData} ]);\n\n\tignoreUndo(function() {\n\t\tloadChangedData(view, newData);\n\t\tview._table.scrollTo(state.x, state.y);\n\t},view);\n\n\tif (select){\n\t\tvar grid = view.$$(\"cells\");\n\t\tselect = fixSelectArea(select, grid);\n\t\tif (select)\n\t\t\tgrid.addSelectArea(select.start, select.end);\n\t}\n}\n\nfunction fixSelectArea(select, grid){\n\tvar rows = grid.count();\n\tvar cols = grid.config.columns.length;\n\tif (select.start.row*1 > rows) return null;\n\tif (select.end.row*1 > rows) return null;\n\tif (select.start.column*1 > cols) return null;\n\tif (select.end.column*1 > cols) return null;\n\t\n\treturn select;\n}\n\nfunction loadChangedData(view, data){\n\t// data loading resets undo history, and\n\t// we need to preserve it\n\tignoreReset(function(){\n\t\tview.$handleSelection = null;\n\t\tview.parse(data);\n\t});\n}\n\nfunction getUpdateValues( action, start, end){\n\tvar name = action.group,\n\t\tinc = action.id==\"add\"?1:(action.id==\"del\"?-1:0);\n\n\tif(inc) {\n\t\t// span support\n\t\tif (name == \"row\")\n\t\t\tinc += inc * (end.row - start.row);\n\t\tif (name == \"column\")\n\t\t\tinc += inc * (end.column - start.column);\n\t}\n\treturn {name: name, inc: inc};\n}\n\nfunction _addColumn(action, start, end, view, silent, value, data) {\n\tlet i = data.length;\n\tlet add_column_count = end.column - start.column + 1;\n\tview.config.columnCount += add_column_count;\n\tview.reset();\n\n\twhile (i--)\n\t\tif (data[i][1] >= start.column)\n\t\t\tdata[i][1] += add_column_count;\n\n\tif (!silent)\n\t\tview.callEvent(\"onColumnOperation\", [action, start, end, null]); //add item to history\n\telse\n\t\tdata.push(...value); //recovering value which has been deleted\n}\n\nfunction _delColumn(action, start, end, view, silent, value, data) {\n\tlet i = data.length;\n\tlet del_column_count = end.column - start.column + 1;\n\n\tif (view.config.columnCount === del_column_count){\n\t\tif (start.column == end.column)\n\t\t\treturn; //deleting last column, ignoring\n\t\t//prevent deleting all columns\n\t\tend.column--;\n\t\tdel_column_count--;\n\t}\n\n\tview.config.columnCount -= del_column_count;\n\n\n\tview.reset();\n\tlet deleted = []; // for history\n\n\twhile (i--)\n\t\tif (data[i][1] >= start.column && data[i][1] <= end.column)\n\t\t\tdeleted.push(data.splice(i, 1)[0]);\n\t\telse if (data[i][1] > end.column)\n\t\t\tdata[i][1] -= del_column_count;\n\n\tif (!silent)\n\t\tview.callEvent(\"onColumnOperation\", [action, start, end, deleted]);\n}\n\nfunction _addRow(action, start, end, view, silent, value, data) {\n\tlet i = data.length;\n\tlet add_row_count = end.row - start.row + 1;\n\tview.config.rowCount += add_row_count;\n\n\tview.reset();\n\n\twhile (i--)\n\t\tif (data[i][0] >= start.row)\n\t\t\tdata[i][0] += add_row_count;\n\n\tif (!silent) {\n\t\tview.callEvent(\"onRowOperation\", [action, start, end, null]);\n\t} else {\n\t\tdata.push(...value);\n\t}\n}\n\nfunction _delRow(action, start, end, view, silent, value, data) {\n\tlet i = data.length;\n\tlet del_row_count = end.row - start.row + 1;\n\n\tif (view.config.rowCount === del_row_count){\n\t\tif (start.row == end.row)\n\t\t\treturn; //deleting last column, ignoring\n\t\t//prevent deleting all columns\n\t\tend.row--;\n\t\tdel_row_count--;\n\t}\n\n\tview.config.rowCount -= del_row_count;\n\n\tview.reset();\n\n\tlet deleted = [];\n\twhile (i--)\n\t\tif (data[i][0] >= start.row && data[i][0] <= end.row)\n\t\t\tdeleted.push(data.splice(i, 1)[0]);\n\t\telse if (data[i][0] > end.row)\n\t\t\tdata[i][0] -= del_row_count;\n\n\tif (!silent)\n\t\tview.callEvent(\"onRowOperation\", [action, start, end, deleted]);\n}","import {methods} from \"./methods\";\nimport * as rgs from \"./ranges\";\nimport * as psh from \"./placeholder\";\nimport {changeRange} from \"../helpers/column_names\";\nimport * as sheets from \"./sheet\";\nimport {_parse, clearMathCache} from \"./cache\";\n\nexport function init(view){\n\tvar triggers = [];\n\tvar backtrak = [];\n\n\tview._mathSheetCache = {};\n\n\t//math operations object\n\tvar core = get_core(view);\n\n\t//init named ranges\n\tview.ranges = core.ranges = new rgs.Ranges(view);\n\t//init placeholders\n\tcore.p = psh.init(view);\n\n\tview.attachEvent(\"onReset\", () => {\n\t\ttriggers = [];\n\t\tbacktrak = [];\n\t\tview.ranges.clear();\n\t});\n\n\tview.attachEvent(\"onCellChange\", updateCell);\n\tview.attachEvent(\"onMathRefresh\", recalckAll);\n\n\tview.attachEvent(\"onDataSerialize\", (data) => _serialize(view, data));\n\tview.attachEvent(\"onDataParse\", (data) => _dataParse(view, data));\n\n\tview.attachEvent(\"onAction\", (action, p)=> {\n\t\tif(action == \"before-grid-change\"){\n\t\t\tclearMathCache(true);\n\t\t\tupdatePosition(p.name,p.inc,p.data, p.start);\n\t\t}\n\t});\n\n\tvar solvedMath;\n\tvar solvedCounter;\n\t//execute math handler\n\tfunction applyMath(r, c, handler){\n\t\tconst row = view.getRow(r);\n\t\tconst value = _execute(handler, core);\n\t\trow[c] = value;\n\n\t\tconst tkey = c*100000000+r;\n\t\tconst count = solvedCounter[tkey] = (solvedCounter[tkey] || 0) + 1;\n\n\t\tif (solvedMath[tkey] === value || count > 1000){\n\t\t\t//prevent infinity loops\n\t\t\t//if cell was already calculated with the same value, do not recaculate dependent cells\n\t\t\t//in some cases we have have non-stable loop, where value of math is different each time\n\t\t\t//counter limits calculation for 1000 itterations per cell\n\t\t\treturn;\n\t\t}\n\n\t\tsolvedMath[tkey] = value;\n\t\t//check if we have related cells, process their math as well\n\t\tcheck_trigger(r, c);\n\t}\n\n\t//check and run triggers\n\tfunction check_trigger(srow, scolumn){\n\t\t//triggers is a matrix[row][column]\n\t\t//store array of coordinates of related cells\n\n\t\tconst line = triggers[srow];\n\t\tif (line){\n\t\t\tconst block = line[scolumn];\n\t\t\tif (block){\n\t\t\t\tfor (var i = 0; i < block.length; i++){\n\t\t\t\t\tconst {row, column, handler} = block[i];\n\t\t\t\t\tif (row != srow || column != scolumn){\n\t\t\t\t\t\tapplyMath(row, column, handler);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction recalckAll(){\n\t\tvar grid = view.$$(\"cells\");\n\t\tvar state = grid.getState();\n\t\tvar columns = state.ids.concat(state.hidden);\n\n\t\tgrid.eachRow(function(obj){\n\t\t\tvar item = this.getItem(obj);\n\t\t\tfor (var i=1; i<columns.length; i++){\n\t\t\t\tvar key = columns[i];\n\t\t\t\tvar value = item[\"$\"+key];\n\t\t\t\tif (value)\n\t\t\t\t\trecalckCell(obj, key, value);\n\t\t\t}\n\t\t}, true);\n\n\t\tgrid.refresh();\n\t}\n\n\tfunction updateCell(r, c){\n\t\t//cell value can be updated in types module on cell change, so use getCellValue instead of value argument\n\t\trecalckCell(r, c, view.getCellValue(r, c));\n\t}\n\n\tfunction recalckCell(r,c,value){\n\t\t//check if changed cell was a math cell, based on some other cells\n\t\t//clean triggers in such case\n\t\tvar line = backtrak[r];\n\t\tif (line && line[c])\n\t\t\tremove_triggers(triggers, backtrak, c, r);\n\n\t\t//if new value is a math, calculate it and store triggers\n\t\tif (value){\n\t\t\tvalue = value.toString();\n\t\t\tif(value.length > 1 && value.indexOf(\"=\") === 0){\n\t\t\t\tvar formula = _parse(value, core, \"\");\n\t\t\t\tvar row = view.getRow(r);\n\t\t\t\trow[c] = _execute(formula.handler, core);\n\t\t\t\trow[\"$\"+c] = formula.text;\n\n\t\t\t\tif (formula.triggers.length){\n\t\t\t\t\tadd_triggers(triggers, backtrak, formula.triggers, \n\t\t\t\t\t\t{ row: r, column: c, handler: formula.handler }, view.getActiveSheet());\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t//check if we have some other cells, related to the changed one\n\t\tsolvedMath = {};\n\t\tsolvedCounter = {};\n\t\tcheck_trigger(r, c);\n\t}\n\n\tsheets.init(view, core, { parse: _parse, execute: _execute });\n}\n\nexport function calculate(view, value){\n\tvar core = get_core(view);\n\tvar formula = _parse(value, core, \"\");\n\tvalue = _execute(formula.handler, core);\n\treturn value;\n}\n\n//add new triggers\nfunction add_triggers(trs, back, adds, cell, active){\n\t//trs - matrix of triggers\n\t//back - matrix of backlinks\n\t//adds - list of triggers\n\tvar blist = [];\n\tfor (var i = 0; i < adds.length; i++){\n\t\tvar line = adds[i];\n\t\t//line = [start_row, start_column, end_row, end_column, sheet]\n\n\t\t//ignore triggers from passive cells\n\t\tif (line[4] !== \"\" && line[4] !== active)\n\t\t\tcontinue;\n\n\t\tfor (var j = line[0]; j<=line[2]; j++){\n\t\t\tvar step = trs[j];\n\t\t\tif (!step) step = trs[j]=[];\n\t\t\tfor (var k = line[1]; k <= line[3]; k++){\n\t\t\t\tvar block = step[k];\n\t\t\t\tif (!block)\n\t\t\t\t\tblock = step[k] = [];\n\n\t\t\t\tblist.push([j, k]);\n\t\t\t\tblock.push(cell);\n\t\t\t}\n\t\t}\n\t}\n\n\t//store back-relations, for easy trigger removing \n\tadd_backtrack(back, cell.row, cell.column, blist);\n}\n\n//store backtrack relations as a matrix\nfunction add_backtrack(back, row, column, adds){\n\tvar line = back[row];\n\tif (!line)\n\t\tline = back[row] = [];\n\tline[column] = adds;\n}\n\n//remove unused triggers\nfunction remove_triggers(trs, back, c, r){\n\t//get list of triggers from backtrack structure\n\tvar adds = back[r][c];\n\tback[r][c] = null;\n\n\t//delete triggers\n\tfor (var i = adds.length - 1; i >= 0; i--) {\n\t\tvar cell = adds[i];\n\t\tvar block = trs[cell[0]][cell[1]];\n\n\t\tfor (var j = block.length-1; j >= 0; j--){\n\t\t\tvar bcell = block[j];\n\t\t\tif (bcell.row == r && bcell.column == c)\n\t\t\t\tblock.splice(j,1);\n\t\t}\n\t}\n}\n\n//run math function\nfunction _execute(formula, core){\n\tvar value;\n\tvar error = webix.i18n.spreadsheet.table[\"math-error\"];\n\ttry {\n\t\tvalue = formula.call(core);\t\n\t} catch(e){\n\t\t//some error in the math code\n\t\treturn error;\n\t}\n\n\tif (typeof value === \"number\"){\n\t\tif(!isFinite(value)) return error;\n\t\t//round values to fix math precision issue in JS\n\t\treturn Math.round(value*100000)/100000;\n\t} else if (typeof value !== \"string\"){\n\t\treturn value ? value.toString() : error;\n\t} else\n\t\treturn value;\n}\n\n//converts cell references to code\nfunction get_core(view){\n\tvar active = sheets.getAccessor(view);\n\n\treturn {\n\t\trs:function(sheet, r1, c1, r2, c2){\n\t\t\treturn sheets.getAccessor(view, sheet).getRange(r1,c1,r2,c2);\n\t\t},\n\t\tr:active.getRange,\n\t\tvs:function(sheet, r, c){\n\t\t\treturn sheets.getAccessor(view, sheet).getValue(r,c);\n\t\t},\n\t\tv:active.getValue,\n\t\tm:methods,\n\t\tp:{},\n\t\te:function(e){throw e;}\n\t};\n}\n\nfunction _serialize(view, obj){\n\tobj.ranges = view.ranges.serialize();\n}\n\nfunction _dataParse(view, obj){\n\tview.ranges.parse(obj.ranges);\n}\n\nfunction updatePosition(name, inc, data, start){\n\tvar ranges = data.ranges;\n\tfor(let i=0; i < ranges.length; i++)\n\t\tranges[i][1] = changeRange(ranges[i][1],name,inc, start);\n}","export function init(view){\n\tvar holders = {};\n\n\tview.setPlaceholder = function(obj, value){\n\t\tif (typeof obj === \"object\")\n\t\t\tfor (var key in obj)\n\t\t\t\tholders[key.toLowerCase()] = obj[key];\n\t\telse\n\t\t\tholders[obj.toString().toLowerCase()] = value;\n\n\t\tview.callEvent(\"onMathRefresh\",[]);\n\t};\n\n\treturn holders;\n}","import group from \"./undo_group\";\nimport {calculate} from \"../math/math\";\nimport {eachRange} from \"../helpers/column_names\";\n\nexport function init(view){\n\tview.conditions = {\n\t\t_empty:true,\n\t\t_pull: {},\n\t\thandlers: {\n\t\t\t\">\": function(a,b){\n\t\t\t\treturn a > getCellValue(view, b);\n\t\t\t},\n\t\t\t\"<\": function(a,b){\n\t\t\t\treturn a < getCellValue(view, b);\n\t\t\t},\n\t\t\t\"=\": function(a,b){\n\t\t\t\treturn a == getCellValue(view, b);\n\t\t\t},\n\t\t\t\"!=\": function(a,b){\n\t\t\t\treturn a != getCellValue(view, b);\n\t\t\t},\n\t\t\t\"<>\": function(a,b){\n\t\t\t\tvar first = b[0];\n\t\t\t\tvar second = b[1];\n\t\t\t\treturn webix.isArray(b) && a < getCellValue(view, second) && a > getCellValue(view, first);\n\t\t\t}\n\t\t},\n\t\tadd: add,\n\t\tremove: remove,\n\t\tupdate: update,\n\t\tget: get,\n\t\tparse: parse,\n\t\tserialize: serialize,\n\t\tclear: clear\n\t};\n\n\tview.attachEvent(\"onConditionSet\", (data) => _setCondition(view, data));\n\n\tview.attachEvent(\"onUndo\", (type_action, row, column, value) => {\n\t\tif(type_action == \"condition\")\n\t\t\t_undoCondition(view, row, column, value);\n\t});\n\n\tview.attachEvent(\"onDataSerialize\", (data) => _serialize(view, data));\n\tview.attachEvent(\"onDataParse\", (data) => _parse(view, data));\n\n\tview.attachEvent(\"onColumnInit\", (column) => _setCssFormat(view, column));\n\n\tview.attachEvent(\"onReset\", () => view.conditions.clear() );\n\n\tview.attachEvent(\"onAction\", (action, p)=> {\n\t\tif(action == \"before-grid-change\")\n\t\t\tupdatePosition(p.name,p.inc,p.data, p.start);\n\t});\n\n\treset(view);\n}\n\nfunction getCellValue(view, value){\n\tif(isNaN(value*1)){\n\t\tif (value.charAt(0) == \"=\"){\n\t\t\tvalue = calculate(view, value);\n\t\t}\n\t}\n\telse {\n\t\tvalue = value*1;\n\t}\n\treturn value;\n}\n\nfunction reset(view){\n\tview.conditions.clear();\n}\n\nfunction _setCondition(view, data){\n\tgroup.set(function(){\n\t\tview.eachSelectedCell((cell) => {\n\t\t\tvar collection = view.conditions.get(cell.row,cell.column);\n\t\t\t_changeCondition(\"update\", cell.row, cell.column, (collection||null), data, view);\n\t\t});\n\t});\n\tview.refresh();\n}\n\nfunction _undoCondition(view, row, column, value){\n\tif(view.conditions.get(row, column))\n\t\tview.conditions.remove(row, column);\n\tif(value)\n\t\tview.conditions.update(row, column, value);\n}\n\nfunction _serialize(view, obj){\n\tobj.conditions = view.conditions.serialize();\n}\n\nfunction _parse(view, obj){\n\tview.conditions.parse(obj.conditions);\n}\n\nfunction _setCssFormat(view,column){\n\tcolumn.cssFormat = function (value, obj, row, column){\n\t\tif (view.conditions._empty) return \"\";\n\n\t\tvar collection, i;\n\t\tcollection = view.conditions.get(row, column);\n\t\tif(!collection)\n\t\t\treturn \"\";\n\n\t\ti = collection.length;\n\t\twhile(i--){\n\t\t\tvar handler = view.conditions.handlers[collection[i][0]];\n\t\t\tif(handler && handler(obj[column],collection[i][1]))\n\t\t\t\treturn collection[i][2];\n\t\t}\n\t\treturn \"\";\n\t};\n}\n\n\nfunction addEmptyCollection(pull, row, column, state){\n\tstate._empty = false;\n\tif(!pull[row])\n\t\tpull[row] = {};\n\tif(!pull[row][column])\n\t\tpull[row][column] = [];\n\treturn pull[row][column];\n}\n\n\nfunction parse(data){\n\tthis._empty = true;\n\tif (!data) return;\n\n\tlet i = data.length;\n\twhile(i--){\n\t\tvar c = data[i];\n\t\tvar collection = addEmptyCollection(this._pull,c[0],c[1],this);\n\t\tcollection.push([c[2],c[3],c[4]]);\n\t}\n}\n\nfunction clear(){\n\tthis._pull = {};\n}\n\nfunction update(row, column, newData){\n\tvar collection = this.get(row, column);\n\tif(!collection)\n\t\taddEmptyCollection(this._pull, row, column, this);\n\tthis._pull[row][column] = newData;\n}\n\nfunction get(rowId, columnId){\n\tif(!rowId)\n\t\treturn this._pull;\n\tif(!columnId)\n\t\treturn this._pull[rowId];\n\treturn this._pull[rowId]?this._pull[rowId][columnId]:null;\n}\n\nfunction add(rowId, columnId, condition, value, style){\n\tvar collection = addEmptyCollection(this._pull, rowId, columnId, this);\n\tcollection.push([condition, value, style]);\n}\n\nfunction remove(rowId, columnId){\n\tvar collection = this.get(rowId, columnId);\n\tif(collection)\n\t\tdelete this._pull[rowId][columnId];\n}\n\nfunction serialize(){\n\tvar column, condition, i, row,\n\t\tdata = [];\n\n\tfor( row in this._pull)\n\t\tfor( column in this._pull[row])\n\t\t\tfor(i=0; i < this._pull[row][column].length; i++){\n\t\t\t\tcondition = this._pull[row][column][i];\n\t\t\t\tdata.push([row,column, condition[0],condition[1],condition[2]]);\n\t\t\t}\n\n\treturn data;\n}\n\nfunction updatePosition(name, inc, data, start){\n\tlet conditions = data.conditions,\n\t\ti = conditions.length;\n\n\tif(inc){\n\t\twhile(i--){\n\t\t\tlet [row,column] = conditions[i];\n\t\t\tif(name == \"row\" && row>= start.row || name == \"column\" && column >= start.column){\n\t\t\t\tif (name == \"row\"){\n\t\t\t\t\tif (row < start.row - inc)\t//delete lock mark if row was deleted\n\t\t\t\t\t\tconditions.splice(i,1);\n\t\t\t\t\telse\t\t\t\t\t\t//update mark position if upper row was deleted\n\t\t\t\t\t\tconditions[i][0] = row*1 + inc;\n\t\t\t\t} else if (name == \"column\"){\n\t\t\t\t\tif (column < start.column - inc){\n\t\t\t\t\t\tconditions.splice(i, 1);\n\t\t\t\t\t} else \n\t\t\t\t\t\tconditions[i][1] = column*1 + inc;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport function clearConditionalFormats(view, range){\n\tgroup.set(function(){\n\t\teachRange(range, view, function(view, cell){\n\t\t\tvar condition = view.conditions.get(cell.row, cell.column);\n\t\t\tif(condition)\n\t\t\t\t_changeCondition(\"remove\", cell.row, cell.column, condition, null, view);\t\t\t\t\n\t\t});\n\t\tview.refresh();\n\t});\n}\n\nexport function pasteCondition(view, extra, row, col, cutted){\n\tvar condition = extra.condition;\n\tvar collection = view.conditions.get(row,col);\n\t_changeCondition(\"update\", row, col, (collection||null), condition, view);\n\tif(cutted === 1)\n\t\t_changeCondition(\"remove\", extra.row, extra.col, condition, null, view);\t\n\t\t\t\n}\n\nexport function _changeCondition(name, row, column, oldCondition, newCondition, view){\n\tif (view.callEvent(\"onBeforeConditionSet\", [row, column, oldCondition, newCondition])){\n\t\tview.conditions[name].apply(view.conditions, [row, column, newCondition]);\n\t\tview.callEvent(\"onAfterConditionSet\", [row, column, oldCondition, newCondition]);\n\t}\n}","import {setSpanCss} from \"./spans\";\nimport {rangeValue} from \"../math/ranges\";\nimport {changeRange, eachRange} from \"../helpers/column_names\";\n\nexport function init(view){\n\tconst table = view._table;\n\n\tview.attachEvent(\"onReset\", () => reset(view));\n\treset(view);\n\n\ttable.attachEvent(\"onBeforeEditStart\", function(id){\n\t\tlet col = this.getColumnConfig(id.column);\n\t\tif (this._ssEditors[id.row]){\n\t\t\tlet ed = this._ssEditors[id.row][id.column];\n\t\t\tif (ed){\n\t\t\t\twebix.extend(col, ed, true);\n\t\t\t\tif (ed.options){\n\t\t\t\t\tif (typeof ed.options == \"string\")\n\t\t\t\t\t\tcol.options = rangeValue(view, ed.options, { unique:true, order:true, empty:true });\n\t\t\t\t\telse if (webix.isArray(ed.options))\n\t\t\t\t\t\tcol.options = rangeValue(view, ed.options, { empty:true });\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n\n\ttable.attachEvent(\"onAfterEditStop\", function(state, editor){\n\t\tconst col = this.getColumnConfig(editor.column);\n\n\t\tcol.editor = \"text\";\n\t\tdelete col.popup; delete col.$popup;\n\t});\n\n\ttable.on_click.ss_editor = function(e, id){\n\t\tthis.edit(id);\n\t};\n\n\tview.attachEvent(\"onUndo\", (type, row, column, value) => {\n\t\tif (type == \"dropdown\")\n\t\t\tview.setCellEditor(row, column, value);\n\t});\n\n\tview.attachEvent(\"onAction\", (action, p) => {\n\t\tif (action == \"dropdown\"){\n\t\t\tsetSpanCss(view, p.row, p.column, \"ss_editor\", p.newValue);\n\t\t}\n\t\telse if (action == \"before-grid-change\")\n\t\t\tupdatePosition(p.name,p.inc,p.data, p.start);\n\t});\n}\n\nfunction reset(view){\n\tview._table._ssEditors = {};\n}\n\nexport function serialize(view,data){\n\tvar row, column,\n\t\ttblEditors = view._table._ssEditors,\n\t\teditors = [];\n\n\tfor (row in tblEditors){\n\t\tfor (column in tblEditors[row])\n\t\t\teditors.push([row, column, tblEditors[row][column]]);\n\t}\n\tdata.editors = editors;\n}\n\nexport function load(view,data){\n\tconst editors = data.editors;\n\n\tif (editors)\n\t\tfor (let i=0; i<editors.length; i++)\n\t\t\tview.setCellEditor.apply(view, editors[i]);\n}\n\nexport function clearEditors(view, range){\n\tview._table.editStop();\n\teachRange(range, view, function(view, cell){\n\t\tlet editor = view._table._ssEditors[cell.row];\n\t\tif (editor){\n\t\t\tif (editor[cell.column]){\n\t\t\t\tdelete editor[cell.column];\n\t\t\t\tview._table.removeCellCss(cell.row, cell.column, \"ss_editor\");\n\t\t\t\tsetSpanCss(view, cell.row, cell.column, \"ss_editor\", false);\n\t\t\t}\n\t\t}\n\t});\n}\n\nexport function isEditor(view, row, column){\n\tconst editor = view._table._ssEditors;\n\treturn editor[row] && !!editor[row][column];\n}\n\n// called on column/row add, delete, hide,show\nfunction updatePosition(name, inc, data, start){\n\tconst editors = data.editors;\n\n\tif (inc){\n\t\t// create new editors\n\t\tfor(let i=editors.length-1; i>=0; i--){\n\t\t\tlet [row,column,editor] = editors[i];\n\t\t\tif (name == \"row\" && row >= start.row || name == \"column\" && column >= start.column){\n\n\t\t\t\tif (name == \"row\"){\n\t\t\t\t\tif (row < start.row - inc){\t//delete editor mark if row was deleted\n\t\t\t\t\t\teditors.splice(i,1);\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t} else\t\t\t\t\t\t//update mark position if upper row was deleted\n\t\t\t\t\t\teditors[i][0] = row*1 + inc;\n\t\t\t\t}\n\t\t\t\telse if (name == \"column\"){\n\t\t\t\t\tif (column < start.column - inc){\n\t\t\t\t\t\teditors.splice(i, 1);\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t} else \n\t\t\t\t\t\teditors[i][1] = column*1 + inc;\n\t\t\t\t}\n\t\t\t\teditor.options = changeRange(editor.options, name, inc, start);\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport function pasteDropdown(view, extra, row, col, cutted){\n\tconst editor = extra.dropdown;\n\n\tview.setCellEditor(row, col, editor);\n\tif (cutted === 1)\n\t\tview.setCellEditor(extra.row, extra.col, {});\n}","import {getFormatName, checkFormat, isDateInvalid} from \"./formats\";\nimport {getExcelDateFromJs} from \"../math/methods/helpers\";\n\nexport function init(view){\n\tview.attachEvent(\"onCellChange\", function(row, col, value, type){\n\t\tif(!this._setType){\n\t\t\tconst format = getFormatName(this, row, col);\n\t\t\tsetType(this, row, col, format, type);\n\t\t}\n\t});\n\n\tview.attachEvent(\"onFormatChange\", function(row, col, format){\n\t\tif(!this._setType)\n\t\t\tsetType(this, row, col, format, null, true);\n\t});\n\n\tview.attachEvent(\"onAction\", function(action, values){\n\t\tif(action == \"dropdown\" && values.newValue && values.newValue.editor == \"excel_date\"){\n\t\t\tconst format = getFormatName(this, values.row, values.column);\n\t\t\tif(getFormatType(format) != \"date\")\n\t\t\t\tthis.setFormat(values.row, values.column, webix.i18n.spreadsheet.formats.dateFormat);\n\t\t}\n\t});\n}\n\nfunction getExpectType(view, row, col, value, parseDate, isFormula, formatType, style){\n\t//date based math\n\tlet type = \"string\";\n\tif(!webix.isUndefined(value)){\n\t\tif(isFormula){\n\t\t\ttype = \"number\";\n\t\t\tconst dateFormulas = [\"NOW\", \"DATE\", \"TIME\"];\n\t\t\tfor(let i = 0; i < dateFormulas.length; i++)\n\t\t\t\tif (value.toUpperCase().indexOf(dateFormulas[i] + \"(\") == 1){\n\t\t\t\t\ttype = \"date\"; break;\n\t\t\t\t}\n\t\t}\n\t\telse if(!isNaN(value))\n\t\t\ttype = \"number\";\n\t\telse if(formatType != \"string\"){\n\t\t\t//if user types a date string, or it comes from Excel import\n\t\t\t//set date type and convert string to Excel date\n\t\t\tvalue  = webix.i18n.fullDateFormatDate(value);\n\t\t\tif(!isNaN(value)*1){\n\t\t\t\tif(parseDate){\n\t\t\t\t\t//change cell style - value changes once (some value -> 35767.5)\n\t\t\t\t\t//change cell value - value changes twice (some value -> \"12/03/97\" -> 35767.5)\n\t\t\t\t\t//so ignore undo for cell value change\n\t\t\t\t\tif(style)\n\t\t\t\t\t\tdateToExcel(view, row, col, value);\n\t\t\t\t\telse\n\t\t\t\t\t\tview.ignoreUndo(() => dateToExcel(view, row, col, value));\n\t\t\t\t}\n\t\t\t\ttype = \"date\";\n\t\t\t}\n\t\t}\n\t}\n\treturn type;\n}\n\nfunction dateToExcel(view, row, col, value){\n\tvalue = getExcelDateFromJs(value);\n\tview.setCellValue(row, col, value);\n}\n\nfunction checkType(type, expectType, formatType, isFormula, value){\n\ttype = type || expectType;\n\n\t//strings will always have string type regardless of format\n\tif(expectType == \"string\")\n\t\ttype = \"string\";\n\telse if(formatType)\n\t\ttype = formatType;\n\n\tif(type == \"date\" && !isFormula && isDateInvalid(value))\n\t\ttype = \"number\";\n\n\treturn type;\n}\n\nfunction getFormatType(format){\n\tlet formatType = format ? \"number\" : null;\n\tif(checkFormat(format, \"string\"))\n\t\tformatType = \"string\";\n\telse if(checkFormat(format, \"date\"))\n\t\tformatType = \"date\";\n\treturn formatType;\n}\n\nexport function getType(view, row, column){\n\tconst types = view.getRow(row).$cellType;\n\tif (types && types[column])\n\t\treturn types[column];\n}\n\nfunction setType(view, row, col, format, type, style){\n\t//prevent type change during onCellChange\n\tview._setType = true;\n\tlet value = view.getCellValue(row, col);\n\n\tconst isFormula = typeof value == \"string\" && value[0] == \"=\";\n\tconst parseDate = !view._loading_data || type == \"date\";\n\n\tconst formatType = getFormatType(format);\n\tconst expectType = getExpectType(view, row, col, value, parseDate, isFormula, formatType, style);\n\n\ttype = checkType(type, expectType, formatType, isFormula, value);\n\tupdateCell(view, row, col, type, expectType, formatType);\n\n\tconst item = view.getRow(row);\n\tif(!item.$cellType)\n\t\titem.$cellType = {};\n\titem.$cellType[col] = type;\n\n\tdelete view._setType;\n}\n\nfunction updateCell(view, row, col, type, expectType, formatType){\n\tlet value = view.getCellValue(row, col);\n\tconst isFormula = typeof value == \"string\" && value[0] == \"=\";\n\tconst cellEditor = view.getCellEditor(row, col);\n\n\tif(type == \"date\"){\n\t\t// add default date format\n\t\tif(formatType != \"date\"){\n\t\t\tconst isTime = isFormula && value.toUpperCase().indexOf(\"=TIME(\") == 0;\n\t\t\tconst locale = webix.i18n.spreadsheet.formats;\n\t\t\tconst format = isTime ? locale.timeFormat : locale.dateFormat;\n\t\t\tview.setFormat(row, col, format);\n\t\t}\n\n\t\t//set date editor for cells with date type\n\t\tif(!isFormula && !cellEditor)\n\t\t\tview.setCellEditor(row, col, {editor: \"excel_date\"});\n\t}\n\telse{\n\t\t//remove date editor\n\t\tif(cellEditor && cellEditor.editor == \"excel_date\")\n\t\t\tview.setCellEditor(row, col, null);\n\n\t\t//force text format for numbers typed as strings\n\t\tif(formatType != \"string\" && type == \"string\" && expectType != \"string\")\n\t\t\tview.setFormat(row, col, \"@\");\n\t}\n}\n","import group from \"./undo_group\";\nimport {getType} from \"./types\";\nimport {setSpanCss} from \"./spans\";\nimport {rangeValue} from \"../math/ranges\";\nimport {changeRange, eachRange, toRange} from \"../helpers/column_names\";\n\nexport function init(view){\n\tconst table = view._table;\n\n\tview.attachEvent(\"onReset\", () => reset(view));\n\treset(view);\n\n\ttable.on_click.ss_filter = (e, id) => {\n\t\tconst filter = table._ssFilters[id.row][id.column];\n\t\tconst mode = getFilterMode(view, id.row, id.column);\n\n\t\tlet options = [];\n\t\tif (filter.options){\n\t\t\tif (typeof filter.options == \"string\")\n\t\t\t\toptions = rangeValue(view, filter.options, { unique:true, order:true, filter:true });\n\t\t\telse if (webix.isArray(filter.options))\n\t\t\t\toptions = rangeValue(view, filter.options, { filter:true });\n\t\t}\n\t\tview.callEvent(\"onCommand\", [{id:\"start-filter\", cell:id, mode, options, filter}]);\n\t};\n\n\ttable.attachEvent(\"onBeforeEditStart\", function(id){\n\t\tif (isFilter(view, id.row, id.column))\n\t\t\treturn false;\n\t});\n\n\tview.attachEvent(\"onCommand\", (cm) => {\n\t\tif (cm.id === \"create-filter\")\n\t\t\tcreateFilters(view);\n\t});\n\n\tview.attachEvent(\"onUndo\", (type, row, column, value) => {\n\t\tif (type == \"filter\"){\n\t\t\tvalue = (typeof value == \"object\") ? value : null;\n\t\t\tview.setCellFilter(row, column, value);\n\t\t}\n\t});\n\n\tview.attachEvent(\"onAction\", (action, p) => {\n\t\tif (action == \"filter\"){\n\t\t\tsetSpanCss(view, p.row, p.column, \"ss_filter\", p.newValue);\n\t\t\tif (!p.newValue)\n\t\t\t\tsetSpanCss(view, p.row, p.column, \"ss_filter_active\", p.newValue);\n\t\t}\n\t\telse if (action == \"before-grid-change\")\n\t\t\tupdatePosition(p.name, p.inc, p.data, p.start);\n\t});\n}\n\nfunction reset(view){\n\tview._table._ssFilters = {};\n}\n\nexport function getFilters(table){\n\tconst filters = table._ssFilters;\n\tconst all = [];\n\tfor (let row in filters)\n\t\tfor (let column in filters[row])\n\t\t\tall.push(filters[row][column]);\n\treturn all;\n}\n\nexport function serialize(view,data){\n\tconst filters = getFilters(view._table);\n\tconst result = data.filters = [];\n\n\tfor (let i = 0; i<filters.length; i++){\n\t\tlet {row, column} = filters[i];\n\t\tif (filters[i].options)\n\t\t\tresult.push([row, column, filters[i].options]);\n\t}\n}\n\nexport function load(view,data){\n\tconst filters = data.filters;\n\n\tif (filters){\n\t\tfor (let i = 0; i < filters.length; i++)\n\t\t\tview.setCellFilter(filters[i][0], filters[i][1], {options:filters[i][2]});\n\n\t\tview.filterSpreadSheet();\n\t}\n}\n\nexport function clearFilters(view, range){\n\tlet refilter = false;\n\teachRange(range, view, function(view, cell){\n\t\tlet filter = view._table._ssFilters[cell.row];\n\t\tif (filter){\n\t\t\tif (filter[cell.column]){\n\t\t\t\trefilter = true;\n\t\t\t\tdelete filter[cell.column];\n\n\t\t\t\tview._table.removeCellCss(cell.row, cell.column, \"ss_filter\");\n\t\t\t\tview._table.removeCellCss(cell.row, cell.column, \"ss_filter_active\");\n\n\t\t\t\tsetSpanCss(view, cell.row, cell.column, \"ss_filter\", false);\n\t\t\t\tsetSpanCss(view, cell.row, cell.column, \"ss_filter_active\", false);\n\t\t\t}\n\t\t}\n\t});\n\n\tif (refilter)\n\t\tview.filterSpreadSheet();\n}\n\nexport function isFilter(view, row, column){\n\tconst filters = view._table._ssFilters;\n\treturn filters[row] && !!filters[row][column];\n}\n\nexport function calibrateRange(view, row, column, range){\n\tif(!range)\n\t\trange = {end:{row:row}};\n\n\tif (range.end){\n\t\tvar endRow = range.end.row;\n\t\trange = getFilterRange(view, row, column, endRow);\n\t}\n\treturn range;\n}\n\nfunction getFilterRange(view, row, column, endRow){\n\tif (row === endRow){\n\t\tfor (endRow = row; endRow < view.config.rowCount; endRow++){\n\t\t\tif(!view.getCellValue(endRow+1, column))\n\t\t\t\tbreak;\n\t\t}\n\t}\n\treturn toRange(row+1, column, endRow, column);\n}\n\nfunction getFilterMode(view, row, column){\n\tfor (let i=row; i<view.config.rowCount; i++){\n\t\tconst item = view.getRow(i+1);\n\t\tconst value = item[\"$\"+column] || item[column];\n\n\t\tif (value || value === 0){\n\t\t\tconst type = getType(view, i+1, column);\n\t\t\treturn (type == \"number\") ? type : \"text\";\n\t\t}\n\t\telse if (value !== \"\")\n\t\t\tbreak;\n\t}\n\treturn \"text\";\n}\n\nfunction createFilters(view, range){\n\trange = range || view._table.getSelectArea();\n\n\tgroup.set(function(){\n\t\tview.removeFilter();\n\t\tif (!range) return;\n\n\t\tlet row = range.start.row;\n\t\tfor (let i=range.start.column; i<=range.end.column; i++){\n\t\t\tview.setCellFilter(row, i, { options:range });\n\t\t\tif (view.getCellValue(row, i) !== \"\")\n\t\t\t\tview.setCellValue(row, i, \"\");\n\t\t}\n\t});\n}\n\nfunction updatePosition(name, inc, data, start){\n\tconst filters = data.filters;\n\n\tif (inc){\n\t\tfor(let i=filters.length-1; i>=0; i--){\n\t\t\tlet [row,column,range] = filters[i];\n\t\t\tif (name == \"row\" && row >= start.row || name == \"column\" && column >= start.column){\n\n\t\t\t\tif (name == \"row\"){\n\t\t\t\t\tif (row < start.row - inc){\t//delete filter mark if row was deleted\n\t\t\t\t\t\tfilters.splice(i,1);\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t} else\t\t\t\t\t\t//update mark position if upper row was deleted\n\t\t\t\t\t\tfilters[i][0] = row*1 + inc;\n\t\t\t\t}\n\t\t\t\telse if (name == \"column\"){\n\t\t\t\t\tif (column < start.column - inc){\n\t\t\t\t\t\tfilters.splice(i, 1);\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t} else \n\t\t\t\t\t\tfilters[i][1] = column*1 + inc;\n\t\t\t\t}\n\t\t\t\tfilters[i][2] = changeRange(range, name, inc, start);\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport function pasteFilter(view, extra, row, col, cutted, translate){\n\tconst filter = extra.filter;\n\n\tfilter.options = changeRange(filter.options, \"row\", translate.row, {column:extra.col, row:extra.row});\n\tfilter.options = changeRange(filter.options, \"column\", translate.column, {column:extra.col, row:extra.row});\n\n\tdelete filter.value; delete filter.handler;\n\tview.setCellFilter(row, col, filter);\n}","import group from \"./undo_group\";\nimport {updateMath} from \"../math/updater\";\nimport {pasteCondition} from \"../operations/conditional_formats\";\nimport {pasteDropdown} from \"../operations/dropdown\";\nimport {pasteFilter} from \"../operations/filter\";\nimport {pasteSpan} from \"../operations/spans\";\n\nvar styledata, clipdata, origin, cutted, updateFilters;\n\nexport function init(view){\n\tconst keyC = 67; //keyboard 'c' code\n\tconst keyX = 88; //keyboard 'x' code\n\tvar grid = view.$$(\"cells\");\n\t\n\tgrid.attachEvent(\"onKeyPress\", (code, e) => {\n\t\tif((code === keyC || code === keyX) && (e.ctrlKey || e.metaKey) && grid.getSelectedId()){\n\t\t\tstyledata = _get_sel_style(view, grid);\n\t\t\tclipdata = document.getElementsByClassName(\"webix_clipbuffer\")[0].value;\n\t\t\torigin = grid.getSelectArea();\n\t\t\tcutted = (code === keyX)*1;\n\t\t\tif(cutted && Object.keys(view._table._ssFilters).length !== 0)\n\t\t\t\tupdateFilters = allFiltersInZone(view._table._ssFilters, origin, view.config.columnCount);\n\t\t}\n\t});\n\n\tif (!view.config.readonly) {\n\t\tgrid.attachEvent(\"onPaste\", (text) => {\n\t\t\t_clip_to_sel(view, grid, text);\n\t\t});\n\t}\n}\n\nfunction _clip_to_sel(view, grid, text){\n\tvar leftTop = grid.getSelectArea();\n\tif (!leftTop) return;\n\tvar start = leftTop.start;\n\tvar fromSheet = text === clipdata;\n\n\tvar data = fromSheet ? styledata : webix.csv.parse(text, grid.config.delimiter);\n\tif(!fromSheet && view.config.clipboardDecimalDelimiter)\n\t\tdata = _changeDelimiter(data, view.config.clipboardDecimalDelimiter);\n\n\tvar translate = { id:\"move\", column:0, row: 0, cut:cutted };\n\tif (fromSheet){\n\t\ttranslate.column = start.column - origin.start.column;\n\t\ttranslate.row = start.row - origin.start.row;\n\t} else {\n\t\tcutted = 0;\n\t}\n\n\tgroup.set(function(){\n\t\tif (updateFilters)\n\t\t\tview.removeFilter();\n\n\t\t_add_row_col(view, start, data);\n\n\t\tif (cutted === 1) {\n\t\t\tfor (let row = origin.start.row; row <= origin.end.row; row++) {\n\t\t\t\tfor (let column = origin.start.column; column <= origin.end.column; column++) {\n\t\t\t\t\tview.setCellValue(row, column, null);\n\t\t\t\t\tview.setStyle(row, column, null);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (data.length == 1 && data[0].length == 1 && !updateFilters) {\n\t\t\tview.eachSelectedCell(function(cell) {\n\t\t\t\tvar subtrans = {\n\t\t\t\t\tid: \"move\",\n\t\t\t\t\tcolumn: translate.column + cell.column * 1 - start.column,\n\t\t\t\t\trow: translate.row + cell.row * 1 - start.row,\n\t\t\t\t\tcut:cutted\n\t\t\t\t};\n\t\t\t\t_clipboardToTable(view, cell.row, cell.column, data[0][0], fromSheet, subtrans);\n\t\t\t});\n\t\t} else {\n\t\t\tgrid.mapCells(\n\t\t\t\tstart.row,\n\t\t\t\tstart.column,\n\t\t\t\tdata.length,\n\t\t\t\tnull,\n\t\t\t\tfunction(value, row, col, row_ind, col_ind) {\n\t\t\t\t\tif (data[row_ind] && data[row_ind].length > col_ind) {\n\t\t\t\t\t\tvar cdata = data[row_ind][col_ind];\n\t\t\t\t\t\t_clipboardToTable(view, row, col, cdata, fromSheet, translate);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\ttrue\n\t\t\t);\n\t\t}\n\n\t\tif (cutted === 1){\n\t\t\t//cut and cleared\n\t\t\tcutted = 2;\n\t\t\tupdateFilters = false;\n\t\t}\n\t});\n\t\n\tview.refresh();\n}\n\nfunction _clipboardToTable(view, row, col, cdata, fromSheet, translate){\n\tvar newValue = cdata;\n\n\tif (typeof cdata === \"object\"){\n\t\tif (cdata.math)\n\t\t\tnewValue = updateMath(cdata.math, translate, origin);\n\t\telse \n\t\t\tnewValue = cdata.text;\n\n\t\tif(cdata.style && cdata.style.props){\n\t\t\tconst style = view.addStyle(cdata.style.props);\n\t\t\tview.setStyle(row, col, style);\n\t\t}\n\n\t\tvar extra = cdata.extra;\n\t\tif(extra){\n\t\t\tif(extra.condition)\n\t\t\t\tpasteCondition(view, extra, row, col, cutted);\n\t\t\tif(extra.dropdown)\n\t\t\t\tpasteDropdown(view, extra, row, col, cutted, translate);\n\t\t\tif(extra.filter && updateFilters)\n\t\t\t\tpasteFilter(view, extra, row, col, cutted, translate);\n\t\t}\n\t\tpasteSpan(view, extra, row, col, cutted, translate);\n\t}\n\n\tview.setCellValue(row, col, newValue);\n}\n\nfunction _get_sel_style(view, grid){\n\tvar data = [];\n\tvar row, last;\n\n\tgrid.mapSelection(function(value, id, col) {\n\t\tif (id != last){\n\t\t\trow = []; data.push(row);\n\t\t\tlast = id;\n\t\t}\n\n\t\tvar item = grid.getItem(id);\n\t\tvar math = item[\"$\"+col];\n\t\tvar obj = { text:value, math:math, style:view.getStyle(id, col) };\n\n\t\tvar condition = view.conditions.get(id,col);\n\t\tvar editor = view.getCellEditor(id, col);\n\t\tvar filter = view.getCellFilter(id, col);\n\t\tvar span = view._table.getSpan(id, col);\n\n\t\tif (editor || filter || condition || span){\n\t\t\tvar extra = { row:id, col:col };\n\t\t\tif (condition) extra.condition = condition;\n\t\t\tif (editor) extra.dropdown = editor;\n\t\t\tif (filter) extra.filter = filter;\n\t\t\tif (span) extra.span = span;\n\t\t\tobj.extra = extra;\n\t\t}\n\t\t\n\t\trow.push(obj);\n\t\treturn value;\n\t});\n\n\treturn data;\n}\n\nfunction allFiltersInZone(extra, origin, columnCount){\n\tvar filters = Object.keys(extra);\n\tvar startRow = Math.min.apply(null, filters);\n\tvar endRow = Math.max.apply(null, filters);\n\tvar startCol = columnCount;\n\tvar endCol = 1;\n\n\tfor (var i = startRow; i <= endRow; i++){\n\t\tif(extra[i]){\n\t\t\tvar columns = Object.keys(extra[i]);\n\t\t\tstartCol = Math.min(startCol, Math.min.apply(null, columns));\n\t\t\tendCol = Math.max(endCol, Math.max.apply(null, columns));\n\t\t}\n\t}\n\n\tif(origin.start.row <= startRow && origin.end.row >= endRow && origin.start.column <= startCol && origin.end.column >= endCol)\n\t\treturn true;\n\telse\n\t\treturn false;\n}\n//dynamically increase rows and columns according to pasted data size\nfunction _add_row_col(view, start, data){\n\tvar maxRow = start.row + data.length - 1;\n\tvar maxCol = start.column + data[0].length - 1;\n\n\tif(maxRow > view.config.rowCount || maxCol > view.config.columnCount){\n\t\tvar action = { id:\"add\" };\n\t\tif (maxRow > view.config.rowCount) {\n\t\t\taction.group = \"row\";\n\t\t\tview.callEvent(\"onCommand\", [\n\t\t\t\taction, \n\t\t\t\t{ row: view.config.rowCount + 1 }, \n\t\t\t\t{ row: maxRow }\n\t\t\t]);\n\t\t}\n\t\tif (maxCol > view.config.columnCount) {\n\t\t\taction.group = \"column\";\n\t\t\tview.callEvent(\"onCommand\", [\n\t\t\t\taction, \n\t\t\t\t{ column: view.config.columnCount + 1 },\n\t\t\t\t{ column: maxCol }\n\t\t\t]);\n\t\t}\n\t}\n}\n\nfunction _changeDelimiter(data, clipboardDecimalDelimiter){\n\tfor(var i = 0; i < data.length; i++)\n\t\tfor(var k = 0; k < data[i].length; k++){\n\t\t\tvar record = data[i][k].toString().replace(clipboardDecimalDelimiter, \".\");\n\t\t\tif(webix.rules.isNumber(record))\n\t\t\t\tdata[i][k] = record;\n\t\t}\n\treturn data;\n}","import {getType} from \"./types\";\n\nexport function init(view){\n\t//parsing initial data\n\tview.attachEvent(\"onDataParse\", (data) => _parse(view, data));\n\tview.attachEvent(\"onDataSerialize\", (data, config) => _serialize(view, data, config));\n\n\t// undo\n\tview.attachEvent(\"onUndo\", (type, row, column, value) => {\n\t\tif(type == \"value\")\n\t\t\t_undoValue(view, row, column, value);\n\t});\n}\n\nfunction _serialize(view, obj, config){\n\tvar math = !config || config.math!==false;\n\tvar data = [];\n\tvar grid = view.$$(\"cells\");\n\tvar state = grid.getState();\n\tvar columns = state.ids.concat(state.hidden);\n\n\t// remove \"rowId\" column\n\tcolumns.splice(columns.indexOf(\"rowId\"), 1);\n\n\tgrid.eachRow(function(row){\n\t\tconst item = this.getItem(row);\n\t\tfor (var i=0; i<columns.length; i++){\n\t\t\tconst key = columns[i];\n\t\t\tlet value = item[key];\n\t\t\tconst css = item.$cellCss ? (item.$cellCss[key] || \"\") : \"\";\n\n\t\t\t//serialize instead of value if defined\n\t\t\tif (math)\n\t\t\t\tvalue = item[\"$\"+key] || value;\n\n\t\t\t//put not empty values in serialization\n\t\t\tconst hasValue = value || value === 0;\n\t\t\tif (hasValue || css) {\n\t\t\t\tconst type = getType(view, row, key);\n\t\t\t\tdata.push([row*1, key*1, (hasValue ? value : \"\"), css, type]);\n\t\t\t}\n\t\t}\n\t}, true);\n\tobj.table = {\n\t\tfrozenColumns : (view._frozenColumns || 0),\n\t\tfrozenRows : (view._frozenRows || 0)\n\t};\n\n\tobj.data = data;\n}\n\nfunction _parse(view, obj){\n\tvar grid = view.$$(\"cells\");\n\n\tvar tconfig = obj.table || { frozenColumns : 0, frozenRows : 0 };\n\tview._frozenColumns = view._frozenRows = 0;\n\tif (tconfig){\n\t\tif (!webix.isUndefined(tconfig.frozenColumns) && (tconfig.frozenColumns+1) != grid.config.leftSplit)\n\t\t\tview.freezeColumns(tconfig.frozenColumns);\n\t\tif (!webix.isUndefined(tconfig.frozenRows) && tconfig.frozenRows != grid.config.topSplit)\n\t\t\tview.freezeRows(tconfig.frozenRows);\n\t}\n\n\tif(obj.sizes)\n\t\tgrid.define(\"fixedRowHeight\", false);\n\n\tfor (var i = 0; i < obj.data.length; i++){\n\t\tvar [ row, column, value, , type ] = obj.data[i];\n\n\t\tvar item = grid.getItem(row);\n\t\titem[column] = value;\n\n\t\t//cell value can be updated via types module\n\t\tview.ignoreUndo(()=>{\n\t\t\tview.callEvent(\"onCellChange\", [row, column, value, type]);\n\t\t});\n\t}\n}\n\nfunction _undoValue(view, row, column, value){\n\tview.setCellValue(row, column, value);\n}","export function init(view) {\n\tview.attachEvent(\"onCommand\", (action) => {\n\t\tif (action.id == \"show\" || action.id == \"hide\"){\n\t\t\tconst sel = view._table.getSelectArea();\n\t\t\tif (sel)\n\t\t\t\tprocess(action, sel.start, sel.end, view);\n\t\t}\n\t});\n\treset(view);\n\n\tview.attachEvent(\"onUndo\", (action, row, column, value, direction) => {\n\t\tif ((action.id == \"hide\" || action.id == \"show\") && (action.group == \"column\" || action.group == \"row\")){\n\t\t\tlet type = action.id;\n\t\t\tif (!direction)\n\t\t\t\ttype = type == \"hide\" ? \"show\" : \"hide\";\n\t\t\tconst obj = (row || column);\n\t\t\tprocess({ id: type, group: action.group }, obj.start, obj.end, view, true);\n\t\t}\n\t});\n\n\tview.attachEvent(\"onHardReset\", () => reset(view));\n\n\tview.attachEvent(\"onAction\", (action, p)=> {\n\t\tif(action == \"before-grid-change\")\n\t\t\t_updatePosition(view, p.name,p.inc,p.data, p.start);\n\t});\n}\n\nexport function reset(view, mode) {\n\tif(mode) view[\"_hidden_\"+mode+\"_hash\"] = {};\n\telse{\n\t\tview._hidden_cols_hash = {};\n\t\tview._hidden_rows_hash = {};\n\t}\n}\n\nfunction getIds(id){\n\treturn webix.isArray(id) ? id : [id, id];\n}\n\nexport function isColumnVisible(view, column){\n\treturn !view._hidden_cols_hash[column];\n}\n\nexport function setState(view, indexes, state, type){\n\t// hide\n\tif(!indexes){\n\t\tconst sel = view.getSelectedId(true);\n\t\tconst action = {\n\t\t\tid: state === false ? \"show\" : \"hide\",\n\t\t\tgroup: type\n\t\t};\n\n\t\tif(sel.length)\n\t\t\tview.callEvent(\"onCommand\", [action, sel[0], sel[sel.length-1]]);\n\t}\n\telse {\n\t\tconst ids = getIds(indexes);\n\t\tconst hidden = type == \"row\" ? view._hidden_rows_hash : view._hidden_cols_hash;\n\n\t\tif (!hidden[ids[0]] && (webix.isUndefined(state) || state)){\n\t\t\t(type == \"row\" ? _hideRow : _hideColumn)({id: \"hide\", group: type}, {[type]: ids[0]}, {[type]: ids[1]}, view);\n\t\t}\n\t\t// show\n\t\telse if (hidden[ids[0]] && (webix.isUndefined(state) || !state)) {\n\t\t\tconst inc = ids[0] > 1 ? 1 : -1;\n\t\t\t(type == \"row\" ? _showRow : _showColumn)({id: \"hide\", group: type}, {[type]: ids[0] + inc}, {[type]: ids[1] + inc}, view);\n\t\t}\n\t}\n}\n\nexport function isRowVisible(view, row){\n\treturn !view._hidden_rows_hash[row];\n}\n\nexport function serialize(view, data){\n\tlet hrows  = []; let hcols = [];\n\tfor(let r in view._hidden_rows_hash) hrows.push(r);\n\tfor(let c in view._hidden_cols_hash) hcols.push(c);\n\n\tif(hrows.length || hcols.length)\t\n\t\tdata.table.hidden = {};\n\tif(hrows.length)\n\t\tdata.table.hidden.row = hrows;\n\tif(hcols.length)\n\t\tdata.table.hidden.column = hcols;\n}\n\nexport function load(view, data){\n\treset(view);\n\t\n\tif(!webix.isUndefined(data.table) && !webix.isUndefined(data.table.hidden)){\n\t\tconst hidden = data.table.hidden;\n\n\t\tif(hidden.row && hidden.row.length){\n\t\t\tfor(let r = 0; r < hidden.row.length; r++)\n\t\t\t\t_hideRow({id:\"hide\", group:\"row\"}, {row:hidden.row[r]}, {row:hidden.row[r]}, view, true);\n\t\t}\n\n\t\tif(hidden.column && hidden.column.length){\n\t\t\tfor(let c = 0; c < hidden.column.length; c++)\n\t\t\t\t_hideColumn({id:\"hide\", group:\"column\"}, {column:hidden.column[c]}, {column:hidden.column[c]}, view, true);\n\t\t}\n\t}\n}\n\nfunction process(action) {\n\tif (action.group == \"column\"){\n\t\tif (action.id == \"show\")\n\t\t\t_showColumn.apply(this, arguments);\n\t\telse if (action.id == \"hide\")\n\t\t\t_hideColumn.apply(this, arguments);\n\t} else if (action.group == \"row\") {\n\t\tif (action.id == \"show\")\n\t\t\t_showRow.apply(this, arguments);\n\t\telse if (action.id == \"hide\")\n\t\t\t_hideRow.apply(this, arguments);\n\t}\n}\n\nfunction _showColumn(action, start, end, view, silent) {\n\tlet i = end.column;\n\tconst grid = view.$$(\"cells\");\n\n\twhile (i >= start.column) {\n\t\tlet id = i;\n\t\tif (!silent)\n\t\t\tid = view._hidden_cols_hash[i*1-1] || view._hidden_cols_hash[i*1+1] || false;\n\n\t\tif (id !== false) {\n\t\t\tdelete view._hidden_cols_hash[id];\n\t\t\tlet cell = grid.getColumnConfig(id - 1 || \"rowId\").header[0];\n\t\t\tcell.css = cell.css.replace(\"webix_ssheet_hide_column\", \"\");\n\t\t\tgrid.showColumn(id);\n\t\t\tstart.column = start.column < id ? start.column : id;\n\t\t\tend.column = end.column > id ? end.column : id;\n\n\t\t\tif (!silent)\n\t\t\t\tview.callEvent(\"onColumnOperation\", [action, { column: id }, { column:id }, null]);\n\t\t}\n\t\ti--;\n\t}\n}\n\nfunction _showRow(action, start, end, view, silent) {\n\tlet i = end.row;\n\tconst grid = view.$$(\"cells\");\n\n\tconst split = view._frozenRows;\n\tif(split+1 >= start.row){\n\t\t//Frozen rows ignore filtering applied to the datatable\n\t\tview.freezeRows(0);\n\t}\n\n\twhile (i >= start.row) {\n\t\tlet id = i;\n\t\tif (!silent)\n\t\t\tid = view._hidden_rows_hash[i*1-1] || view._hidden_rows_hash[i*1+1] || false;\n\n\t\tif (id !== false) {\n\t\t\tdelete view._hidden_rows_hash[id];\n\t\t\tif (id - 1 === 0) {\n\t\t\t\tlet cell = grid.getColumnConfig(\"rowId\").header[0];\n\t\t\t\tcell.css = cell.css.replace(\"webix_ssheet_hide_row\", \"\");\n\t\t\t\tgrid.refreshColumns();\n\t\t\t} else {\n\t\t\t\tgrid.removeCellCss(id - 1, \"rowId\", \"webix_ssheet_hide_row\");\n\t\t\t}\n\t\t\tif (!silent)\n\t\t\t\tview.callEvent(\"onRowOperation\", [action, { row: id }, { row: id }, null]);\n\t\t}\n\t\ti--;\n\t}\n\n\tgrid.filter(function(obj) {\n\t\treturn !view._hidden_rows_hash[obj.id];\n\t});\n\n\tif(split+1 >= start.row)\n\t\tview.freezeRows(split);\n}\n\nfunction _hideColumn(action, start, end, view, silent) {\n\tconst grid = view.$$(\"cells\");\n\tlet i = end.column;\n\tview.$handleSelection = null;\n\tgrid.unselect();\n\n\tif (end.column<1 || start.column<1){\n\t\tdelete view._hidden_cols_hash[start.column];\n\t\treturn;\n\t}\n\twhile (i >= start.column) {\n\t\tview._hidden_cols_hash[i] = i;\n\n\t\tlet cell = grid.getColumnConfig(i - 1 || \"rowId\").header[0];\n\t\tcell.css = (cell.css || \"\") + \" webix_ssheet_hide_column\";\n\n\t\tgrid.hideColumn(i);\n\t\ti--;\n\t}\n\n\tif (!silent)\n\t\tview.callEvent(\"onColumnOperation\", [action, start, end, null]);\n}\n\nfunction _hideRow(action, start, end, view, silent) {\n\tif (end.row<1 || start.row<1){\n\t\tdelete view._hidden_rows_hash[start.row];\n\t\treturn;\n\t}\n\n\tconst split = view._frozenRows;\n\tif(split >= start.row){\n\t\t//Frozen rows ignore filtering applied to the datatable\n\t\tview.freezeRows(0);\n\t}\n\n\tconst grid = view.$$(\"cells\");\n\tlet i = end.row;\n\n\twhile (i >= start.row) {\n\t\tview._hidden_rows_hash[i] = i;\n\n\t\tif (i - 1 === 0) {\n\t\t\tlet cell = grid.getColumnConfig(\"rowId\").header[0];\n\t\t\tcell.css = (cell.css || \"\") + \" webix_ssheet_hide_row\";\n\t\t\tgrid.refreshColumns();\n\t\t}\n\t\telse\n\t\t\tgrid.addCellCss(i - 1, \"rowId\", \"webix_ssheet_hide_row\");\n\n\t\ti--;\n\t}\n\n\tgrid.filter(function(obj) {\n\t\treturn !view._hidden_rows_hash[obj.id];\n\t});\n\n\tif(split >= start.row)\n\t\tview.freezeRows(split);\n\n\tif (!silent)\n\t\tview.callEvent(\"onRowOperation\", [action, start, end, null]);\n}\n\nfunction _updatePosition(view, name, inc, data, start){\n\tif(data.table && data.table.hidden && data.table.hidden[name] && data.table.hidden[name].length){\n\t\tif(name ===\"column\") reset(view, \"cols\");\n\t\tif(name === \"row\") reset(view, \"rows\");\n\n\t\tlet s = start[name], e = s + inc;\n\t\tif(s > e) [s, e] = [e, s];\n\n\t\tfor(let i = s; i < e; i++){\n\t\t\tfor(let h = 0; h < data.table.hidden[name].length; h++){\n\t\t\t\tif(data.table.hidden[name][h] >= i)\n\t\t\t\t\tdata.table.hidden[name][h] = data.table.hidden[name][h]*1+(inc>0 ? 1: -1);\n\t\t\t}\n\t\t}\n\t}\n}","import {getStyle, getTextSize} from \"./styles\";\nimport {save} from \"./save\";\n\nexport function init(view){\n\n\tif (view.config.resizeCell){\n\t\tvar grid = view.$$(\"cells\");\n\t\tgrid.define(\"resizeRow\", { headerOnly: true, size: 10 });\n\t\tgrid.define(\"resizeColumn\", { headerOnly: true, size: 10 });\n\t\tgrid.define(\"fixedRowHeight\", false);\n\n\t\tgrid.attachEvent(\"onRowResize\", (id) => {\n\t\t\tview.$$(\"cells\").refreshSelectArea();\n\t\t\tsave(view, \"sizes\", { row: id, column: 0, size: view.getRow(id).$height });\n\t\t});\n\t\tgrid.attachEvent(\"onColumnResize\", (id) => {\n\t\t\tview.$$(\"cells\").refreshSelectArea();\n\t\t\tsave(view, \"sizes\", { row: 0, column: id, size: view.getColumn(id).width });\n\t\t});\n\n\t\t// undo\n\t\tview.attachEvent(\"onUndo\", (type, row, column, value) => {\n\t\t\tif(type == \"c-resize\" || type == \"r-resize\")\n\t\t\t\t_undoResize(view, row, column, value);\n\t\t});\n\t}\n\n\tview.attachEvent(\"onDataParse\", (data) => {\n\t\tif (data.sizes){\n\t\t\tfor (var i=0; i<data.sizes.length; i++){\n\t\t\t\tvar size = data.sizes[i];\n\t\t\t\tif (size[0]*1 !== 0){\n\t\t\t\t\tvar row = view.getRow(size[0]);\n\t\t\t\t\tif(row) row.$height = size[2]*1;\n\t\t\t\t} else {\n\t\t\t\t\tvar col = view.getColumn(size[1]);\n\t\t\t\t\tif(col) col.width = size[2]*1;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (data.sizes.length)\n\t\t\t\tview.refresh(true);\n\t\t}\n\t});\n\n\t\n\tview.attachEvent(\"onDataSerialize\", (data) => {\n\t\tvar sizes = [];\n\t\tvar grid = view.$$(\"cells\");\n\t\tvar columns = grid.getState().order;\n\t\tvar order = grid.data.order;\n\n\t\tvar defWidth = grid.config.columnWidth;\n\t\tvar defHeight = grid.config.rowHeight;\n\n\t\tfor (let i = 1; i < columns.length; i++){\n\t\t\tvar width = grid.getColumnConfig(columns[i]).width;\n\t\t\tif (width && width != defWidth)\n\t\t\t\tsizes.push([0, i, width]);\n\t\t}\n\n\t\tfor (let i = 0; i < order.length; i++){\n\t\t\tvar height = grid.getItem(order[i]).$height;\n\t\t\tif (height && height != defHeight)\n\t\t\t\tsizes.push([order[i]*1, 0, height]);\n\t\t}\n\t\t\n\t\tdata.sizes = sizes;\n\t});\n\n\tview.attachEvent(\"onAction\", (action, p)=> {\n\t\tif(action == \"before-grid-change\")\n\t\t\tupdatePosition(p.name,p.inc,p.data, p.start);\n\t});\n\n\tview.attachEvent(\"onBeforeStyleChange\", function(row, column, n, o){\n\t\tif (o && o.props.wrap === \"wrap\" && (!n || n.props.wrap != o.props.wrap)){\n\t\t\tdelete view._table.getItem(row).$height;\n\t\t}\n\t});\n\tview.attachEvent(\"onStyleChange\", _adjustRowHeight);\n\tview.attachEvent(\"onCellChange\",  _adjustRowHeight);\n}\n\nfunction _undoResize(view, row, column, value){\n\tif(row){\n\t\tview.$$(\"cells\").getItem(row).$height = value;\n\t\tsave(view, \"sizes\", { row:row, column: 0, size: value });\n\t}\n\telse{\n\t\tview._table.setColumnWidth(column, value);\n\t}\n\t// update area selection\n\tview._table.refreshSelectArea();\n}\n\nfunction updatePosition(name, inc, data, start){\n\tlet i,\n\t\tsizes = data.sizes,\n\t\tnsizes = [];\n\n\tif(inc){\n\t\tfor(i = sizes.length-1;i >=0;i--){\n\t\t\tlet [row,column,size] = sizes[i];\n\t\t\tif(row && name == \"row\" && row>= start.row || column && name == \"column\" && column >= start.column){\n\t\t\t\t//moving row|column index\n\t\t\t\trow =  name == \"row\"?row*1 + inc:row;\n\t\t\t\tcolumn = name == \"column\"?column*1 + inc:column;\n\t\t\t\tif((name == \"row\" && row>0) || (name == \"column\" && column >0))\n\t\t\t\t\tnsizes.push([row, column, size]);\n\t\t\t} else //row, column not affected by resize\n\t\t\t\tnsizes.push(sizes[i]);\n\t\t}\n\t\tdata.sizes = nsizes;\n\t}\n}\n\nfunction _adjustRowHeight(row, column){\n\tconst view = this;\n\tlet style = getStyle(view, {row:row, column:column});\n\n\t//changing styles or content of wrapped cell -> resize the related row\n\tif (style && style.props.wrap){\n\t\tlet item = view._table.getItem(row);\n\t\tlet height = item.$height || view._table.config.rowHeight;\n\n\t\tview._table.eachColumn(function(col, config){\n\t\t\tlet style = getStyle(view, {row:row, column:col});\n\t\t\t//include only cells with active wrap into calculation \n\t\t\tif(style && style.props && style.props.wrap === \"wrap\"){\n\t\t\t\tlet text = this.getText(row, col);\n\t\t\t\theight = Math.max(height, getTextSize(view, text, style.id, config.width).height);\n\t\t\t}\n\t\t});\n\n\t\titem.$height  = height;\n\t}\n}\n","import {encode} from \"../helpers/column_names\";\n\nexport function init(view){\n\tvar table = view._table;\n\n\tvar bs = 0;\n\ttable.attachEvent(\"onAreaDrag\", () => bs = new Date());\n\ttable.attachEvent(\"onBeforeAreaRemove\", function(){\n\t\t//[FIXME] currently we don't have enough info to know\n\t\t//is user selects new area, and removing need to be blocked\n\t\t//or is it some API which attempts to remove the area\n\t\tif (view.$handleSelection && (new Date() - bs)<500) return false;\n\t});\n\n\ttable.attachEvent(\"onBeforeAreaAdd\", (area) => {\n\t\t//[FIXME] \n\t\t//block selection of row-id column\n\t\t//temporary fix, we need to fire onBeforeBlockSelect when selection moves\n\t\t//so the common onBeforeBlockSelect handler will block rowId selection\n\t\tif (area.start.column == \"rowId\") return false;\n\n\t\t//if we have an active editor, we need to close it on block selection\n\t\t//ignore, when selecting the editor's cell\n\t\tvar editor = table.getEditor();\n\t\tif (editor && (\n\t\t\teditor.row != area.start.row || editor.column != area.start.column ||\n\t\t\teditor.row != area.start.row || editor.column != area.start.column ))\n\t\t\ttable.editStop();\n\n\t\tif (!view.$handleSelection) return true;\n\t\t\n\n\t\tlet blockStart = encode[area.start.column] + area.start.row;\n\t\tlet blockEnd = encode[area.end.column] + area.end.row;\n\n\t\tvar res = view.$handleSelection(area.start, area.end, blockStart, blockEnd);\n\n\t\tif (res !== false){\n\t\t\tview.$handleSelection = null;\n\t\t\ttable.removeSelectArea();\n\t\t}\n\n\t\treturn res;\n\t});\n\n\twebix.event(table.$view, \"mousedown\", function(e){\n\t\tif (view.$handleSelection)\n\t\t\treturn webix.html.preventEvent(e);\n\t});\n}\n","export function expandSelection(r, view){\n\tlet maxY = view.config.rowCount;\n\tlet maxX = view.config.columnCount;\n\tlet table = view._table;\n\n\tlet nr1 = r.start.row, nr2 = r.end.row, nc1 = r.start.column, nc2 = r.end.column;\n\n\tfor (let i=nr1-1; i>0; i--){\n\t\tif (getValue(i, r.start.column, table))\n\t\t\tnr1 = i;\n\t\telse\n\t\t\tbreak;\n\t}\n\n\tfor (let i=nr2+1; i<maxY; i++){\n\t\tif (getValue(i, r.end.column, table))\n\t\t\tnr2 = i;\n\t\telse\n\t\t\tbreak;\n\t}\n\n\tfor (let i=nc1-1; i>0; i--){\n\t\tif (getValue(r.start.row, i, table))\n\t\t\tnc1 = i;\n\t\telse\n\t\t\tbreak;\n\t}\n\n\tfor (let i=nc2+1; i<maxX; i++){\n\t\tif (getValue(r.end.row, i, table))\n\t\t\tnc2 = i;\n\t\telse\n\t\t\tbreak;\n\t}\n\n\tlet newrange = { start:{ row:nr1, column:nc1 } , end:{ row: nr2, column: nc2 }};\n\tif (nr1 != r.start.row || nr2 != r.end.row || nc1 != r.start.column || nc2 != r.end.column){\n\t\tview._table.addSelectArea(newrange.start, newrange.end);\n\t}\n\n\treturn newrange;\n}\n\nfunction getValue(r,c, table){\n\tvar value = table.getItem(r)[c];\n\tif(value === undefined || value === \"\"){\n\t\treturn false;\n\t} else {\n\t\treturn true;\n\t}\n}","import {expandSelection} from \"../helpers/expand_selection\";\nimport {updateMath} from \"../math/updater\";\nimport {rangeObj} from \"../helpers/column_names\";\nimport group from \"./undo_group\";\nimport {_changeCondition} from \"./conditional_formats\";\n\nexport function init(view){\n\tview.attachEvent(\"onCommand\", (cm) => {\n\t\tif (cm.id === \"sort-asc\" || cm.id === \"sort-desc\")\n\t\t\tsortRange(view, null, cm.id.replace(\"sort-\",\"\"));\n\t});\n}\n\nconst sorters = {\n\t\"int\":function(dir, key){\n\t\treturn (a,b) => {\n\t\t\tlet c = parseFloat(a[key]) || -Infinity;\n\t\t\tlet d = parseFloat(b[key]) || -Infinity;\n\t\t\treturn (c > d ? 1 : (c == d ? 0 : -1))*dir;\n\t\t};\n\t},\n\t\"str\":function(dir, key){\n\t\treturn (a,b) => {\n\t\t\tlet c = (a[key] || \"\").toString().toLowerCase();\n\t\t\tlet d = (b[key] || \"\").toString().toLowerCase();\n\t\t\treturn (c > d ? 1 : (c == d ? 0 : -1))*dir;  \n\t\t};\n\t}\n};\n\nexport function sortRange(view, range, dir, type){\n\trange = range || view._table.getSelectArea();\n\n\tif (range){\n\t\trange = rangeObj(range, view);\n\t\tlet fullrange = range;\n\t\tif (range.start.row === range.end.row)\n\t\t\tfullrange = expandSelection(range, view);\n\n\t\tlet key = view.getRow(range.start.row)[range.start.column];\n\t\ttype = type || (isNaN(parseFloat(key)) ? \"str\" : \"int\");\n\t\tdir = (!dir || dir === \"asc\") ? 1 : -1;\n\t\tgroup.set(()=>\n\t\t\tsort(fullrange, range.start.column, type, dir, view)\n\t\t);\n\t}\n}\n\nfunction sort(range, by, type, dir, view){\n\tfor (let column = range.start.column; column <= range.end.column; column++){\n\t\t//get all selected column values\n\t\tconst values = [];\n\t\tfor (let row = range.start.row; row <= range.end.row; row++) {\n\t\t\tif(view.isRowVisible(row)){\n\t\t\t\tconst fullRow = view.getRow(row);\n\t\t\t\tlet value = fullRow[column];\n\t\t\t\tlet style = view.getStyle(row, column);\n\t\t\t\tlet math = fullRow[\"$\"+column];\n\t\t\t\tlet conditions = view.conditions.get(row,column);\n\t\t\t\tif(conditions)\n\t\t\t\t\t_changeCondition(\"remove\", row, column, conditions, null, view);\n\n\t\t\t\tvalues.push({\n\t\t\t\t\tvalue: value,\n\t\t\t\t\tstyle: style,\n\t\t\t\t\tmath: math,\n\t\t\t\t\trow: row,\n\t\t\t\t\tconditions: conditions\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\t//sort them\n\t\tvalues.sort(sorters[type](dir, \"value\"));\n\n\t\t//set new values to original column\n\t\tfor (let row = range.start.row; row <= range.end.row; row++) {\n\t\t\tif(view.isRowVisible(row)){\n\t\t\t\tconst element = values.shift();\n\t\t\t\t\n\t\t\t\tview.setStyle(row, column, (element.style || null));\n\t\t\t\tif(element.conditions)\n\t\t\t\t\t_changeCondition(\"update\", row, column, null, element.conditions, view);\n\n\t\t\t\tif (!element.math) view.setCellValue(row, column, element.value);\n\t\t\t\telse {\n\t\t\t\t\tconst translate = {\n\t\t\t\t\t\tid: \"move\",\n\t\t\t\t\t\trow: row - element.row,\n\t\t\t\t\t\tcolumn: 0\n\t\t\t\t\t};\n\t\t\t\t\tconst newMath = updateMath(element.math, translate);\n\n\t\t\t\t\tview.setCellValue(row, column, newMath);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tview.refresh();\n}","export function init(view) {\n\tview.attachEvent(\"onUndo\", (action, row, column, value) => {\n\t\tif (action == \"gridlines-hide\"){\n\t\t\thideGridlines(view, value);\n\t\t}\n\t});\n}\n\nexport function hideGridlines(view, state = true){\n\tvar grid = view.$$(\"cells\");\n\tvar borderless = grid.$view.className.indexOf(\"webix_borderless\") !=-1;\n\tif (state === \"toggle\")\n\t\tstate = !borderless;\n\n\tif(!borderless && state){\n\t\twebix.html.addCss( grid.$view, \"webix_borderless\", true);\n\t\tview.callEvent(\"onAction\", [\"gridlines-hide\", {newValue:true, value: false}]);\n\t}\n\telse if(borderless && !state){\n\t\twebix.html.removeCss( grid.$view, \"webix_borderless\");\n\t\tview.callEvent(\"onAction\", [\"gridlines-hide\", {newValue:false, value: true}]);\n\t}\n}\n\nexport function serialize(view, data){\n\tdata.table.gridlines = view.$$(\"cells\").$view.className.indexOf(\"webix_borderless\") !=-1?0:1;\n}\n\nexport function load(view, data){\n\tvar mode = false;\n\tif(!webix.isUndefined(data.table) && !webix.isUndefined(data.table.gridlines))\n\t\tmode = !data.table.gridlines;\n\thideGridlines(view, mode);\n}","export function init(view) {\n\tview.attachEvent(\"onUndo\", (action, row, column, value) => {\n\t\tif (action == \"header-hide\"){\n\t\t\thideHeaders(view, value);\n\t\t}\n\t});\n}\n\nexport function hideHeaders(view, state = true){\n\tvar grid = view.$$(\"cells\");\n\tif (state === \"toggle\")\n\t\tstate = grid.config.header;\n\n\tif(grid.config.header && state){\n\t\tgrid.config.header = false;\n\t\tif (grid.isColumnVisible(\"rowId\"))\n\t\t\tgrid.hideColumn(\"rowId\", {}, true, true);\n\t\tgrid.refreshColumns();\n\t\tview.callEvent(\"onAction\", [\"header-hide\", {newValue:true, value:false}]);\n\t}\n\telse if(!grid.config.header && !state){\n\t\tgrid.config.header = true;\n\t\tif (!grid.isColumnVisible(\"rowId\"))\n\t\t\tgrid.showColumn(\"rowId\", {}, true);\n\t\tgrid.refreshColumns();\n\t\tview.callEvent(\"onAction\", [\"header-hide\", {newValue:false, value:true}]);\n\t}\n}\n\nexport function serialize(view, data){\n\tdata.table.headers = view.$$(\"cells\").config.header?1:0;\n}\n\nexport function load(view, data){\n\tvar mode = false;\n\tif(data.table && !webix.isUndefined(data.table.headers))\n\t\tmode = !data.table.headers;\n\thideHeaders(view, mode);\n}","import group from \"./undo_group\";\nimport {eachRange} from \"../helpers/column_names\";\n\nexport function init(view){\n\tview.comments = {\n\t\tget: function(row, column){\n\t\t\treturn getComment(view, row, column);\n\t\t},\n\t\tadd: function(row, column, comment){\n\t\t\tcommentCell(view, row, column, comment);\n\t\t},\n\t\tremove: function(row, column){\n\t\t\tremoveComment(view, row, column);\n\t\t},\n\t\t_activeComment: {},\n\t\t_pull:{}\n\t};\n\n\tview.attachEvent(\"onReset\", () => reset(view));\n\tview.attachEvent(\"onUndo\", (type, row, column, value) => {\n\t\tif (type === \"comment\")\n\t\t\t_undoComment(view, row, column, value);\n\t});\n\n\tview.attachEvent(\"onAction\", (action, p)=> {\n\t\tif(action == \"before-grid-change\")\n\t\t\tupdatePosition(p.name,p.inc,p.data, p.start);\n\t});\n}\n\nfunction _undoComment(view, row, column, value){\n\tif(getComment(view, row, column))\n\t\tremoveComment(view, row, column, true);\n\tif(value)\n\t\tcommentCell(view, row, column, value, true);\n}\n\nfunction reset(view){\n\tview.comments._pull = {};\n}\n\nfunction removeComment(view, row, column, silent){\n\tif(getComment(view, row, column)){\n\t\tif (!silent)\n\t\t\tview.callEvent(\"onAction\", [\"comment\", {row, column, newValue: null, value: view.comments._pull[row][column]}]);\n\t\tdelete view.comments._pull[row][column];\n\t}\n\tview.$$(\"cells\").updateItem(row,column);\n}\n\nexport function removeCommentsRange(view, range){\n\tgroup.set(function(){\n\t\teachRange(range, view, function(view, cell){\n\t\t\tif(getComment(view, cell.row, cell.column))\n\t\t\t\tremoveComment(view, cell.row, cell.column);\n\t\t});\n\t\tview.$$(\"cells\").refresh();\n\t});\n}\n\nfunction commentCell(view, row, column, comment, silent){\n\tvar oldValue = getComment(view, row, column) ? view.comments._pull[row][column] : null;\n\tvar table = view.$$(\"cells\");\n\n\tif(typeof comment == \"string\")\n\t\tcomment = comment.trim() ? comment : \"\";\n\tview.comments._pull[row] = view.comments._pull[row] ? view.comments._pull[row] : {};\n\tview.comments._pull[row][column] = comment;\n\n\ttable.addCellCss(row, column, \"ssheet_commented_cell\");\n\n\tif (!silent)\n\t\tview.callEvent(\"onAction\", [\"comment\", {row, column, newValue:comment, value:oldValue}]);\n}\n\nexport function serialize(view,data){\n\tvar row, column,\n\t\tcomments = [];\n\tfor(row in view.comments._pull){\n\t\tfor(column in view.comments._pull[row])\n\t\t\tif(view.comments._pull[row][column])\n\t\t\t\tcomments.push([row, column, view.comments._pull[row][column]]);\n\t}\n\tdata.comments = comments;\n}\n\nexport function load(view,data){\n\tvar i,\n\t\tcomments = data.comments;\n\n\tif(comments)\n\t\tfor(i = 0; i < comments.length; i++)\n\t\t\tcommentCell(view, comments[i][0], comments[i][1], comments[i][2], true);\n}\n\nfunction updatePosition(name, inc, data, start){\n\tlet comments = data.comments,\n\t\ti = comments.length;\n\n\tif(inc){\n\t\twhile(i--){\n\t\t\tlet [row,column] = comments[i];\n\t\t\tif(row && name == \"row\" && row>= start.row || column && name == \"column\" && column >= start.column){\n\t\t\t\tif (name == \"row\"){\n\t\t\t\t\tif (row < start.row - inc)\t//delete comment if row was deleted\n\t\t\t\t\t\tcomments.splice(i,1);\n\t\t\t\t\telse\t\t\t\t\t\t//update mark position if upper row was deleted\n\t\t\t\t\t\tcomments[i][0] = row*1 + inc;\n\t\t\t\t} else if (name == \"column\"){\n\t\t\t\t\tif (column < start.column - inc){\n\t\t\t\t\t\tcomments.splice(i, 1);\n\t\t\t\t\t} else \n\t\t\t\t\t\tcomments[i][1] = column*1 + inc;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction getComment(view, row, column){\n\treturn view.comments._pull[row] && view.comments._pull[row][column] ? view.comments._pull[row][column] : \"\";\n}","import * as m1  from \"./hide_gridlines\";\nimport * as m2  from \"./hide_headers\";\nimport * as m3  from \"./lock_cell\";\nimport * as m4  from \"./dropdown\";\nimport * as m5  from \"./filter\";\nimport * as m6  from \"./hide_row_col\";\nimport * as m7  from \"./comments\";\n\nexport function init(view){\n\tvar modules = [m1,m2,m3,m4,m5,m6,m7];\n\tview.attachEvent(\"onDataSerialize\", function(data){\n\t\tfor (var i = 0; i < modules.length; i++){\n\t\t\tif(modules[i].serialize)\n\t\t\t\tmodules[i].serialize(view,data);\n\t\t}\n\n\t});\n\tview.attachEvent(\"onDataParse\", function(data){\n\t\tfor (var i = 0; i < modules.length; i++){\n\t\t\tif(modules[i].load)\n\t\t\t\tmodules[i].load(view,data);\n\t\t}\n\t});\n}","const types = [\".xls\",\".xlt\",\".xla\",\".xlsx\",\".xlsm\",\".xltx\",\".xltm\",\".xlam\",\".xlsb\"];\n\nexport function init(view){\n\tlet uploader;\n\tif (window.XMLHttpRequest && (new XMLHttpRequest()).upload){\n\t\tuploader = webix.ui({\n\t\t\tview:\"uploader\",\n\t\t\tapiOnly:true,\n\t\t\taccept: types.join()\n\t\t});\n\n\t\tuploader.attachEvent(\"onBeforeFileAdd\",webix.bind(function(upload){\n\t\t\tif(types.indexOf(\".\"+upload.type.toLowerCase())>-1){\n\t\t\t\tview.reset();\n\t\t\t\tview.parse(upload.file, \"excel\");\n\t\t\t}\n\t\t\treturn false;\n\t\t},this));\n\n\t\tview._destroy_with_me.push(uploader);\n\t}\n\n\tview.attachEvent(\"onCommand\", (obj) => {\n\t\tif (obj.id === \"excel-import\")\n\t\t\tstartImport(view, uploader);\n\t});\n}\n\nfunction startImport(view, uploader){\n\tif (!uploader)\n\t\tview.alert(webix.i18n.spreadsheet.labels[\"import-not-support\"]);\n\telse\n\t\twebix.delay(() => uploader.fileDialog());\n}","export function print(view, options){\n\tlet active = view._activeSheet;\n\n\tlet html = _buildHtml(view, options, active);\n\twebix.html.insertBefore(html, options.docFooter, document.body);\n\twindow.print();\n\t_cleanHtml(view, html);\n\n\tview.showSheet(active);\n}\n\nexport function init(view){\n\tview.$customPrint = function(options){\n\t\tprint(view, options);\n\t};\n}\n\nfunction _cleanHtml(view, html){\n\twebix.html.remove(html);\n\n\tview._sheets.forEach((sheet, i) => {\n\t\twebix.html.removeStyle(\".wss_\"+view.$index+\"_\"+i);\n\t});\n}\nfunction _buildHtml(view, options, active){\n\tlet doc = webix.html.create(\"div\", { \"class\":\"webix_ssheet_print\"});\n\n\toptions.xCorrection = 1;\n\toptions.header = options.header || false;\n\toptions.trim = webix.isUndefined(options.trim) ? true : options.trim;\n\toptions.sheetnames = webix.isUndefined(options.sheetnames) ? true : options.sheetnames;\n\tconst baseIndex = view.$index;\n\n\tview._sheets.forEach((sheet, i) => {\n\t\tview.$index = baseIndex+\"_\"+i;\n\t\tif(options.data ===\"all\" || (options.data !== \"all\" && sheet.name === active)){\n\t\t\tview.showSheet(sheet.name);\n\t\t\tlet prefix = \"wss_\"+view.$index;\n\n\t\t\tif(options.sheetnames){\n\t\t\t\tlet sheetname = webix.html.create(\"div\", { \"class\":\"webix_view webix_ssheet_sheetname\"}, sheet.name+\":\");\n\t\t\t\tdoc.appendChild(sheetname);\n\t\t\t}\n\n\t\t\tlet table = view._table.$customPrint(options, true);\n\n\t\t\t//for empty sheet we don't have any HTML\n\t\t\tif (table.firstChild)\n\t\t\t\ttable.firstChild.className += \" \"+prefix;\n\t\t\tdoc.appendChild(table);\n\t\t\t\n\t\t\tif(options.data == \"all\" && i+1 < view._sheets.length){\n\t\t\t\tvar br = webix.html.create(\"DIV\", {\"class\":\"webix_print_pagebreak\"});\n\t\t\t\tdoc.appendChild(br);\n\t\t\t}\n\t\t}\n\t});\n\tview.$index = baseIndex;\n\t\n\treturn doc;\n}","import { style_names } from \"../operations/styles\";\nimport { getType } from \"../operations/types\";\nimport { defaultStyles} from \"../toolbar/defaults\";\nimport { getFormatSource } from \"../operations/formats\";\n\nexport function init(view){\n\tview.$exportView = function(options){\n\t\twebix.extend(options, { header: false, rawValues: true, spans: true, styles:true, math:true, xCorrection:1, ignore:{rowId:true}});\n\t\tif(options.export_mode ==\"excel\")\n\t\t\treturn _exportExcel(view, options);\n\t\telse\n\t\t\treturn view._table;\n\t};\n}\n\nfunction _exportExcel(view, options){\n\tif(options.sheets === true) \n\t\toptions.sheets  = view._sheets.map(function(s){ return s.name;});\n\telse if(!options.sheets || !options.sheets.length)\n\t\toptions.sheets = [view._activeSheet];\n\telse if(typeof options.sheets == \"string\")\n\t\toptions.sheets = [options.sheets];\n\n\toptions.dataOnly = true;\n\n\tlet data = [];\n\tlet active = view._activeSheet;\n\n\tfor(let i = 0; i<options.sheets.length; i++){\n\t\tview.showSheet(options.sheets[i]);\n\t\toptions.xCorrection = view.$$(\"cells\").config.header ? 1 : 0;\n\t\tdata = data.concat(webix.toExcel(view._table, options));\n\t\tdata[i].ranges = [];\n\n\t\tlet ranges = view.ranges.getRanges();\n\t\tfor(let r = 0; r<ranges.length; r++){\n\t\t\tdata[i].ranges.push({\n\t\t\t\tSheet:i,\n\t\t\t\tName:ranges[r].name,\n\t\t\t\tRef:options.sheets[i]+\"!\"+ranges[r].range.replace(/(\\w)/gi, function(match){ return \"$\"+match; })\n\t\t\t});\n\t\t}\n\t\tif(options.styles)\n\t\t\tdata[i].styles = _getStyles(view, options);\n\t}\n\tview.showSheet(active);\n\t\n\tdelete options.dataOnly;\n\treturn data;\n}\n\nfunction _safeColor(str){\n\tstr = str.substring(1);\n\tif(str.length === 3) str = str+str;\n\treturn str;\n}\n\nfunction _getDefaults(){\n\tlet d = defaultStyles;\n\treturn {\n\t\tfont:{\n\t\t\tsz:d[\"font-size\"].replace(\"px\", \"\")*0.75,\n\t\t\tname:d[\"font-family\"].replace(/'|,.*$/g, \"\"),\n\t\t\t//we do not export default color, but it is the right place to do it\n\t\t},\n\t\talignment:{\n\t\t\thorizontal:d[\"text-align\"],\n\t\t\tvertical:d[\"vertical-align\"]==\"middle\"?\"center\":d[\"vertical-align\"],\n\t\t\twrapText:d[\"white-space\"]!=\"nowrap\"\n\t\t}\n\t};\n}\n\nfunction _getStyles(view, options){\n\n\tview.compactStyles();\n\n\tlet result = [];\n\tlet cached = {};\n\tconst defaults = _getDefaults();\n\n\tif(options.docHeader) result  = result.concat([{0:_getDocStyle(options.docHeader.css, defaults)}, {}]);\n\tif(options.header) result.push({});\n\n\tconst delta = result.length;\n\n\tconst grid = view.$$(\"cells\");\n\tconst columns = grid.config.columns;\n\n\tlet rIndex = delta;\n\tgrid.eachRow((row) =>{\n\t\tfor (let cIndex = options.xCorrection; cIndex < columns.length; cIndex++){\n\t\t\tconst css = view.getStyle(row, columns[cIndex].id);\n\t\t\tconst index = cIndex - options.xCorrection;\n\n\t\t\tresult[rIndex] = result[rIndex] || {};\n\n\t\t\tlet styles;\n\t\t\tif(css){\n\t\t\t\tif(cached[css.id])\n\t\t\t\t\tstyles = cached[css.id];\n\t\t\t\telse{\n\t\t\t\t\tstyles = _getCellStyle(css.text);\n\t\t\t\t\tfor(let name in defaults)\n\t\t\t\t\t\twebix.extend(styles[name], defaults[name]);\n\t\t\t\t\tcached[css.id] = styles;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t\tstyles = defaults;\n\n\t\t\tresult[rIndex][index] = webix.copy(styles);\n\t\t\tresult[rIndex][index].type = getType(view, row, columns[cIndex].id);\n\t\t}\n\t\trIndex++;\n\t});\n\n\tif(options.docFooter) result  = result.concat([{},{0:_getDocStyle(options.docFooter.css, defaults)}]);\n\n\treturn result;\n}\n\nfunction _getCellStyle(styles){\n\tlet str = styles.split(\";\"), stl = { font:{}, alignment:{}, border:{}};\n\n\tfor(let s = 0; s<str.length; s++){\n\t\tif(str[s]){\n\t\t\tswitch (style_names[s]){\n\t\t\t\tcase \"color\": \n\t\t\t\t\tstl.font.color = {rgb:_safeColor(str[s])};\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"background\":{\n\t\t\t\t\tlet fill = _safeColor(str[s]);\n\t\t\t\t\tif(fill && fill.toLowerCase() !==\"ffffff\")\n\t\t\t\t\t\tstl.fill = { fgColor:{ rgb:fill}};\n\t\t\t\t\tbreak;\n\t\t\t\t}\t\n\t\t\t\tcase \"text-align\":\n\t\t\t\t\tstl.alignment.horizontal = str[s];\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"font-family\":\n\t\t\t\t\tstl.font.name = str[s].replace(/'|,.*$/g, \"\"); // cut off fallback font\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"font-size\":\n\t\t\t\t\tstl.font.sz = str[s].replace(\"px\", \"\")*0.75; //px to pt conversion\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"font-style\":\n\t\t\t\t\tstl.font.italic = str[s] == \"italic\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"text-decoration\":\n\t\t\t\t\tstl.font.underline = str[s] == \"underline\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"font-weight\":\n\t\t\t\t\tstl.font.bold = str[s] == \"bold\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"vertical-align\":\n\t\t\t\t\tstl.alignment.vertical = str[s] == \"middle\"?\"center\":str[s];\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"wrap\":\n\t\t\t\t\tstl.alignment.wrapText = str[s] == \"wrap\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"borders\":\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"format\":\n\t\t\t\t\tstl.format = getFormatSource(str[s], true) || \"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"border-right\":\n\t\t\t\t\tstl.border.right = { color:{ rgb:_safeColor(str[s])}, style:\"thin\"};\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"border-bottom\":\n\t\t\t\t\tstl.border.bottom = { color:{ rgb:_safeColor(str[s])}, style:\"thin\"};\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"border-left\":\n\t\t\t\t\tstl.border.left = { color:{ rgb:_safeColor(str[s])}, style:\"thin\"};\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"border-top\":\n\t\t\t\t\tstl.border.top = { color:{ rgb:_safeColor(str[s])}, style:\"thin\"};\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\treturn stl;\n}\n\nfunction _getDocStyle(css){\n\tif(!css) return {};\n\tvar str = [];\n\tfor(let i =0; i<style_names.length; i++)\n\t\tstr.push(css[style_names[i]]||\"\");\n\treturn _getCellStyle(str.join(\";\"));\n}\n\n","import { style_names } from \"../operations/styles\";\nimport { fontFamily} from \"../toolbar/buttons\";\nimport { defaultStyles} from \"../toolbar/defaults\";\n\nexport function init(view){\n\tview._parseExcel = function(obj, driver){\n\t\tvar options = obj.options || {};\n\t\toptions.math = view.config.math;\n\n\t\tvar full = { sheets:[]};\n\t\tfor(let i  = 0; i< obj.names.length; i++){\n\t\t\toptions.name = obj.names[i];\n\t\t\tfull.sheets.push({\n\t\t\t\tname:options.name,\n\t\t\t\tcontent:_excel_to_data(driver.getSheet(obj, options), obj.ranges, i)\n\t\t\t});\n\t\t}\n\t\treturn full;\n\t};\n\tview._parseCsv = function(obj, driver){\n\t\tobj = driver.getRecords(obj);\n\n\t\tvar dataObj = webix.copy(obj);\n\t\tvar data = [];\n\n\t\tfor(let i = 0; i<dataObj.length; i++){\n\t\t\tlet item = dataObj[i].split(driver.cell);\n\t\t\tfor(let c  = 0; c<item.length; c++){\n\t\t\t\tvar row = i+1, column = c+1;\n\t\t\t\tdata.push([row, column, item[c]]);\n\t\t\t}\n\t\t}\n\t\treturn { data:data };\n\t};\n}\n\n\nfunction _excel_to_data(obj, ranges, index){\n\tvar dataObj = webix.copy(obj.data);\n\tvar data =  [];\n\n\tfor (let i = 0; i < dataObj.length; i++){\n\t\tfor(let c = 0; c<dataObj[0].length; c++){\n\t\t\tvar row = i+1, column = c+1;\n\t\t\tdata.push([row, column, dataObj[i][c]]);\n\t\t}\n\t}\n\tobj.data = data;\n\n\t//merged cells\n\tif(obj.spans){\n\t\tfor(let i = 0; i<obj.spans.length; i++){\n\t\t\tobj.spans[i][0]++;\n\t\t\tobj.spans[i][1]++;\n\t\t}\n\t}\n\n\t//named ranges\n\tif(ranges){\n\t\tfor(let r = 0; r<ranges.length; r++){\n\t\t\t//we don't support global named ranges, so import only sheet-based :(\n\t\t\tif(ranges[r].Sheet === index){\n\t\t\t\tobj.ranges = obj.ranges || [];\n\t\t\t\tobj.ranges.push([ranges[r].Name.toUpperCase(), ranges[r].Ref.substring(ranges[r].Ref.indexOf(\"!\")+1).replace(/\\$/g, \"\")]);\n\t\t\t}\n\t\t}\n\t}\n\n\t//cell styles\n\tif(obj.styles)\n\t\t_getStyles(obj);\n\n\tif(obj.types)\n\t\t_getTypes(obj);\n\n\t//column width and row height\n\tif(obj.sizes){\n\t\tfor(let i = 0; i<obj.sizes.length; i++){\n\t\t\tif(obj.sizes[i][0] == \"column\")\n\t\t\t\tobj.sizes[i] = [0, obj.sizes[i][1]+1, obj.sizes[i][2]];\n\t\t\telse\n\t\t\t\tobj.sizes[i] = [obj.sizes[i][1]+1, 0, obj.sizes[i][2]];\n\t\t}\n\t}\n\n\treturn obj; \n}\n\n//ARGB conversion\nfunction _safeColor(str){\n\tstr = str || \"000000\";\n\tif(str.length === 8) str = str.substring(2);\n\treturn \"#\"+str;\n}\n\n//only fonts that we support can be imported\nfunction _safeFont(str){\n\tlet safe = defaultStyles[\"font-family\"];\n\tfor(let i = 0; i<fontFamily.length; i++){\n\t\tif(fontFamily[i].value == str) { safe = fontFamily[i].id; break; }\n\t}\n\treturn safe;\n}\n\nfunction _getTypes(obj){\n\tobj.types.forEach(type => {\n\t\tfor(let i = 0; i < obj.data.length; i++){\n\t\t\tif(obj.data[i][0] === type[0]+1 && obj.data[i][1] === type[1]+1){\n\t\t\t\tobj.data[i][4] = type[2];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t});\n}\n\nfunction _getStyles(obj){\n\tlet styleshash = {}, styles = [], stylescount = 1;\n\tfor(let i = 0; i<obj.styles.length; i++){\n\t\tlet str = [], stl = obj.styles[i][2], css;\n\n\t\tfor(let s  = 0; s<style_names.length; s++){\n\t\t\tswitch (style_names[s]){\n\t\t\t\tcase \"color\": \n\t\t\t\t\tstr[s] = stl.font && stl.font.color?(_safeColor(stl.font.color.rgb)||\"\"):\"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"background\":\n\t\t\t\t\tstr[s] = stl.fill && stl.fill.fgColor?(_safeColor(stl.fill.fgColor.rgb) ||\"\"):\"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"text-align\":\n\t\t\t\t\tstr[s] = (stl.alignment ?stl.alignment.horizontal:\"\") || defaultStyles[\"text-align\"];\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"font-family\":\n\t\t\t\t\tstr[s] = stl.font && stl.font.name?_safeFont(stl.font.name):\"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"font-size\":\n\t\t\t\t\tstr[s] = stl.font && stl.font.sz?((stl.font.sz/0.75)+\"px\" ||\"\"):\"\"; //pt to px conversion\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"font-style\":\n\t\t\t\t\tstr[s] = stl.font && stl.font.italic?\"italic\":\"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"text-decoration\":\n\t\t\t\t\tstr[s] = stl.font && stl.font.underline?\"underline\":\"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"font-weight\":\n\t\t\t\t\tstr[s] = stl.font && stl.font.bold?\"bold\":\"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"vertical-align\":\n\t\t\t\t\tvar va = stl.alignment ? (stl.alignment.vertical || \"\"):\"\";\n\t\t\t\t\tstr[s] = (va ==\"center\"?\"middle\":va) || defaultStyles[\"vertical-align\"];\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"wrap\":\n\t\t\t\t\tstr[s] = stl.alignment && stl.alignment.wrapText?\"wrap\":\"nowrap\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"borders\":\n\t\t\t\t\tstr[s] = \"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"format\":\n\t\t\t\t\tstr[s] = \"\"; //stl.numFmt\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"border-right\":\n\t\t\t\t\tstr[s] = stl.border && stl.border.right? (_safeColor(stl.border.right.color.rgb) || \"\"):\"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"border-bottom\":\n\t\t\t\t\tstr[s] = stl.border && stl.border.bottom? (_safeColor(stl.border.bottom.color.rgb) || \"\"):\"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"border-left\":\n\t\t\t\t\tstr[s] = stl.border && stl.border.left? (_safeColor(stl.border.left.color.rgb) || \"\"):\"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"border-top\":\n\t\t\t\t\tstr[s] = stl.border && stl.border.top? (_safeColor(stl.border.top.color.rgb) || \"\"):\"\";\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tstr = str.join(\";\");\n\t\tcss = styleshash[str] || \"wss\"+stylescount;\n\n\t\tfor(let d = 0; d<obj.data.length; d++){\n\t\t\tif(obj.data[d][0] === obj.styles[i][0]+1 && obj.data[d][1] === obj.styles[i][1]+1){\n\t\t\t\tobj.data[d][3] = css;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif(!styleshash[str]){\n\t\t\tstyles.push([css, str]);\n\t\t\tstyleshash[str] = css;\n\t\t\tstylescount++;\n\t\t}\n\t}\n\tobj.styles = styles;\n}","import group from \"../operations/undo_group\";\n\nexport function init(view){\n\tview.attachEvent(\"onCommand\", (action) => {\n\t\tswitch (action.id) {\n\t\t\tcase \"clear-value\":\n\t\t\t\tview.clearRange(null,{values: true});\n\t\t\t\tbreak;\n\t\t\tcase \"clear-style\":\n\t\t\t\tview.clearRange(null,{styles: true});\n\t\t\t\tbreak;\n\t\t\tcase \"clear-conditional-formats\":\n\t\t\t\tview.clearRange(null,{conditions: true});\n\t\t\t\tbreak;\n\t\t\tcase \"clear-dropdown-editors\":\n\t\t\t\tview.clearRange(null,{editors: true});\n\t\t\t\tbreak;\n\t\t\tcase \"clear-all\":\n\t\t\t\tgroup.set(function(){\n\t\t\t\t\tview.clearRange(null,null);\n\t\t\t\t});\n\t\t\t\tbreak;\n\t\t\tcase \"clear-comments\":\n\t\t\t\tview.clearRange(null,{comments: true});\n\t\t\t\tbreak;\n\t\t}\n\t});\n}","import group from \"../operations/undo_group\";\n\n/* row operations */\n\nexport function insertRow(row){\n\tcallCommand(this, \"add\", \"row\", row);\n}\n\nexport function deleteRow(row){\n\tcallCommand(this, \"del\", \"row\", row);\n}\n\nexport function setRowHeight(row, height){\n\tsetSize(this, \"row\", row, height);\n}\n\n/* col operations */\n\nexport function insertColumn(column){\n\tcallCommand(this, \"add\", \"column\", column);\n}\n\nexport function deleteColumn(column){\n\tcallCommand(this, \"del\", \"column\", column);\n}\n\nexport function setColumnWidth(column, width){\n\tsetSize(this, \"column\", column, width);\n}\n\n/* helpers */\n\nfunction getCells(view, id, group){\n\tif(!id){\n\t\tlet area = view.$$(\"cells\").getSelectArea();\n\t\tif(area)\n\t\t\tid = [area.start[group],area.end[group]];\n\t}\n\telse if(!webix.isArray(id)){\n\t\tid =  [id,id];\n\t}\n\treturn id;\n}\n\nfunction callCommand(view, name, group, id){\n\tlet start = {}, end = {};\n\tid = getCells(view, id, group);\n\tif(!id)\n\t\treturn;\n\tstart[group] = id[0];\n\tend[group] = id[1];\n\tview.callEvent(\"onCommand\", [{id:name,  group:group}, start, end]);\n}\n\nfunction setSize(view, type, id, size){\n\tid = getCells(view, id, type);\n\tif(!id)\n\t\treturn;\n\tgroup.set(()=>{\n\t\tfor (let i = id[0]; i <= id[1]; i++)\n\t\t\tview.$$(\"cells\")[type == \"row\" ? \"setRowHeight\" : \"setColumnWidth\"](i, size);\n\t});\n}","import * as lock from \"../operations/lock_cell\";\n\nexport function lockCell(row, column, state){\n\tlock.lockCell(this, row, column, state);\n}\n\nexport function isCellLocked(row, column){\n\treturn lock.isCellLocked(this, row, column);\n}","import group from \"../operations/undo_group\";\n\nexport function freezeColumns(column){\n\tconst grid = this.$$(\"cells\");\n\t\n\tif( webix.isUndefined(column) ){\n\t\tlet sel = this.getSelectedId(true);\n\t\tcolumn = sel.length?sel[0].column:0;\n\t}\n\n\tconst base = grid.config.columns[0].id == \"rowId\" ? 1 : 0;\n\tlet index = base;\n\tif (column && column != this._frozenColumns)\n\t\tindex = grid.getColumnIndex(column*1+1);\n\tif (index<base) index = base;\n\n\tgroup.set(function(){\n\t\tcheckSpans(this, \"column\", column);\n\t\tgrid.unselect();\n\t\tgrid.define(\"leftSplit\", index);\n\t\tgrid.refreshColumns();\n\n\t\tthis.callEvent(\"onAction\", [ \"freeze-column\", { value: (this._frozenColumns || 0), newValue: column}]);\n\t\tthis._frozenColumns = index > base ? column : 0;\n\t},this);\n}\n\nexport function freezeRows(row){\n\tconst grid = this.$$(\"cells\");\n\n\tif( webix.isUndefined(row) ){\n\t\tlet sel = this.getSelectedId(true);\n\t\trow = sel.length?sel[0].row:0;\n\t}\n\n\tlet index = 0;\n\tif (row && row != this._frozenRows)\n\t\tindex = grid.getIndexById(row*1+1);\n\tif (index < 0) index = 0;\n\n\tgroup.set(function(){\n\t\tcheckSpans(this, \"row\", row);\n\t\tgrid.unselect();\n\t\tgrid.define(\"topSplit\", index);\n\t\tgrid.refreshColumns();\n\n\t\tthis.callEvent(\"onAction\", [ \"freeze-row\", { value: this._frozenRows, newValue: row}]);\n\t\tthis._frozenRows = index ? row : 0;\n\t},this);\n}\n\nfunction checkSpans(view, type, num){\n\tconst grid = view.$$(\"cells\");\n\n\tif(type == \"row\"){\n\t\tlet start = 1;\n\t\tlet end = view.config.columnCount;\n\t\tfor(let i = start; i <= end; i++){\n\t\t\tconst span = grid.getSpan(num, i);\n\t\t\tif(span){\n\t\t\t\tconst spanSize = (span[0]*1) + span[3] - 1;\n\t\t\t\tif(spanSize>num)\n\t\t\t\t\tchangeSpan(view, span, span[2], num-span[1]+1);\n\t\t\t}\n\t\t}\n\t}\n\telse{//column\n\t\tlet start = grid.data.order[0];\n\t\tlet end = grid.data.order.length;\n\t\tfor(let i = start; i <= end; i++){\n\t\t\tconst span = grid.getSpan(i, num);\n\t\t\tif(span){\n\t\t\t\tconst spanSize = (span[1]*1) + span[2] - 1;\n\t\t\t\tif(spanSize>num)\n\t\t\t\t\tchangeSpan(view, span, num-span[0]+1, span[3]);\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction changeSpan(view, span, x, y){\n\tview.splitCell(span[0], span[1]);\n\tview.combineCells({\n\t\tcell:{\n\t\t\trow:span[0],\n\t\t\tcolumn:span[1]\n\t\t},\n\t\tx:x,\n\t\ty:y\n\t});\n}","import * as gridlines from \"../operations/hide_gridlines\";\n\nexport function hideGridlines(state){\n\tgridlines.hideGridlines(this,state);\n}","import * as headers from \"../operations/hide_headers\";\n\nexport function hideHeaders(state){\n\theaders.hideHeaders(this,state);\n}","import * as hrows from \"../operations/hide_row_col\";\n\nexport function hideColumn(column,state){\n\throws.setState(this, column, state, \"column\");\n}\nexport function isColumnVisible(column){\n\treturn hrows.isColumnVisible(this, column);\n}\nexport function hideRow(row,state){\n\throws.setState(this, row, state, \"row\");\n}\nexport function isRowVisible(row){\n\treturn hrows.isRowVisible(this, row);\n}","import {addMethod} from \"../math/methods\";\nimport {image, chart} from \"../math/writer\";\nimport {getAccessor} from \"../math/sheet\";\n\nexport function addImage(row, column, url){\n\tthis.setCellValue(row, column, image(url));\n\tthis.refresh();\n}\n\nexport function addSparkline(row, column, config){\n\tlet value = chart(config);\n\tthis.setCellValue(row, column, value);\n\tthis.refresh();\n}\n\nexport function getSheetData(name){\n\treturn getAccessor(this, name);\n}\n\nexport function recalculate(){\n\tthis.callEvent(\"onMathRefresh\",[]);\n}\n\nexport function registerMathMethod(name, handler){\n\tname = name.toUpperCase();\n\taddMethod(name, handler);\n\tif(this.$$(\"liveEditor\")){\n\t\tconst sid = this.$$(\"liveEditor\").config.suggest;\n\t\tconst list = webix.$$(sid).getList();\n\t\tif(!list.exists(name))\n\t\t\tlist.add({id:name, value:name});\n\t}\n}","import * as sheets from \"../sheets\";\nimport * as spn from \"../operations/spans\";\nimport * as und from \"../operations/undo\";\nimport group from \"../operations/undo_group\";\nimport * as stl from \"../operations/styles\";\nimport * as srt from \"../operations/sorting\";\nimport {removeCommentsRange} from \"../operations/comments\";\nimport {clearConditionalFormats} from \"../operations/conditional_formats\";\nimport {clearEditors} from \"../operations/dropdown\";\nimport {clearFilters} from \"../operations/filter\";\n\n//spans\nexport function combineCells(range){\n\tif(!range){\n\t\tvar sel = this.getSelectedId(true);\n\t\tif (sel.length>1){\n\t\t\trange = spn.getRange(sel);\n\t\t}\n\t}\n\tgroup.set(()=> {\n\t\tif (range)\n\t\t\tspn.addSpan(this, range.cell, range.x, range.y);\n\t});\n\tthis.refresh();\n}\n\nexport function splitCell(row, column){\n\tif (row && column) {\n\t\tspn.removeSpan(this, {row: row, column: column});\n\t}\n\telse{\n\t\tgroup.set(function(){\n\t\t\tthis.eachSelectedCell(function(cell){\n\t\t\t\tspn.removeSpan(this, cell);\n\t\t\t});\n\t\t},this);\n\n\t}\n\n\tthis.refresh();\n}\n\n//styles\nexport function addStyle(prop, origin){\n\treturn stl.addStyle(this, prop, origin);\n}\n\nexport function getStyle(row, column){\n\treturn stl.getStyle(this, {row:row, column:column});\n}\n\nexport function setStyle(row, column, style){\n\treturn stl.setStyle(this, {row: row, column: column}, style);\n}\n\nexport function setRangeStyle(rangeStr, style){\n\tgroup.set(function() {\n\t\tstl.setRangeStyle(this, rangeStr, style);\n\t},this);\n}\n\nexport function clearRange(rangeStr, type) {\n\tif (!rangeStr){\n\t\trangeStr = this._table.getSelectArea();\n\t\tif (!rangeStr) return;\n\t}\n\n\tif (!type) type = {styles: true, values: true, editors:true, conditions:true, comments:true };\n\t\n\tif (type.styles)\n\t\tstl.clearRangeStyle(this,rangeStr);\n\n\tif (type.conditions)\n\t\tclearConditionalFormats(this,rangeStr);\n\t\n\tif (type.values)\n\t\tthis.setRangeValue(rangeStr, null);\n\n\tif (type.editors){\n\t\tclearEditors(this, rangeStr);\n\t\tclearFilters(this, rangeStr);\n\t}\n\n\tif (type.comments)\n\t\tremoveCommentsRange(this, rangeStr);\n\n\tthis.refresh();\n}\n\nexport function compactStyles(){\n\treturn stl.compactStyles(this);\n}\n\n// serialize\nexport function serialize(config){\n\tvar obj = {};\n\tthis.callEvent(\"onDataSerialize\",[obj, config]);\n\n\tif (config && config.sheets)\n\t\treturn sheets.serialize(this, obj);\n\treturn obj;\n}\n\n//sheets\nexport function showSheet(name){\n\tsheets.show(this,name);\n}\nexport function getActiveSheet(){\n\treturn this._activeSheet;\n}\nexport function addSheet(content){\n\tsheets.add(this, content);\n}\nexport function clearSheet(){\n\tthis.reset();\n}\nexport function renameSheet(name,newName){\n\tsheets.rename(this,name,newName);\n}\nexport function editSheet(name){\n\tsheets.edit(this,name);\n}\nexport function removeSheet(name){\n\tsheets.remove(this,name);\n}\n\n\n//undo\nexport function undo(){\n\tund.undo(this);\n}\nexport function redo(){\n\tund.redo(this);\n}\n\n// sort\nexport function sortRange(range, dir){\n\tsrt.sortRange(this, range, dir);\n}","import {toRange,rangeObj} from \"../helpers/column_names\";\nimport * as tbl from \"../table\";\nimport group from \"../operations/undo_group\";\nimport {newSheet} from \"../sheets\";\n\nexport function refresh(all){\n\tif (all)\n\t\tthis._table.refreshColumns();\n\telse\n\t\tthis._table.refresh();\n}\nexport function eachSelectedCell(cb){\n\tvar cells = this.getSelectedId(true);\n\tfor (var i=0; i<cells.length; i++)\n\t\tcb.call(this, cells[i]);\n}\nexport function getSelectedRange(sheet){\n\tvar area = this._table.getSelectArea();\n\tif (area){\n\t\tif (sheet)\n\t\t\tsheet = this.getActiveSheet();\n\t\treturn toRange(area.start.row,area.start.column,area.end.row,area.end.column,sheet);\n\t}\n\treturn \"\";\n}\nexport function getSelectedId(all){\n\tvar area = this._table.getSelectArea();\n\tif(!all)\n\t\treturn area && area.start.row ? area.start : null;\n\n\tvar selection = [];\n\tif(area){\n\t\tvar c0 = area.start;\n\t\tvar c1 = area.end;\n\n\t\tfor(var i = c0.row; i<= c1.row; i++){\n\t\t\tfor(var j = c0.column; j <= c1.column; j++){\n\t\t\t\tselection.push({row: i,column:j});\n\t\t\t}\n\t\t}\n\t}\n\n\treturn selection;\n\t//return this._table.getSelectedId(all)\n}\nexport function getCellValue(row, column){\n\tvar item = this.getRow(row);\n\tvar value = item[\"$\"+column] || item[column];\n\t\n\tif (typeof value === \"undefined\") return \"\";\n\treturn value;\n}\nexport function setCellValue(row, column, value){\n\tif(this.getCellValue(row, column) !== value){\n\t\tvar item = this.getRow(row);\n\t\tvar old = item[\"$\"+column]||item[column];\n\n\t\t//onCellChange can change item (via types module)\n\t\tgroup.set(()=>{\n\t\t\tif (this.callEvent(\"onBeforeValueChange\",[row, column, value, old])){\n\t\t\t\titem[column] = value;\n\t\t\t\tdelete item[\"$\"+column];\n\n\t\t\t\tthis.callEvent(\"onCellChange\", [row, column, value]);\n\t\t\t\tthis.saveCell(row, column);\n\t\t\t}\n\t\t});\n\t}\n}\n\nexport function setRangeValue(range, value){\n\tgroup.set(function(){\n\t\tvar pos = rangeObj(range, this);\n\t\tfor (let row = pos.start.row; row <= pos.end.row; row++) {\n\t\t\tfor (let column = pos.start.column; column <=  pos.end.column; column++) {\n\t\t\t\tthis.setCellValue(row, column, value);\n\t\t\t}\n\t\t}\n\t},this);\n\n}\n\nexport function getRow(id){\n\treturn this._table.getItem(id);\n}\nexport function getColumn(id){\n\treturn this._table.getColumnConfig(id);\n}\nexport function reset(mode){\n\tvar obj = { data:[] };\n\tif (mode && mode.sheets){\n\t\tobj = newSheet(obj);\n\t}\n\t\n\tthis.parse(obj);\n}\n\nexport function _resetTable(){\n\ttbl.reset(this);\n}\n","import {save} from \"../operations/save\";\n\nexport function saveCell(row, column){\n\tvar style = this.getStyle(row, column);\n\n\tsave(this, \"data\", {\n\t\trow: row,\n\t\tcolumn: column,\n\t\tvalue: this.getCellValue(row, column),\n\t\tstyle: (style ? style.id : \"\")\n\t});\n}","export function getRow(id){\n\treturn this._table.getItem(id);\n}\n\nexport function setCellEditor(row, column, editor) {\n\tconst line = this._table._ssEditors[row] = this._table._ssEditors[row] || {};\n\tconst value = line[column] || this.getRow(row)[column];\n\tline[column] = editor;\n\n\tif (editor && editor.editor){\n\t\tif (this.getCellFilter(row, column))\n\t\t\tthis.setCellFilter(row, column, null);\n\n\t\tthis._table.addCellCss(row,column, \"ss_editor\");\n\t} else {\n\t\tdelete this._table._ssEditors[row][column];\n\t\tthis._table.removeCellCss(row,column, \"ss_editor\");\n\t}\n\tthis.callEvent(\"onAction\", [\"dropdown\", { row, column, value, newValue:editor }]);\n}\n\nexport function getCellEditor(row, column){\n\tlet line = this._table._ssEditors[row] || {};\n\treturn line[column] || null;\n}","import * as flt from \"../operations/filter\";\n\nexport function setCellFilter(row, column, filter){\n\tconst line = this._table._ssFilters[row] = this._table._ssFilters[row] || {};\n\tconst value = line[column] || this.getRow(row)[column];\n\n\tif (filter && (webix.isArray(filter) || typeof filter == \"string\"))\n\t\tfilter = { options:filter };\n\tline[column] = filter;\n\n\tif (filter && typeof filter == \"object\"){\n\t\tif (this.getCellEditor(row, column))\n\t\t\tthis.setCellEditor(row, column, null);\n\n\t\tthis._table.addCellCss(row,column, \"ss_filter\");\n\t\twebix.extend(filter, {row, column}, true);\n\t\tfilter.options = flt.calibrateRange(this, row, column, filter.options);\n\t} else {\n\t\tdelete this._table._ssFilters[row][column];\n\t\tthis._table.removeCellCss(row,column, \"ss_filter\");\n\t\tthis._table.removeCellCss(row,column, \"ss_filter_active\");\n\t}\n\tthis.callEvent(\"onAction\", [\"filter\", { row, column, value, newValue:filter }]);\n}\n\nexport function getCellFilter(row, column){\n\tlet line = this._table._ssFilters[row] || {};\n\treturn line[column] || null;\n}\n\n// [DEPRECATED]\nexport function addFilter(){\n}\n\nexport function removeFilter(){\n\tconst filters = flt.getFilters(this._table);\n\n\tfor\t(let i=0; i<filters.length; i++){\n\t\tconst {row, column} = filters[i];\n\t\tthis.setCellFilter(row, column, null);\n\t}\n\n\tthis._table._ssFilters = {};\n\tthis._table.data.filter(function(){ return true; });\n}\n\n\nexport function filterSpreadSheet(){\n\tthis._table.data.silent(function(){\n\t\tconst filters = flt.getFilters(this._table);\n\n\t\tfor (let i=0; i<filters.length; i++){\n\t\t\tconst {row, column, handler} = filters[i];\n\n\t\t\tlet all = false;\n\t\t\tthis._table.data.filter(function(obj){\n\t\t\t\tif (all || obj.id*1 <= row*1) return true;\n\t\t\t\tif (!obj[column] && obj[column] !== \"\") return all = true;\n\t\t\t\treturn (typeof handler == \"function\") ? handler({ value: String(obj[column]) }) : true;\n\t\t\t}, 1, i);\n\t\t}\n\t}, this);\n\n\tthis._table.refresh();\n}\n","export function confirm(config){\n\treturn webix.confirm({\n\t\tcss:\"webix_ssheet_confirm\",\n\t\ttext:config.text,\n\t\tok: webix.i18n.spreadsheet.labels.ok,\n\t\tcancel: webix.i18n.spreadsheet.labels.cancel\n\t});\n}\n\nexport function alert(config){\n\treturn webix.alert({\n\t\tcss: \"webix_ssheet_alert\",\n\t\ttext:config.text,\n\t\tok: webix.i18n.spreadsheet.labels.ok\n\t});\n}","import * as undo from \"../operations/undo\";\nimport group from \"../operations/undo_group\";\n\nexport function resetUndo(){\n\tundo.reset(this);\n}\n\nexport function groupUndo(func){\n\tgroup.set(func, this);\n}\n\nexport function ignoreUndo(func){\n\tundo.ignoreUndo(func, this);\n}","import * as fmt from \"../operations/formats\";\n\nexport function setFormat(row, column, format){\n\tfmt.addFormat(this, row, column, format);\n}\n\nexport function changeDecimals(row, column, inc){\n\t//row and column may be obj\n\tfmt.changeAreaDecimals(this, inc, row, column);\n}","const defaultMenu = [\n\t{ id:\"file\", submenu:[\n\t\t{id: \"sheet\", submenu: [\n\t\t\t{id: \"new-sheet\"},\n\t\t\t{id: \"copy-sheet\"},\n\t\t\t{id: \"remove-sheet\"}\n\t\t]},\n\t\t{id: \"excel-import\"},\n\t\t{id: \"excel-export\"}\n\t]},\n\t{ id:\"edit\", submenu:[\n\t\t{id: \"add-range\"},\n\t\t{id: \"add-dropdown\"},\n\t\t{id: \"add-link\"},\n\t\t{id: \"lock-cell\"},\n\t\t{id: \"conditional-format\"},\n\t\t{id: \"clear\", submenu:[\n\t\t\t{id: \"clear-value\"},\n\t\t\t{id: \"clear-style\"},\n\t\t\t{id: \"clear-conditional-formats\"},\n\t\t\t{id: \"clear-dropdown-editors\"},\n\t\t\t{id: \"clear-comments\"},\n\t\t\t{ $template:\"Separator\" },\n\t\t\t{id: \"clear-all\"}\n\t\t]}\n\t]},\n\t{ id:\"insert\", submenu:[\n\t\t{id: \"add-image\"},\n\t\t{id: \"add-sparkline\"},\n\t\t{id: \"add-comment\"}\n\t]},\n\t{ id:\"data\", submenu:[\n\t\t{id: \"sort\", submenu: [\n\t\t\t{id: \"sort-asc\"},\n\t\t\t{id: \"sort-desc\"}\n\t\t]},\n\t\t{id: \"create-filter\"}\n\t]},\n\t{\n\t\tid: \"view\", submenu:[\n\t\t\t{id: \"columns\", submenu: [\n\t\t\t\t{id: \"insert-column\"},\n\t\t\t\t{id: \"delete-column\"},\n\t\t\t\t{id: \"show-column\"},\n\t\t\t\t{id: \"hide-column\"},\n\t\t\t\t{id: \"resize-column\"}\n\t\t\t]},\n\t\t\t{id: \"rows\", submenu: [\n\t\t\t\t{id: \"insert-row\"},\n\t\t\t\t{id: \"delete-row\"},\n\t\t\t\t{id: \"show-row\"},\n\t\t\t\t{id: \"hide-row\"},\n\t\t\t\t{id: \"resize-row\"}\n\t\t\t]},\n\t\t\t{ $template:\"Separator\" },\n\t\t\t{id: \"freeze-columns\"},\n\t\t\t{id: \"freeze-rows\"},\n\t\t\t{id: \"hide-gridlines\"},\n\t\t\t{id: \"hide-headers\"}\n\t\t]\n\t}\n];\n\nconst ui = {\n\tgetMenuData: function(menu, config){\n\t\tvar i;\n\t\tfor(i=0; i < menu.length; i++){\n\t\t\tif(typeof menu[i] == \"string\")\n\t\t\t\tmenu[i] = {id: menu[i]};\n\t\t\tif((menu[i].id == \"resize-column\" || menu[i].id == \"resize-row\") && !config.resizeCell){\n\t\t\t\tmenu.splice(i,1);\n\t\t\t\ti--;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif(!menu[i].value)\n\t\t\t\tmenu[i].value = webix.i18n.spreadsheet.menus[menu[i].id];\n\t\t\tif(menu[i].submenu)\n\t\t\t\tmenu[i].submenu = this.getMenuData(menu[i].submenu, config);\n\t\t}\n\n\t\treturn menu;\n\t}\n};\n\nexport function init(view){\n\tview.attachEvent(\"onComponentInit\", () => ready(view));\n\n\tvar config = view.config,\n\t\tmenu = {\n\t\t\tview: \"menu\",\n\t\t\tborderless: true,\n\t\t\tcss: \"webix_ssheet_menu\",\n\t\t\tid: \"menu\",\n\t\t\tautowidth: true,\n\t\t\ttype:{\n\t\t\t\theight: 40\n\t\t\t},\n\t\t\tdata: ui.getMenuData(webix.isArray(config.menu)?config.menu : webix.copy(defaultMenu), view.config)\n\t\t};\n\n\tview.callEvent(\"onViewInit\", [\"menu\", menu]);\n\treturn menu;\n}\n\n\nfunction ready(view){\n\tif(view.$$(\"menu\"))\n\t\tview.$$(\"menu\").attachEvent(\"onMenuItemClick\",(id) => callAction(view,id));\n}\n\nconst actionMap = {\n\t\"undo\": function (view) {\n\t\tview.undo();\n\t},\n\t\"redo\": function (view) {\n\t\tview.redo();\n\t},\n\t\"insert-column\": function (view) {\n\t\tview.insertColumn();\n\t},\n\t\"delete-column\": function (view) {\n\t\tview.deleteColumn();\n\t},\n\t\"show-column\": function (view) {\n\t\tview.hideColumn(null,false);\n\t},\n\t\"hide-column\": function (view) {\n\t\tview.hideColumn(null,true);\n\t},\n\t\"resize-column\": function (view) {\n\t\t//like we are calling from the toolbar\n\t\tview.callEvent(\"onCommand\",[{id: \"resize\", group: \"column\", value: webix.i18n.spreadsheet.menus[\"resize-column\"]}]);\n\t},\n\t\"insert-row\": function (view) {\n\t\tview.insertRow();\n\t},\n\t\"delete-row\": function (view) {\n\t\tview.deleteRow();\n\t},\n\t\"show-row\": function (view) {\n\t\tview.hideRow(null,false);\n\t},\n\t\"hide-row\": function (view) {\n\t\tview.hideRow(null,true);\n\t},\n\t\"resize-row\": function (view) {\n\t\t//like we are calling from the toolbar\n\t\tview.callEvent(\"onCommand\",[{id: \"resize\", group: \"row\", value: webix.i18n.spreadsheet.menus[\"resize-row\"]}]);\n\t},\n\t\"freeze-columns\": function(view){\n\t\tview.freezeColumns();\n\t},\n\t\"hide-gridlines\": function(view){\n\t\tview.hideGridlines(\"toggle\");\n\t},\n\t\"hide-headers\": function(view){\n\t\tview.hideHeaders(\"toggle\");\n\t}\n};\n\nfunction callAction(view,id){\n\tif(view.callEvent(\"onMenuItemClick\",[id])){\n\t\tif(actionMap[id])\n\t\t\tactionMap[id](view);\n\t\telse\n\t\t\tview.callEvent(\"onCommand\",[{id: id}]);\n\t}\n}","function getText(text){\n\tvar locale = webix.i18n.spreadsheet.labels;\n\treturn locale[text] || text;\n}\nexport function getDefaultStyles(){\n\treturn [\n\t\t{name: getText(\"normal\"), css: \"webix_ssheet_condition_regular\"},\n\t\t{name: getText(\"neutral\"), css: \"webix_ssheet_condition_neutral\"},\n\t\t{name: getText(\"bad\"), css: \"webix_ssheet_condition_bad\"},\n\t\t{name: getText(\"good\"), css: \"webix_ssheet_condition_good\"}\n\t];\n}","//global definitions\nimport \"./locale\";\nimport \"./views/index\";\n\n//special content for non-production builds\nimport \"./init\";\n\nimport \"./editors/index\";\n\n//modules\nimport * as bar from \"./toolbar\";\nimport * as tbl from \"./table\";\nimport * as key from \"./hotkeys\";\nimport * as editor from \"./editor\";\nimport * as sheets from \"./sheets\";\nimport * as dialogs from \"./dialogs/index\";\nimport * as context from \"./context\";\n\nimport {setDefaultFormats} from \"./operations/formats\";\nimport {operations} from \"./operations/index\";\nimport {api} from \"./api/index\";\n\n//styling\nimport * as menu from \"./menu\";\nimport {getDefaultStyles} from \"./helpers/conditional\";\nimport {setSkinDefaults} from \"./toolbar/defaults\";\n\n\nvar component = {\n\tname:\"spreadsheet\",\n\t_base_index:{ count:1 },\n\tdefaults:{\n\t\tspans: true,\n\t\trowCount:50,\n\t\tmath:true,\n\t\tcolumnCount:20,\n\t\tresizeCell: true,\n\t\tsheetTabWidth: 90,\n\t\tconditionStyle: getDefaultStyles()\n\t},\n\t$init:function(){\n\t\tthis.$index = (this._base_index.count++);\n\t\tthis.$view.className += \" webix_ssheet\";\n\n\t\tthis.$ready.unshift(this._sub_init);\n\t\tthis.$ready.unshift(setDefaultFormats);\n\t\tthis.$ready.push(this._set_handlers);\n\n\t\tthis._destroy_with_me = [];\n\t\tthis.attachEvent(\"onDestruct\", () => {\n\t\t\tthis._destroy_with_me.forEach(view => view.destructor());\n\t\t});\n\t},\n\t$skin:function(){\n\t\tsetSkinDefaults();\n\t},\n\t_sub_init:function(){\n\t\tconst obj = this.config;\n\t\tconst rows = [];\n\n\t\t//toolbars\n\t\tif(!obj.readonly && obj.menu)\n\t\t\trows.push(menu.init(this));\n\t\tif(!obj.readonly && obj.toolbar !== false)\n\t\t\trows.push(bar.init(this));\n\t\tif (obj.subbar)\n\t\t\trows.push(obj.subbar);\n\t\tif(!obj.readonly && obj.liveEditor)\n\t\t\trows.push(editor.init(this));\n\n\t\t//data part\n\t\tconst tblObj = {\n\t\t\teditable : !obj.readonly,\n\t\t\tclipboard : obj.clipboard,\n\t\t\tliveEditor: obj.liveEditor,\n\t\t\tclipboardDecimalDelimiter : obj.clipboardDecimalDelimiter\n\t\t};\n\t\tif(obj.rowHeight)\n\t\t\ttblObj.rowHeight = obj.rowHeight;\n\t\tif(obj.columnWidth)\n\t\t\ttblObj.columnWidth = obj.columnWidth;\n\n\t\trows.push(tbl.init(this, tblObj));\n\n\t\tconst bottom = obj.bottombar === true ? sheets.defaultBottom(this) : obj.bottombar;\n\t\tif (bottom)\n\t\t\trows.push(bottom);\n\n\t\tsheets.init(this);\n\n\t\tif(!obj.readonly)\n\t\t\tcontext.init(this);\n\n\t\tdialogs.init(this);\n\n\t\tthis.rows_setter(rows);\n\t},\n\t_set_handlers:function(){\n\t\t//prevent double init\n\t\tif (this._table) return;\n\t\tthis._table = this.$$(\"cells\");\n\n\t\t//init all sub modules\n\t\toperations(this);\n\n\t\t//set sizes for the table\n\t\ttbl.reset(this, this.config.columnCount, this.config.rowCount);\n\t\tkey.init(this); //keyboard shortcuts\n\t\t\n\t\tthis._table.attachEvent(\"onAfterAreaAdd\", () =>\n\t\t\tthis.callEvent(\"onAfterSelect\", [ this.getSelectedId(true) ]));\n\n\t\tthis.callEvent(\"onComponentInit\", []);\n\t},\n\t$onLoad:function(obj, driver){\n\t\t//when loading data by data:, we can get $onLoad before _set_handlers call\n\t\tthis._set_handlers();\n\n\t\tif (obj.excel)\n\t\t\tobj = this._parseExcel(obj, driver);\n\t\telse if(!obj.data && typeof obj == \"string\" && (driver.cell || driver.row))\n\t\t\tobj = this._parseCsv(obj, driver);\n\n\t\tsheets.load(this, obj);\n\t}\n};\napi(component);\nwebix.protoUI(component, webix.AtomDataLoader, webix.IdSpace, webix.ui.layout);\n","import {isCellSelected, isColSelected,isRowSelected,selectRow,selectColumn} from \"./operations/column_operations\";\nimport {getColumnOperation, getRowOperation, getClearOperation} from \"./toolbar/buttons\";\n\nexport function init(view){\n\tview.attachEvent(\"onComponentInit\", () => view.$$(\"context\").attachTo(view._table.$view));\n\n\tvar locale = webix.i18n.spreadsheet.menus;\n\tconst lists = {\n\t\tdata:[\n\t\t\t{ id:\"clear\",\t\tvalue: locale[\"clear\"], submenu: getClearOperation()},\n\t\t\t{ id:\"lock-cell\",\t\tvalue: locale[\"lock-cell\"]},\n\t\t\t{ $template: \"Separator\"},\n\t\t\t{ id:\"sort\",\tvalue: locale.sort, submenu:[\n\t\t\t\t{id: \"sort-asc\", value: locale[\"sort-asc\"]},\n\t\t\t\t{id: \"sort-desc\", value: locale[\"sort-desc\"]}\n\t\t\t]},\n\t\t\t{id:\"create-filter\",\t\tvalue: locale[\"create-filter\"]},\n\t\t\t{ $template: \"Separator\"},\n\t\t\t{ id:\"add-range\",\t\tvalue: locale[\"add-range\"]},\n\t\t\t{ id:\"add-link\",\t\tvalue: locale[\"add-link\"]},\n\t\t\t{ id:\"add-comment\",\t\tvalue: locale[\"add-comment\"]}\n\t\t],\n\t\tcolumn: getColumnOperation(view),\n\t\trow: getRowOperation(view)\n\t};\n\n\n\tvar context = {\n\t\tview: \"contextmenu\",\n\t\tid: \"context\",\n\t\tpadding:0,\n\t\tsizeToContent:true,\n\t\tsubmenuConfig:{\n\t\t\tpadding:0,\n\t\t\ton:{\n\t\t\t\tonBeforeShow:function(){\n\t\t\t\t\tthis.sizeToContent();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tdata:[],\n\t\ton:{\n\t\t\tonMenuItemClick(id) {\n\t\t\t\tview.callEvent(\"onCommand\", [this.getMenuItem(id)]);\n\t\t\t},\n\t\t\tonBeforeShow(pos) {\n\t\t\t\twebix.callEvent(\"onClick\", []);\n\t\t\t\tvar mode, trg;\n\n\t\t\t\ttrg = view._table.locate(pos);\n\t\t\t\tif (!trg) return false;\n\n\t\t\t\tmode = \"\";\n\t\t\t\tif (trg.header && trg.column !== \"rowId\"){\n\t\t\t\t\tif (!isColSelected(trg.column, view))\n\t\t\t\t\t\tselectColumn(trg.column, view);\n\t\t\t\t\tmode = \"column\";\n\t\t\t\t} else if (trg.row){\n\t\t\t\t\tif (trg.column === \"rowId\"){\n\t\t\t\t\t\tif (!isRowSelected(trg.row, view))\n\t\t\t\t\t\t\tselectRow(trg.row, view);\n\t\t\t\t\t\tmode = \"row\";\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (!isCellSelected(trg.row, trg.column, view))\n\t\t\t\t\t\t\tview._table.addSelectArea(trg, trg);\n\t\t\t\t\t\tmode = \"data\";\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (mode){\n\t\t\t\t\tvar data = getMenuData(view, mode, lists[mode]);\n\t\t\t\t\tif (data){\n\t\t\t\t\t\tthis.clearAll();\n\t\t\t\t\t\tthis.parse(data);\n\t\t\t\t\t\twebix.html.preventEvent(pos);\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t};\n\n\tview.callEvent(\"onViewInit\", [\"context\", context]);\n\tconst contextMenu = view.ui(context);\n\n\tview._destroy_with_me.push(contextMenu);\n}\n\nexport function getMenuData(view, name, data){\n\tvar ev = { area:name, data:data };\n\tif (view.callEvent(\"onContextMenuConfig\", [ev]))\n\t\treturn ev && ev.data;\n\treturn null;\n}","import * as m1  from \"./add_row_col\";\nimport * as m6  from \"./clipboard\";\nimport * as m12 from \"./column_operations\";\nimport * as m2  from \"./conditional_formats\";\nimport * as m4 from \"./types\";\nimport * as m8 from \"./formats\";\nimport * as m16a from \"../math/math\";\nimport * as m17 from \"./data\";\nimport * as m18 from \"./dropdown\";\nimport * as m7  from \"./formats\";\nimport * as m13 from \"./hide_row_col\";\nimport * as m14 from \"./lock_cell\";\nimport * as m3  from \"./resize\";\nimport * as m9  from \"./selection\";\nimport * as m10 from \"./sorting\";\nimport * as m16 from \"./spans\";\nimport * as m19 from \"./states\";\nimport * as m5  from \"./styles\";\nimport * as m11 from \"./undo\";\nimport * as m20 from \"./import\";\nimport * as m21 from \"./filter\";\nimport * as m22 from \"./print\";\nimport * as m23 from \"./export\";\nimport * as m24 from \"./load\";\nimport * as m25 from \"./clear_styles\";\nimport * as m26 from \"./comments\";\nimport * as m27 from \"./save\";\nimport * as m28 from \"./hide_headers\";\nimport * as m29 from \"./hide_gridlines\";\n\nexport function operations(view){\n\t//order in some cases does matter\n\t//resize must be applied after math, to size data by the result of math calculation\n\t//types must be applied after state and data \n\tvar all = [m1,m2,m5,m6,m7,m9,m10,m11,m12,m13,m14,m16,m16a,m3,m8,m17,m18,m19,m4,m20,m21,m22,m23,m24,m25,m26,m27,m28,m29];\n\tfor (var i = 0; i < all.length; i++){\n\t\tif (all[i].init)\n\t\t\tall[i].init(view);\n\t}\n}","import * as rco from \"./row_col_operations\";\nimport * as lcl from \"./lock_cell\";\nimport * as fcl from \"./freeze\";\nimport * as hbr from \"./hide_gridlines\";\nimport * as hhd from \"./hide_headers\";\nimport * as hrc from \"./hide_rows\";\nimport * as mat from \"./math\";\nimport * as ops from \"./operations\";\nimport * as cor from \"./core\";\nimport * as sav from \"./save\";\nimport * as dpd from \"./dropdown\";\nimport * as flt from \"./filter\";\nimport * as cfm from \"./confirm\";\nimport * as und from \"./undo\";\nimport * as fmt from \"./number_formats\";\n\nexport function api(view){\n\tvar all = [rco, lcl, fcl, hbr, hhd, hrc, mat, ops, cor, sav, dpd, flt, cfm, und, fmt];\n\tfor (var i = 0; i < all.length; i++)\n\t\twebix.extend(view, all[i]);\n}"],"names":["isChar","char","code","charCodeAt","getWord","formula","i","passive","max","length","sheet","quotes","j","key","substr","webix","i18n","spreadsheet","labels","tooltips","menus","table","liveEditor","formats","protoUI","name","$cssName","$init","config","options","view","body","tooltip","template","xCount","yCount","data","ui","richselect","defaults","width","margin","cols","scroll","select","obj","id","on","onAfterSelect","this","getParentView","updateMasterValue","value","rows","css","title","onChange","hide","getValue","$$","master","setValue","getList","getColorView","getSelectedId","getBody","getChildViews","getItemText","suggest","fitMaster","$ready","push","bind","getPopup","isArray","callEvent","join","palette","colorboard","icon","borderless","height","onSelect","setMasterValue","$view","className","$renderInput","divStart","color","renderColor","call","replace","match","p1","p2","p3","colorpicker","prototype","$setValue","popup","toString","getColorNode","style","backgroundColor","firstChild","childNodes","$renderIcon","text","apply","arguments","buttons","getHeaderConfig","label","paddingX","paddingY","click","getTopParentView","getBodyConfig","content","elements","getFormElements","cancel","autowidth","save","body_setter","_typeof","window","head_setter","padding","move","head","autofocus","IdSpace","headerRowHeight","datatable","a","setHTML","type","dataview","contextmenu","filter","item","editor","cursor","getInputNode","selectionStart","val","charAt","str1","substring","str2","search","toLowerCase","indexOf","attachEvent","node","tagName","_this","sizes","html","offset","textWidth","getTextSize","y","x","show","refresh","setValueHere","$enterKey","isVisible","operand","isPosition","test","position","word","row","sum","mode","flags","chars","errorCode","e","namedRangeCode","deps","ranges","getCode","sheetInd","split","rangeCode","b","r1","c1","r2","c2","t","crosssheet","lines","index","ph","escaped","end","next","pushLine","getPopupConfig","onItemClick","button","params","getItem","area","getSelectArea","concat","start","dayOfTheYear","date","Date","getFullYear","diff","getTimezoneOffset","Math","floor","getJsDateFromExcel","excelDate","getTime","getExcelDateFromJs","jsDate","_to_number","v","isNaN","_combine","arr","suggestData","highlight","_highlightedCells","_update_range","_last_value_set","showActiveSheet","updateCellValue","delay","_table","moveSelection","preventEvent","eventRemove","keydownEv","event","_this2","endEdit","escapeText","escape","cells","changeCellCss","_ranges","parts","getActiveSheet","colorIndex","crossheet","cellSheet","prepareSheet","activeMath","_activeMath","activeSheet","cell","cellText","rangeName","repeatedColor","nextCell","nextCellText","setColor","document","activeElement","paintValue","$handleSelection","activeCell","define","showSheet","column","_this3","col","remove","r","c","which","keyCode","dir","getItemNode","innerHTML","newv","getCellValue","setCellValue","$setValueHere","updatedStr","setSelectionRange","expectRange","trim","expectOperator","setRange","range","pos","len","lastPos","isUndefined","prepareArea","first","second","min","row1","col1","row2","col2","coloredArea","texthighlight","layout","drag","dragscroll","EditAbility","list","toggle","onValue","offValue","common","inp","awidth","aheight","arrow","elementsConfig","labelWidth","_initOnChange","$eventSource","blockEvent","_getCheckboxes","count","$all","_count","unblockEvent","base","forEach","labelRight","active","baseHeight","skin","$active","inputHeight","checkboxes","output","scrollview","queryView","form","onSelectChange","focus","editors","excel_date","extend","popupType","$popup","icons","timepicker","group","set","method","uid","url","all","serialize","sheets","proxy","$parse","$proxy","ajax","headers","post","init","thread","events","handler","newName","_loading_data","clearTimeout","decode","encode","alpha","prefixIndex","parseInt","str","adress","size","nind","d1","d2","notAlphaNum","escapeSheet","toRange","x2","y2","rangeObj","eachRange","callback","rangeTest","isRange","changeRange","inc","updated","toolbarSizes","sectorPadding","sectorMargin","defaultStyles","sizeEl","style_names","_style_map","align","rowHeight","border_checks","_style_handlers","modes","_updateStyle","reset","_styles","_styles_cache","_styles_max","prefix","$index","removeStyle","getStyle","styles","getRow","$cellCss","styleid","addStyle","props","origin","_styleFromText","_styleToText","cache","_addStyle","_parse","styleObj","update_style_data","nstyle","copy","$cellFormat","format","setStyle","_setStyle","setRangeStyle","appendChild","scrollWidth","scrollHeight","removeChild","old","oldFormat","saveCell","silent","_buildCssString","clearRangeStyle","compactStyles","used","newStyles","_applyStyles","eachSelectedCell","_applyCellStyles","ostyle","_serialize","_undoStyle","create","formatsCount","formatSources","formatCache","formatHelpers","setDefaultFormats","formatsLocale","price","getFormat","extra","priceFormat","values","zeros","priceSettings","decimalSize","symbol","separator","negative","getDelimiters","numberFormat","percent","round","format2code","dateFormat","string","serializeFormat","formToValues","groupSign","groupDelimiter","decimalSign","decimalDelimiter","getFormatSource","toexcel","parseFormat","createFormatName","addFormat","nev","splitFormat","conditional","delimiters","errorMessage","separated","separateFmt","genCode","condition","fmt","Function","check","line","ind","isAbs","genFormatCode","isQuote","comma","numberPlaceholder","textPlaceholder","multiply","lastDateType","betweenPlaceholders","placeholder","datePart","excelDateToWebix","undefined","map","decimal","getParts","left","right","reverse","lzeros","lfills","rzeros","rfills","rmax","dateTypes","timeTypes","dateOrder","Object","keys","sort","timeOrder","typesOrder","order","types","changeAreaDecimals","getCells","firstValue","firstStyle","rules","isNumber","changeCellDecimals","setValues","updateDecimals","parsed","decimals","placeholders","Array","slice","withoutText","withoutPlaceholders","hasOwnProperty","isCustom","formValues","toExcel","leftPlaceholders","fmtParts","sepFmtParts","getFmtPartValues","leftText","rightText","fmtPart","firstPlaceholder","Infinity","k","checkFormat","quot","getFormatName","isDateInvalid","load","defaultFormats","actions","span","isMerged","c0","getSpan","splitCell","confirm","then","combineCells","undo","redo","hideGridlines","hideHeaders","freezeColumns","freezeRows","fontFamily","getColumnOperation","locale","colOperations","resizeCell","getRowOperation","rowOperations","getClearOperation","getLocaleClear","$template","borders","styleFormats","colorButton","iconButton","btn","segmented","popupWidth","popupTemplate","popupEvents","titleHeight","condFormat","buttonsMap","getFontSize","numbers","fontSize","px","getCellFormats","currency","example","number","getText","getAllElements","calcButtons","groups","result","$button","insert","ready","selected","barStyles","toolbar","allElements","elm","bottombar","toolbarButtons","structure","checkButtons","getButtons","columns","block","blockColumns","bar","source","viewId","innerId","selectRow","endRow","last","_selectRange","selectAll","firstColumn","selectColumn","endColumn","isColSelected","selectedArea","isCellSelected","isRowSelected","selectColumns","addSelectArea","adjustColumn","eachRow","rowobj","$height","setColumnWidth","adjustRow","eachColumn","getColumnConfig","setRowHeight","highlightColRow","header","sr","er","sc","ec","addCellCss","removeCellCss","getHeaderNode","addCss","removeCss","dragStartColumn","grid","showHandler","comments","_activeComment","editStatus","locate","visible","commentsView","get","viewonly","contains","target","math","editMath","st","ed","addEventListener","parentNode","cellIndex","dragEndColumn","cop","ev","getEditor","isCellLocked","finalStep","ids","lastHeaderClick","headerClick","dblClick","shiftKey","lastClickedRow","editStop","UIManager","getFocus","need_focus","setFocus","setDefaultCss","$name","spans","leftSplit","areaselect","editable","editaction","minRowHeight","navigation","clipboard","clipboardDecimalDelimiter","templateCopy","cell_template","commented","helper","newvalue","clearAll","columnCount","rowCount","el","nms","_hideColumn","refreshColumns","hideColumn","parse","_hideRow","env","isMac","addHotKey","readonly","sel","$anyKey","edit","del","styleHotKey","ctrlU","ctrlP","attr","elementOn","state","SUM","AVERAGE","COUNT","COUNTA","COUNTBLANK","MAX","MIN","PRODUCT","product","SUMPRODUCT","sets","sp","s","SUMSQ","sq","pow","VARP","avg","STDEVP","sqrt","POWER","num","n","p","QUOTIENT","div","d","SQRT","ABS","abs","RAND","random","PI","INT","ROUND","digits","parseFloat","toFixed","ROUNDDOWN","ROUNDUP","ceil","TRUNC","EVEN","ODD","CONCATENATE","LEFT","MID","RIGHT","LOWER","UPPER","toUpperCase","PROPER","temp","idx","TRIM","LEN","DATE","year","month","day","TIME","hour","minute","DAY","getDate","MONTH","getMonth","YEAR","NOW","DATEDIF","unit","startDateDays","months","IMAGE","SPARKLINE","color1","color2","negativeColor","Sparklines","getTemplate","LINK","IF","neg","methods","strings","other","methodsName","startEdit","clear","cellEditor","fillEditor","disableEditor","getCellEditor","getCellFilter","disable","enable","en","pasteRange","updateRange","isEnabled","disabled","find","func","findIndex","actionMap","_activeSheet","add","prepare","selectSheet","showItem","command","changePagerVisability","sheetTabWidth","showBatch","changePagerStatus","scrollPos","getScrollState","tabWidth","context","dataOrder","_sheets","splice","rename","defaultBottom","hidden","editValue","onClick","webix_ssheet_sheet_arrow","initSheetMenu","$sheetMenu","menuInit","menu","_destroy_with_me","callAction","getMark","disableItem","enableItem","batch","scrollSheets","direction","scrollTo","newIndex","getNewTitle","getSheet","newSheet","changeId","tabs","getActive","getDimension","_resetTable","Dialog","$dialog","$hide","$show","close","unescape","DialogBox","box","preview","parseImage","server","images","showPreview","upload","startLoad","endLoad","onSaveClick","okClick","dialog","image","fillUrl","addImage","onHideClick","onCancelClick","file","reader","FileReader","onload","getFormView","readAsDataURL","response","imageURL","actives","passives","core","struct","pair","pairsheet","rawword","triggers","parser","_build_function","error_function","clearMathCache","activeOnly","updateMath","action","stack","isRowFix","isColumnFix","cut","updateSheetNames","oldName","thisSheet","multiSheet","getAccessor","_mathSheetCache","helpers","passiveAccessor","page","formulas","_mathSheetHelpers","_mathSheetCore","getRangeCode","getCell","execute","getRange","activeAccessor","SheetAccessor","getRangeValue","rangeValue","unique","String","empty","unshift","nullFilter","$value","$empty","Ranges","_master","accessor","els","parseChart","color_def","color_pos","color_neg","renderPreview","visibleBatch","labelPosition","typesChangeHandler","sparkConfig","getValues","checkRange","addSparkline","alert","clearValidation","getSelectedRange","getRanges","toSheetRange","validate","exists","updateItem","theform","removeRange","editRange","correct","gravity","saveClick","autoheight","setCellEditor","$mode","$filter","syncScroll","_getTargetNode","getSpanNode","getFilter","getConditions","importData","relative","field","conditions","applyFilter","getFilterFunction","filterSpreadSheet","includes","setCellStyle","isHidden","nodeOffset","tableOffset","getElementsByClassName","ydiff","xdiff","scrollSize","fillForm","labelsLocale","commonConfig","customConfig","dateConfig","timeFormat","fullDateFormat","longDateFormat","getFormats","updateForm","closeWin","isText","forms","_safeInt","value2","collection","_getCondition","activeValue","_setCondition","_clean","display","onFocus","current_view","clearRow","getRows","getConditionStyle","conditionStyle","_this4","getSheets","filename","restoreValue","paper","fit","sheetnames","modal","vertical","print","_setComment","textarea","minWidth","minHeight","resize","onViewResize","animate","showInput","addComment","onBlur","showTemplate","changeTextarea","comment","open","getHead","columnWidth","bases","aiw","asw","rgs","dpd","flt","cnd","exp","lnk","pnt","cmt","lockCss","lockCell","_mapCellsCalls","_locks","newValue","cm","lock","updatePosition","locked","ignoreUndoReset","restoreHistory","_ssUndoHistory","_ssUndoCursor","addToHistory","$skipHistory","ignoreUndo","ignoreReset","step","prevData","undoHandlers","nvalue","ovalue","addSpan","extraCss","getExtraCss","setSpanValue","isEmpty","removeSpan","lx","ly","rx","ry","cx","cy","setSpanCss","borderChecks","adjustSpan","checkSpan","selection","isFirstCell","oldValue","pasteSpan","cutted","translate","mapCells","rid","cid","pull","isUndo","undoSpan","checkSpanBorders","process","newData","oldData","getUpdateValues","_addColumn","add_column_count","_delColumn","del_column_count","deleted","_addRow","add_row_count","_delRow","del_row_count","update","loadChangedData","fixSelectArea","calculate","get_core","_execute","error","isFinite","rs","vs","m","backtrak","solvedMath","solvedCounter","applyMath","tkey","check_trigger","srow","scolumn","recalckCell","remove_triggers","trs","back","adds","bcell","add_triggers","blist","add_backtrack","holders","setPlaceholder","psh","updateCell","recalckAll","getState","_dataParse","param","option","addEmptyCollection","_empty","_pull","rowId","columnId","clearConditionalFormats","_changeCondition","pasteCondition","oldCondition","newCondition","handlers","type_action","_undoCondition","_setCssFormat","cssFormat","_ssEditors","clearEditors","pasteDropdown","dropdown","on_click","ss_editor","tblEditors","isEditor","dateToExcel","getFormatType","formatType","getType","$cellType","setType","_setType","isFormula","parseDate","expectType","getExpectType","dateFormulas","fullDateFormatDate","isTime","setFormat","checkType","_ssFilters","getFilters","filters","clearFilters","refilter","isFilter","calibrateRange","getFilterRange","pasteFilter","setCellFilter","styledata","clipdata","updateFilters","ss_filter","getFilterMode","createFilters","removeFilter","_clipboardToTable","cdata","fromSheet","ctrlKey","metaKey","_get_sel_style","mapSelection","allFiltersInZone","startRow","startCol","endCol","_clip_to_sel","leftTop","csv","delimiter","_changeDelimiter","record","_add_row_col","maxRow","maxCol","row_ind","col_ind","subtrans","tconfig","frozenColumns","frozenRows","_frozenColumns","_frozenRows","topSplit","hasValue","_undoValue","_hidden_cols_hash","_hidden_rows_hash","isColumnVisible","setState","indexes","getIds","_showRow","_showColumn","isRowVisible","showColumn","unselect","_updatePosition","h","hrows","hcols","_adjustRowHeight","wrap","headerOnly","refreshSelectArea","getColumn","_undoResize","defWidth","defHeight","nsizes","o","bs","blockStart","blockEnd","res","removeSelectArea","sorters","sortRange","fullrange","expandSelection","maxY","maxX","nr1","nr2","nc1","nc2","newrange","by","fullRow","element","shift","newMath","gridlines","removeComment","getComment","removeCommentsRange","commentCell","_undoComment","modules","m1","m2","m3","m4","m5","m6","m7","uploader","XMLHttpRequest","apiOnly","accept","startImport","fileDialog","_buildHtml","doc","xCorrection","baseIndex","sheetname","$customPrint","br","insertBefore","docFooter","_cleanHtml","_safeColor","_getStyles","cached","_getDefaults","font","sz","alignment","horizontal","wrapText","docHeader","_getDocStyle","delta","rIndex","cIndex","_getCellStyle","stl","border","rgb","fill","fgColor","italic","underline","bold","bottom","top","$exportView","rawValues","ignore","export_mode","_exportExcel","dataOnly","Sheet","Name","Ref","_excel_to_data","dataObj","styleshash","stylescount","_safeFont","va","_getTypes","safe","_parseExcel","driver","full","names","_parseCsv","getRecords","clearRange","callCommand","setSize","insertRow","deleteRow","insertColumn","deleteColumn","checkSpans","changeSpan","getColumnIndex","getIndexById","hideRow","chart","getSheetData","recalculate","registerMathMethod","addMethod","sid","spn","prop","rangeStr","setRangeValue","addSheet","clearSheet","renameSheet","editSheet","removeSheet","und","srt","cb","tbl","addFilter","ok","resetUndo","groupUndo","changeDecimals","defaultMenu","submenu","getMenuData","component","_base_index","getDefaultStyles","_sub_init","_set_handlers","destructor","$skin","setSkinDefaults","material","subbar","tblObj","attachTo","lists","sizeToContent","submenuConfig","onBeforeShow","onMenuItemClick","getMenuItem","trg","contextMenu","dialogs","viewBases","rows_setter","operations","m9","m10","m11","m12","m13","m14","m16","m16a","m8","m17","m18","m19","m20","m21","m22","m23","m24","m25","m26","m27","m28","m29","$onLoad","excel","api","rco","lcl","fcl","hbr","hhd","hrc","mat","ops","cor","sav","cfm","AtomDataLoader"],"mappings":";;;;;;;;krEAAA,SAASA,EAAOC,OACXC,EAAOD,EAAKE,WAAW,UAEb,IAAND,GAAYA,GAAM,KAAgB,IAARA,GAAsB,IAARA,EAOjD,SAASE,EAAQC,EAASC,EAAGC,WAJxBL,EAKAM,EAAMH,EAAQI,OACdC,EAAQH,EACRI,GAAS,EAELC,EAAEN,EAAGM,EAAEJ,EAAKI,IAAI,KACnBC,EAAOR,EAAQO,MACP,MAARC,OAKCF,KACO,KAAPE,EAAW,IACG,KAAdR,EAAQC,YAKO,OADjBI,EAAQL,EAAQS,OAAOR,EAAGM,EAAEN,IAClB,KACTI,EAAQA,EAAMI,OAAO,EAAGJ,EAAMD,OAAO,IACtCH,EAAEM,EAAE,OAGD,KAAKZ,EAAOa,UA5BfX,EACS,KADTA,EA4BiCW,EA5BrBV,WAAW,KACRD,GAAM,WA4Bf,CAACG,EAAQS,OAAOR,EAAGM,EAAEN,GAAIM,EAAGN,EAAGI,QAjBvCC,GAAUA,QAsBL,CAACN,EAAQS,OAAOR,GAAIM,EAAGN,EAAGI,GCvClCK,MAAMC,KAAKC,YCDI,CACdC,OAAO,QAEI,kBACE,kBACF,iBACC,eACH,cACE,uBACO,0BACA,2BACL,2BACD,gCACG,4BACA,qCAED,iBACL,YACA,YACA,aACC,eACC,gBACA,iBACC,aACL,WACG,eAEC,cACF,aAEC,6BAEa,+BACT,gCACQ,4BACA,8BACC,kCACE,kBAEf,sBACM,4BACD,qBACC,mBAEH,mBACG,2BACC,qCACH,wCAEM,iCACD,yBACC,0BACA,6BACG,gCACA,0BAEN,8BACE,kCAEA,+BACA,gCACA,WAEZ,oBAEU,8BACM,6DACN,uBACD,wCACK,iCAEN,uBACD,kBACD,YAEH;MACA,gBAEG,gBACF,+BAEc,gFACA,8EACH,6EACN,gCAEP,sBACM,sCACG,iCACH,4BACC,yBACC,6BACH,uBACD,4BACC,+BACC,+BACF,yBACH,6BACK,mBACJ,2BACA,8BACG,2BACC,8BACE,4BACC,oBAEP,gBAEF,eACC,UAEVC,SAAU,OACA,wBACK,iCACC,0BACF,yBACC,oCACI,yBACP,uBACG,+BACE,4BACD,6BACE,gCACC,8BACH,8BACE,qCACK,yCACL,4BACH,4BACE,6BACD,0BACF,2BACG,8BACA,oBACR,aACA,iBACA,YACA,cACE,oCACU,8CACA,wCACL,oBACD,2BACK,6BACD,qCACF,qCACG,sCACN,8CACE,qCACF,wBACA,yBACJ,mBACG,eACL,cACG,gBACD,oBACI,wBACI,sBACF,WAEhBC,MAAM,gBACW,8BACA,oBACR,aACD,kBACM,2BACG,mCACA,wBACP,sBACK,yBACN,YACA,YACA,eACG,0BACM,gCACA,8BACF,4BACA,8BACE,qBACT,oBACM,0BACA,wBACF,sBACA,wBACE,oBACJ,8BACY,2BACb,sBACK,uBACA,qCACc,+CACH,yCACR,uBACL,kBACC,wBACI,aACT,kBACI,uBACC,oBACL,kBACI,0BACC,8BACI,qBACT,wBACU,wCACH,wCACG,qCACF,mCACA,2BACH,yBACJ,sBACK,WAEfC,MAAM,cACQ,uBACE,oBAEhBC,WAAW,MACH,SAERC,QAAQ,YACO,wBACA,6BACI,8BACA,2BChOpBR,MAAMS,QAAQ,CACbC,KAAM,eACNC,SAAS,aACTC,MAAO,SAASC,GACfA,EAAOC,QAAW,CACjBC,KAAK,cACLC,KAAK,CACJD,KAAM,eACNE,QAAS,CACRC,SAAS,aAEVC,OAAO,EAAGC,OAAO,GAElBC,KAAMR,EAAOQ,QAGdrB,MAAMsB,GAAGC,YChBXvB,MAAMS,QAAQ,CACbC,KAAM,yBACNc,SAAS,CACRC,MAAO,KAERb,MAAO,SAASC,GACfA,EAAOG,KAAO,CACbU,OAAQ,EACRC,KAAK,CACJ,CAAEZ,KAAM,eAAgBa,QAAQ,EAAOC,QAAQ,EAC9CV,OAAQ,EACRC,OAAQ;AACRH,QAAS,CACRC,SAAU,SAASY,UACX9B,MAAMC,KAAKC,YAAYE,SAAS,WAAW0B,EAAIC,MAGxDC,GAAG,CACFC,cAAe,WACAC,KAAKC,gBAAgBA,gBAC3BC,mBAAkB,KAG5BlB,SAAU,SAASY,SAEX,iBADG,0DAA0DA,EAAIO,OAC7C,aAE5BhB,KAAMR,EAAOQ,MAEd,CAAEN,KAAM,oBACR,CACCuB,KAAK,CACJ,CAAEvB,KA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"}